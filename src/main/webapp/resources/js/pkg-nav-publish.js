define("js/tool.js",[],function(){var t={};$.extend(t,{byteLength:function(t){var e=t.match(/[^\x00-\x80]/g);return t.length+(e?e.length:0)},jsMbSubstr:function(t,e){if(!t||!e)return"";var i=0,o=0,n="",a=t.length;for(o=0;a>o;o++){if(i=t.charCodeAt(o)>255?i+=2:++i,i>2*e)return n;n+=t.charAt(o)}return t},formatMoney:function(e,i,o){if(i=t.empty(e)?"2":i,t.empty(o))return e.toFixed(i);var n=0>e?"-":"",a=parseInt(e=Math.abs(+e||0).toFixed(i),10)+"",l=(l=a.length)>3?l%3:0;return n+(l?a.substr(0,l)+o:"")+a.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(i?"."+Math.abs(e-a).toFixed(i).slice(2):"")}}),$.extend(t,{emptyObj:function(t){for(var e in t)return!1;return!0},empty:function(t){return null==t||0===t.length},objToJson:function(t){return JSON.stringify(t)}}),$.extend(t,{setCookie:function(t,e,i){i=i||{},null===e&&(e="",i.expires=-1);var o="";if(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)){var n;"number"==typeof i.expires?(n=new Date,n.setTime(n.getTime()+864e5*i.expires)):n=i.expires,o="; expires="+n.toUTCString()}var a=i.path?"; path="+i.path:"",l=i.secure?"; secure":"",s="";i.domain?s="; domain="+i.domain:(s=document.domain.toString().split("."),s="; domain=."+s[1]+"."+s[2]),document.cookie=[t,"=",encodeURIComponent(e),o,a,s,l].join("")},getCookie:function(t){var e=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!==e?decodeURIComponent(e[2]):""},removeCookie:function(e){t.setCookie(e,null,{expires:-1})},setCacheCookie:function(e,i,o,n){o=o||{},null===i&&(i="");var a="undefined"==typeof n?t.getCookie("__mgjuuid"):n;$.ajax({url:"/collect/uedcookie",type:"POST",timeout:6e4,data:{cookiename:e,uuid:a,type:"set",value:i,lifetime:86400*o.expires},dataType:"json",success:function(t){""===t&&alert(MGLANG.msgTimeout)}})},getCacheCookie:function(e,i){var o="undefined"==typeof i?t.getCookie("__mgjuuid"):i,n="";return $.ajax({url:"/collect/uedcookie",type:"POST",timeout:6e4,async:!1,data:{cookiename:e,uuid:o,type:"get"},dataType:"json",success:function(t){{var e=t.status.code;t.status.msg}if(1001==e){var i=t.result.data.value;n=i}else alert(MGLANG.msgTimeout)}}),n}}),$.extend(t,{getQueryString:function(t,e){e="undefined"!=typeof e?e:location.href;var i=new RegExp("(^|\\?|&)"+t+"=([^&]*)(\\s|&|$)","i");return i.test(e)?RegExp.$2.replace(/\+/g," "):""},getPicExtension:function(t){return/(.+)\.(.+)/.exec(t)?RegExp.$2:""},filterDomain:function(t){var e=/http:\/\/[^\/]+/;return t.replace(e,"")}}),$.extend(t,{throttleM:{isLoading:!1,throttoleXhr:function(t,e){var i=this;if(!i.isLoading){e=e||500,i.isLoading=!0;var o=t();o.complete=function(){setTimeout(function(){i.isLoading=!1},e)}}}}}),$.extend(t,{getMsgLength:function(e){var i=e.length;if(i>0){for(var o=41,n=140,a=24,l=e,s=e.match(/http[s]?:\/\/[a-zA-Z0-9-]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/\/,:;@&=\?\~\#\%]*)*/gi)||[],u=0,r=0,c=s.length;c>r;r++){var d=t.byteLength(s[r]);/^(http:\/\/mogujie.cn)/.test(s[r])||(u+=/^(http:\/\/)+(mogujie.cn|mogujie.com)/.test(s[r])&&o>=d?d:n>=d?a:d-n+a,l=l.replace(s[r],""))}return Math.ceil((u+t.byteLength(l))/2)}return 0},getAbsoluteLocation:function(t){if(1!==arguments.length||null===t)return null;var e=$(t),i=e.offset(),o=i.top,n=i.left,a=e.height(),l=$(window).height(),s=$(document).scrollTop(),u=o>=s&&s+l>=o,r=o+a+200>=s&&s+l>=o-400;return{absoluteTop:o,absoluteLeft:n,isInView:u,isLoad:r}},distance2Bottom:function(t){var e=$(document),i=$(window),o=e.scrollTop(),n=i.height(),a=e.height();return o+n+t>=a},isParent:function(t,e){for(;void 0!==t&&null!==t&&"BODY"!=t.tagName.toUpperCase();){if(t==e)return!0;t=t.parentNode}return!1},template:function(t,e){var i=MoGu.ui.getdoT();return i.template(t)(e)},log:function(t){void 0!==window.console&&console.log(t)},dataFormat:function(t,e){var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var o in i)new RegExp("("+o+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[o]:("00"+i[o]).substr((""+i[o]).length)));return e}}),$.extend(t,{trim:function(t){return $.trim(t)},getRequest:function(t,e){return this.getQueryString(t,e)}}),MoGu.APP.Publish||(MoGu.APP.Publish={}),$.extend(MoGu.APP.Publish,t)}),define("js/func.js",[],function(){var t={Globe_Textarea_Auto_Height:function(t){var e=t.height(),i=function(){0>e&&(e=t.height()),($.browser.mozilla||$.browser.safari)&&t.height(e);var i=t[0].scrollHeight,o=e>i?e:i;o=1.5*e>o?e:i,t.height(o)};t.bind("keyup",i).bind("input",i).bind("propertychange",i).bind("focus",i)},Globe_Goods_URL_Support:function(t){var e=/item(.[\w]+)?.taobao.com\/(.?)[item.htm|item_num_id|item_detail|itemID|item_id|default_item_id]/i,i=/detail.tmall/i,o=/auction\d?.paipai.com/i,n=/buy.caomeipai.com\/goods/i,a=/www.360buy.com\/product/i,l=/product.dangdang.com\/Product.aspx\?product_id=/i,s=/book.360buy.com/i,u=/www.vancl.com\/StyleDetail/i,r=/www.vancl.com\/Product/i,c=/vt.vancl.com\/item/i,d=/item.vancl.com\/\d+/i,_=/item.vt.vancl.com\/\d+/i,p=/(mbaobao.com\/pshow)|(mbaobao.com\/item)/i,f=/item.buy.qq.com\/item/i,m=/[www|us].topshop.com\/webapp\/wcs\/stores\/servlet\/ProductDisplay/i,b=/quwan.com\/goods/i,g=/nala.com.cn\/product/i,h=/maymay.cn\/pitem/i,v=/asos.com/i,w=/www.100f1.com\/ProductInfo_/i,y=/www.gaojie.com\/product/i,k=/a.m.taobao.com\/i/i,$=/www.51yugou.com\//i,x=/www.1mall.com\//i,P=/www.yihaodian.com\//i,j=/www.xipin.me\//i,G=/www.nuandao.com\//i,I=/www.rosebeauty.com.cn\//i,M=/www.hmeili.com\//i,T=/www.yueji.com\//i,L=/www.yougou.com\//i,C=/cn.shopbop.com\//i,A=/item.jd.com\//i,B=/[www|shop].mogujie.com(.*)\/detail/i;return e.test(t)||i.test(t)||s.test(t)||a.test(t)||o.test(t)||n.test(t)||l.test(t)||u.test(t)||r.test(t)||c.test(t)||d.test(t)||_.test(t)||p.test(t)||m.test(t)||b.test(t)||g.test(t)||h.test(t)||v.test(t)||w.test(t)||y.test(t)||f.test(t)||k.test(t)||$.test(t)||P.test(t)||j.test(t)||G.test(t)||I.test(t)||M.test(t)||T.test(t)||L.test(t)||x.test(t)||C.test(t)||A.test(t)||B.test(t)},Globe_Input_Text:function(t,e){e=e||t.val(),t.focus(function(){var t=$(this);$.trim(t.val())==e&&t.val(""),t.css("color","#000")}),t.blur(function(){var t=$(this);""==$.trim(t.val())&&(t.val(e),t.css("color","#ccc"))})},Globe_Input_Text_Hide:function(t){t.focus(function(){var t=$(this);$.trim(t.val())==$.trim(t.attr("def-v"))&&t.val(""),t.css("color","#000")}),t.blur(function(){var t=$(this);""==$.trim(t.val())&&(t.val(t.attr("def-v")),t.css("color","#ccc"))})},WB_Word_Count:function(t,e,i){var o=i?i:140;if($("#"+t)[0]){var n=function(){var i=0;i=MOGU.getMsgLength(e?$("#"+e).val():$("#"+t).find(".pub_txt").val());var n=o-i;0==i?$("#"+t).find(".word_count").html(o):i>o?($("#"+t).find(".word_count_wrap").html('您已超过<em class="word_count"></em>个字').find(".word_count").html(Math.abs(n)),$("#"+t).find(".word_count_wrap").show(),$("#"+t).find(".word_count").addClass("out")):($("#"+t).find(".word_count_wrap").html('还可以输入<em class="word_count"></em>个字').find(".word_count").html(n),$("#"+t).find(".word_count").removeClass("out"))};e?$("#"+e).bind("keyup",n).bind("input",n).bind("propertychange",n):$("#"+t).find(".pub_txt").bind("keyup",n).bind("input",n).bind("propertychange",n)}},Globe_Range_Input:function(t){if(t[0].createTextRange){var e=t[0].createTextRange();e.moveEnd("character",t.val().length),e.moveStart("character",t.val().length),e.select()}else t[0].setSelectionRange(t.val().length,t.val().length),t.focus()},Globe_Check_Login:function(){return""==MOGUPROFILE.userid?(user_handsome_login_init(),user_handsome_login(),!1):!0},Globe_Bind_Keybord_Submit:function(t,e,i){i=i||"need_focus","need_focus"==i&&(t.focus(function(){$("body").unbind("keydown"),$("body").bind("keydown",function(t){t.ctrlKey&&13==t.keyCode&&e.click()})}),t.blur(function(){$("body").unbind("keydown")})),"not_need_focus"==i&&$(document).bind("keydown",function(t){t.ctrlKey&&13==t.keyCode&&(e.click(),$("body").unbind("keydown"))})},GLobe_GetObj_Length:function(t){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i},Empty_Message_Tip:function(t){var e=t?t:{},i=e.pub_obj,o=null,n=0;o=setInterval(function(){n++,6==n?(clearInterval(o),i.focus()):n%2==0?i.addClass("empty_tip"):i.removeClass("empty_tip")},120)},Defult_Post_data:function(t){if(t instanceof jQuery||(t=$(t)),t.hasClass("disable"))return!1;t.addClass("disable");var e=t.data(),i=e.url||"";if(""!==i){var o=function(t){1001===t.status.code?window.location.reload():alert(t.status.msg)};jQuery.ajax({url:i,type:"POST",dataType:"json",data:e,complete:function(){t.removeClass("disable")},success:function(t){o(t)}})}},Globe_Trace_Log:function(t){var e=log_stat_url_tmp+"&rerefer="+encodeURIComponent(window.location.href)+"&tracename="+t;$.ajax({url:e,type:"post",dataType:"jsonp",jsonpCallback:"logCallBack",success:function(){}})}};MoGu.APP.Publish||(MoGu.APP.Publish={}),$.extend(MoGu.APP.Publish,t)}),define("js/lightbox.js",[],function(){MoGu.APP.Publish||(MoGu.APP.Publish={});var t=function(t){var e=this,i={title:"",titleLink:"",titleLinkText:"",lightBoxId:"",ajax:!1,contentHtml:"",scroll:!1,isBgClickClose:!0,resizeshow:!0,closeCallBack:function(){}},o=null,n='<div id="{id}" class="light_box"><iframe frameborder="0" scrolling="no" class="lb_fix"></iframe>{content}</div>',a='<table class="lb_wrap clearfix r5"><tbody><tr><td><div class="lb_hd">{title}{title_link}<a href="javascript:;" class="lb_close">×</a></div><div class="lb_bd">{body}</div></td></tr></tbody></table>',l='<div class="light_box_fullbg"></div>',s='<table class="lb_info r5"><tbody><tr><td><div class="lb_l">{text}......（<a class="lb_cs" href="javascript:;">取消</a>）</div></td></tr></tbody></table>',u='<table class="lb_info r5"><tbody><tr><td><div class="lb_s">{text}</div></td></tr></tbody></table>',r='<table class="lb_info r5"><tbody><tr><td><div class="lb_f">{text}</div></td></tr></tbody></table>',c=$.extend(i,t),d=null,_=null,p=null,f=!1,m=function(){var t=(document.documentElement.scrollTop||document.body.scrollTop)+((document.documentElement.clientHeight||document.body.clientHeight)-d.height())/2,e=window.location.toString();return 0>t?t=0:e.indexOf("is_qzone")>0&&(t/=6),t};e.getBoxFrame=function(){return d},e.getFrameId=function(){return c.lightBoxId},e.getBackground=function(){return p},e.close=function(){o&&o.abort(),d.hide(),c.closeCallBack(),d.remove(),0==$(".light_box").size()&&p.remove(),$("body").unbind("keydown")},e.hide=function(){d.hide(),p.hide(),$("body").unbind("keydown")},e.show=function(){d.show(),p.show()},e.resize=function(){var t=$(window).width(),e=(t-d.width())/2,i=m();if(_.css({width:d.width(),height:d.height()}),$.browser.msie&&"6.0"==$.browser.version&&p.css("height",document.documentElement.clientHeight||document.body.clientHeight),c.scroll)if($.browser.msie&&"6.0"==$.browser.version)d.css({left:e,top:i}).show(),f||$(window).scroll(function(){var t=m();d.css("top",t)});else{i=((document.documentElement.clientHeight||document.body.clientHeight)-d.height())/2;var o=window.location.toString();0>i?i=0:o.indexOf("is_qzone")>0&&(i/=6),d.css({left:e,top:i,position:"fixed"}).show()}else d.css({left:e,top:i}).show()},e.init=function(){if(""!=c.lightBoxId){var t=n.replace(/{id}/g,c.lightBoxId).replace(/{content}/,a);c.title&&""!=c.title&&(t=t.replace(/{title}/g,'<span class="lb_title">'+c.title+"</span>")),t=""!=c.titleLinkText?t.replace(/{title_link}/g,'<span class="lb_lnk">（<a href="'+c.titleLink+'" target="_blank">'+c.titleLinkText+"</a>）</span>"):t.replace(/{title_link}/g,""),t=c.ajax?t.replace(/{body}/g,""):t.replace(/{body}/g,c.contentHtml);var i=$(".light_box_fullbg");0==i.size()?$("body").append(t+l):($("body").append(t),i.eq(0).show()),d=$("#"+c.lightBoxId),_=$(".lb_fix"),p=$(".light_box_fullbg"),c.ajax?e.loading():(e.resize(),c.resizeshow&&$(window).resize(function(){d.filter(":visible").length<=0||e.resize()}),d.find(".lb_close").click(function(){e.close()})),c.isBgClickClose&&$(".light_box_fullbg").click(function(){e.close()})}},e.fadeout=function(){o&&o.abort(),d.fadeOut(500),p.fadeOut(500,function(){e.close()})},e.startAjax=function(t){o=t},e.buildContent=function(t){if(0==d.find(".lb_wrap").size()){var i=a.replace(/{body}/,t);c.title&&""!=c.title&&(i=i.replace(/{title}/g,'<span class="lb_title">'+c.title+"</span>")),i=""!=c.titleLinkText?i.replace(/{title_link}/g,'<span class="lb_lnk">（<a href="'+c.titleLink+'" target="_blank">'+c.titleLinkText+"</a>）</span>"):i.replace(/{title_link}/g,""),d.find(".lb_info").after(i).remove(),$("#"+c.lightBoxId+" .lb_close").click(function(){e.close()})}else d.find(".lb_bd").html(t);e.resize()},e.success=function(t){var i=u.replace(/{text}/,t);d.find(".lb_wrap").after(i).remove(),e.resize(),setTimeout(function(){e.fadeout()},1e3)},e.success_close=function(t,i){var o=u.replace(/{text}/,t);d.find(".lb_wrap").after(o).remove(),e.resize();var i=i||1e3;setTimeout(function(){e.close()},i)},e.fail=function(t,i){var o=r.replace(/{text}/,t);d.find(".lb_wrap").after(o).remove(),e.resize();var i=i||2e3;setTimeout(function(){e.close()},i)},e.loading=function(t){t=t||"请稍后";var i=s.replace(/{text}/,t);d.find(".lb_wrap").after(i).remove(),e.resize(),d.find(".lb_l .lb_cs").click(function(){e.close()}),e.resize()}};MoGu.APP.Publish.MGLightBox=t}),define("js/publish_widget.js",[],function(){if(jQuery){MoGu.APP.Publish||(MoGu.APP.Publish={});var t=MoGu.APP.Publish;$.fn.pubimg=function(e){var i={callback:function(e,i,o,n,a){t.log("code:"+e),t.log("msg:"+i),t.log("imgId:"+o),t.log("path:"+n),t.log(a)},prefun:function(){return!0},ifUserLogin:!0},o=$.extend({},i,e),n=function(){var t="publish_tool_photo_success_",e=Math.floor(99*Math.random()+1),i=t+e;return window[i]?n():i};return o.funName=n(),this.each(function(){var e=$(this),i=!0;e.unbind("click"),e.bind("click",function(){if(o.ifUserLogin&&""==MOGUPROFILE.userid){t.user_handsome_login_init();var n=e,a={callback:function(){n.show(),n.click()}};return t.user_handsome_login(!1,a),i=!1,!1}return o.prefun&&!o.prefun(e)?(i=!1,!1):void(i=!0)}),e.unbind("change"),e.bind("change",function(){if(!i)return!1;var n={title:"",lightBoxId:"lb_loading",ajax:!0,isBgClickClose:!1};loading_light_box=new t.MGLightBox(n),loading_light_box.init();var a=null;setTimeout(function(){$("#ifr_picup").parent().remove(),a&&clearInterval(a);var t=e.parents("form");"www.mogujie.com"!=location.hostname?0==t.find("input[name=host]").size()&&t.append('<input type="hidden" value="'+location.host+'" name="host">'):(0==t.find("input[name=host]").size()&&t.append('<input type="hidden" value="'+location.host+'" name="host">'),t.attr("action","http://upload.mogujie.com/upload/addpic/")),0==t.find("input[name=callback]").size()&&t.append('<input type="hidden" value="'+o.funName+'" name="callback">'),0==$("#ifr_picup").size()&&$("body").append('<div style="display: none;"><iframe frameborder="0" name="ifr_picup" id="ifr_picup" src="about:blank"></iframe></div>'),t.attr("target","ifr_picup"),t.submit(),e.val("");var i=0;a=setInterval(function(){180==i&&($("#ifr_picup").parent().remove(),alert(MGLANG.msgTimeout),clearInterval(a)),i++},1e3),window[o.funName]=function(t,i,n,l){return loading_light_box.close(),clearInterval(a),1001!=t?void alert(i):void o.callback(t,i,n,l,e)}},0)})})}}}),define("js/addpic_widget.js",[],function(){MoGu.APP.Publish||(MoGu.APP.Publish={});var t=MoGu.APP.Publish;t.Img_Pub_Widget=function(e){var i={img_limit:3,pub_img_content:$(".pub_img_content"),up_another_div:$(".pub_img_content .up_another"),up_default_div:$(".pub_img_content .default"),del_wrap:"img_wrap",hide_img_content:!1},o=$.extend(i,e),n=function(){a(),l()},a=function(){o.pub_img_content.find(".add_file").pubimg({prefun:function(){var t=(o.pub_img_content.data("img_array"),u.get_img_count());return o.img_limit>t},callback:function(e,i,n,a){if(o.uppic_cb)o.uppic_cb(e,i,n,a);else{var l={imgId:n,path:a+"_100x100.jpg"},r=['<div class="img_wrap r5">','<img src="{{= it.path }}" class="r5">','<a href="javascript:;" class="del" iid="{{= it.imgId }}"></a>',"</div>"].join("");$(".up_another").show(),$(".up_another").before(t.template(r,l))}var c=u.set_img_count(n);s(c)}})},l=function(){o.pub_img_content.find(".del").live("click",function(){var t=$(this);t.parents("."+o.del_wrap).remove(),$(".up_another").hide();var e=u.del_img_count(t.attr("iid"));s(e)})},s=function(t){0==t?o.up_default_div.show():t<o.img_limit?(o.up_default_div.hide(),o.up_another_div.show(),o.pub_img_content.show()):(o.up_default_div.hide(),o.up_another_div.hide())},u={get_img_array:function(){return"undefined"==typeof o.pub_img_content.data("img_array")?"":o.pub_img_content.data("img_array")},get_img_count:function(){var t=this.get_img_array(),e=""==$.trim(t)?0:t.replace(/^,+/,"").replace(/,+$/,"").split(/,+/).length;return e},set_img_count:function(e){var i=this.get_img_array();return t.log("1:"+i),i+=e+",",t.log("2:"+i),o.pub_img_content.data("img_array",i),this.get_img_count()},del_img_count:function(t){var e=this.get_img_array();return e=e.replace(t+",",""),o.pub_img_content.data("img_array",e),this.get_img_count()}};n()}}),define("js/publish.js",[],function(){MoGu.APP.Publish||(MoGu.APP.Publish={});var t=MoGu.APP.Publish;t.Publish_Imgs_Init=function(i,o){$("#lb_publish_box .add_file").pubimg({callback:function(n,a,l,s,u){i.close();var r={title:"我要分享",lightBoxId:"lb_publish_imgs",scroll:!1,ajax:!0,isBgClickClose:!1},c=new t.MGLightBox(r);c.init();var d={imgId:l,path:s};o=u.attr("tab")?{tab:u.attr("tab")}:o,o&&o.isdapeiroom&&(d={imgId:l,path:s,isdapeiroom:1,roomTitle:o.roomTitle});$.ajax({url:"/twitter/imgpubview",type:"POST",timeout:6e4,data:d,dataType:"json",success:function(i){if(null==i||""==i)alert(MGLANG.msgTimeout);else{var n=i.status.code,a=i.status.msg;if(1001==n){var s=i.result.data.html;if(c.buildContent(s),o&&o.albumId&&$("#lb_publish_imgs .chose_album").hide(),t.Globe_Input_Text_Hide($(".pub_box_op .pub_txt")),t.Globe_Input_Text_Hide($(".pub_addlink .addlink_con")),e(),"0"==MOGUPROFILE.is_subsite)var u=140;else var u=300;t.WB_Word_Count("lb_publish_imgs","pub_content_img",u);var r={img_limit:8,pub_img_content:$(".pub_img_content"),up_another_div:$(".pub_img_content .up_another"),up_default_div:$(".pub_img_content .default")};$(".pub_img_content").data("img_array",l+","),t.Img_Pub_Widget(r),$("#pub_content_img").focus(function(){$(".pub_img_content .word_count_wrap").show()}).blur(function(){$(".pub_img_content .word_count_wrap").hide()}),$("#lb_publish_imgs .pub_submit").click(function(){var e=$(".pub_img_content").data("img_array"),i=$("#lb_publish_imgs"),n=i.find(".pub_out input").prop("checked"),a=i.find(".pub_txt"),l=a.val();l=a.attr("def-v")==l?"":l;var s=t.getMsgLength($.trim(l));if(s>u)return alert("最多可以输入"+u+"个字，您输入得太多了。"),!1;var r=i.find(".choose").data("albumid"),d={content:l,imgIds:e,albumId:r,sync:n,local:MOGUPROFILE.local};if(o)for(var _ in o)"undefined"!=typeof o[_]&&(d[_]=o[_]);if("undefined"==typeof d.albumId){if(r=i.find(".choose").attr("albumid"),"undefined"==typeof r)return alert("你还未选择专辑"),!1;d.albumId=r}d.imageGoods=[],$(".pub_link_list .link_item").each(function(){d.imageGoods.push($(this).data("imageGoods"))});var p={data:d,succ_cb:function(t,e){o?o.albumId?(c.success_close("发表成功！"),"true"==o.reload&&setTimeout(function(){window.location.reload()},1e3)):o.starId?c.success_close('发表成功，请等待审核！ <a href="/album/show/'+r+'" class="to_see">去看看</a>',2e3):1==o.isdapeiroom&&0==o.pictureType?($("#try_apply .twitterid").val(e.result.twitterId),$(".apply_step1 .dapei_upimg").html('<img src="'+e.result.imgUrl+'" />'),c.success_close("发表成功！",1e3)):1==o.isdapeiroom&&1==o.pictureType?window.location.href=window.location.href:c.success_close('发表成功！ <a href="/album/show/'+r+'" class="to_see">去看看</a>',2e3):c.success_close('发表成功！ <a href="/album/show/'+r+'" class="to_see">去看看</a>',2e3),$(".pub_img_content").data("img_array","")},fail_cb:function(){c.fail('发表失败！ <a href="javascript:;" class="try_again">再试一次</a>'),$(".pub_img_content").data("img_array","")}};t.Publish_Pub_Submit(p)})}else alert(a)}},error:function(t,e){"timeout"==e&&alert(MGLANG.msgTimeout)},complete:function(){}})}})};var e=function(){$(".pub_addlink .addlink_btn").bind("click",function(){var e=$.trim($(".pub_addlink .addlink_con").val()),i=$(".pub_addlink .addlink_con").attr("def-v");return""==e||e==i?(alert("请填写商品地址"),!1):t.Globe_Goods_URL_Support(e)?$(".pub_addlink .pub_link_list li").size()>=6?(alert("最多只能添加6个相关链接哦！"),!1):void $.ajax({url:"/twitter/goodsinfo",type:"POST",timeout:6e4,data:{url:e,type:1},dataType:"json",success:function(t){if(null==t||""==t)alert(MGLANG.msgTimeout),goods_frame.remove();else{var e=t.status.code,i=t.status.msg;if(1001==e){var o=t.result.data.detail,n=o.num_id,a=o.shop_seller,n=o.num_id,l=o.from,s=o.iid,u=".link_item_"+n+"_"+l+"_"+s;if($(".pub_link_list "+u).size()>0)return void alert("不能添加相同的商品");var r=t.result.data.html,c=$(".pub_addlink .pub_link_list li").size()+1;$(".pub_link_list").show(),$(".pub_link_list").append(r.replace(/{num}/g,c));var d=$(".pub_link_list "+u);d.data("imageGoods",o);var _="还可添加"+(6-c)+"条链接";6==c&&(_="最多只能添加6个相关链接哦！"),$(".pub_addlink .addlink_con").val(_).attr("def-v",_).css({color:"#ccc"});var p=0;$(".pub_link_list .link_item").each(function(t,e){$(e).attr("shop")==a&&p++}),p>=3&&$(".pub_addlink .error").show()}else alert(i)}}}):(alert("请填写正确的商品地址"),!1)}),$(".pub_link_list .link_item .del").live("click",function(){var e=0,i=$(this).parents(".link_item"),o=i.attr("shop");t.log(o),$(".pub_link_list .link_item").each(function(t,i){$(i).attr("shop")==o&&e++}),i.remove(),$(".pub_link_list .link_item").each(function(t,e){$(e).find(".num").html(t+1)});var n=$(".pub_link_list .link_item").size();0==n&&$(".pub_link_list").hide();var a="还可添加"+(6-n)+"条链接";$(".pub_addlink .addlink_con").val(a).attr("def-v",a).css({color:"#ccc"}),3==e&&$(".pub_addlink .error").hide()})};t.Publish_Goods_Init=function(e,i){var o=['<div class="pub_goods_url clearfix">','<div class="clearfix">','<input class="g_url fl" type="text" value="将商品网址粘贴到这里" placeholder="将商品网址粘贴到这里">','<input class="g_s fl" value="确定" type="button">',"</div>",'<div class="support_site">','<span class="title">已支持以下网站</span>','<p class="support_list">','<a href="http://www.taobao.com/" target="_blank">淘宝</a>','<a href="http://www.paipai.com/" target="_blank">拍拍</a>','<a href="http://www.dangdang.com/" target="_blank">当当</a>','<a href="http://www.vancl.com/" target="_blank">凡客</a>','<a href="http://www.360buy.com/" target="_blank">京东</a>','<a href="http://www.topshop.com/" target="_blank">Topshop</a>','<a href="http://buy.caomeipai.com/" target="_blank">草莓派</a>','<a href="http://www.mbaobao.com/" target="_blank">麦包包</a>','<a href="http://www.nala.com.cn/" target="_blank">NALA</a>','<a href="http://www.maymay.cn/" target="_blank">Maymay</a>','<a href="http://www.asos.com/" target="_blank">asos</a>','<a href="http://www.100f1.com/" target="_blank">我的百分之一</a>','<a href="http://www.51yugou.com/" target="_blank">稀品网</a>','<a href="http://www.rosebeauty.com.cn/" target="_blank">玫瑰社区</a>','<a href="http://cn.shopbop.com/" target="_blank">SHOPBOP</a>',"</p>","</div>","</div>"].join("");e.buildContent(o),t.Publish_Goods_Func(e,i)},t.Publish_Goods_Func=function(e,i){var o=$("#lb_publish_box");t.Globe_Input_Text(o.find(".g_url")),o.find(".g_s").click(function(){e.close();var n=$(this);if(1!=n.data("isSubmit")){var a=t.trim(o.find(".g_url").val());if(""==a)return alert("请填写商品地址"),!1;if(!t.Globe_Goods_URL_Support(a))return alert("请填写正确的商品地址"),!1;var l={title:"我要分享",lightBoxId:"lb_publish_goods",scroll:!1,ajax:!0,isBgClickClose:!1},s=new t.MGLightBox(l);s.init(),n.data("isSubmit",1),getGoodInfo=$.ajax({url:"/twitter/goodsinfo",type:"POST",timeout:6e4,data:{url:a},dataType:"json",success:function(e){if(null==e||""==e)alert(MGLANG.msgTimeout),o.remove();else{var n=e.status.code,a=e.status.msg;if(1001==n){var l=e.result.data.detail,u=l.num_id;t.WB_Goods_Array={},t.WB_Goods_Array[u]=l;var r=e.result.data.html;s.buildContent(r),t.WB_Word_Count("lb_publish_goods","pub_content_goods",140),t.Globe_Input_Text_Hide($(".pub_box_op .pub_txt")),i&&i.albumId&&$("#lb_publish_goods .chose_album").hide(),$("#lb_publish_goods .pub_submit").click(function(){var e=$("#lb_publish_goods"),o=e.find(".pub_out input").prop("checked"),n=e.find(".pub_txt"),a=n.val(),l="/twitter/newtwitter";a=n.attr("def-v")==a?"":a;var u=t.getMsgLength($.trim(a));if(u>140)return alert("最多可以输入140个字，您输入得太多了。"),!1;var r=e.find(".choose").data("albumid"),c={content:a,albumId:r,goods:t.objToJson(t.WB_Goods_Array),sync:o,local:MOGUPROFILE.local};if(i)for(var d in i)"undefined"!=typeof i[d]&&(c[d]=i[d]);if("undefined"==typeof c.albumId){if(r=e.find(".choose").attr("albumid"),"undefined"==typeof r)return alert("你还未选择专辑"),!1;c.albumId=r}c.url&&c.url.length>0&&(l=c.url);var _={data:c,url:l,succ_cb:function(){i?(i.albumId&&s.success_close("发表成功"),"true"==i.reload&&setTimeout(function(){window.location.reload()},1e3)):s.success_close('发表成功！ <a href="/album/show/'+r+'" class="to_see">去看看</a>',2e3),t.WB_Goods_Array={}},fail_cb:function(){s.fail('发表失败！ <a href="javascript:;" class="try_again">再试一次</a>'),t.WB_Goods_Array={}}};t.Publish_Pub_Submit(_)})}else alert(a),o.remove()}},error:function(t,e){"timeout"==e&&alert(MGLANG.msgTimeout)},complete:function(){n.removeData("isSubmit")}})}})},t.Publish_Pub_Submit=function(t){var e={url:"/twitter/newtwitter",data:{},pub_btn:$(".pub_submit"),succ_cb:function(){},fail_cb:function(){}},i=$.extend(e,t);if(1!=i.pub_btn.data("isSubmit")){var o=i.data;o._fk=1,$.ajax({url:i.url,type:"POST",timeout:6e4,data:o,dataType:"json",beforeSend:function(){i.pub_btn.data("isSubmit",1)},success:function(t){if(null==t||""==t)alert(MGLANG.msgTimeout);else{var e=t.status;if(void 0==e||null==e)return void alert(MGLANG.msgTimeout);var o=e.code,n=e.msg;1001==o?i.succ_cb(e,t):2710==o?alert(n):(i.fail_cb(e,t),alert(n))}},error:function(t,e){"timeout"==e&&alert(MGLANG.msgTimeout)},complete:function(){i.pub_btn.removeData("isSubmit")}})}},t.Publish_Pub_Box_Init=function(e){var i="1"==MOGUPROFILE.is_subsite?"上传美图":"上传你的搭配晒货照",o=['<div class="pub_chose clearfix">','<a href="javascript:;" class="chose_goods chose_type r5">',"<b></b>","<p>商品</p>","<span>输入网购商品的链接</span>","</a>",'<a href="javascript:;" class="chose_pic chose_type r5">','<div class="up_pic_wrap">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" id="upload_img" name="image" class="add_file">',"</form>","</div>","<b></b>","<p>照片</p>","<span>"+i+"</span>","</a>","</div>"].join(""),n={title:"我要分享",lightBoxId:"lb_publish_box",scroll:!1,contentHtml:o,isBgClickClose:!1,type:"default"},a=new t.MGLightBox(n);a.init(),$("#lb_publish_box .chose_goods").click(function(){t.Publish_Goods_Init(a,e)}),t.Publish_Imgs_Init(a,e)},t.Home_Pub_Face=function(){$(".pub_box_op .add_face_new").live("click",function(){var e=$(this).parents(".pub_box_op").find(".pub_txt"),i={click_obj:$(this),output:e},o=new t.WB_Add_Face_Init_New(i);o.init()})},t.Home_Pub_Face()}),define("js/publish_img.js",[],function(){MoGu.APP.Publish||(MoGu.APP.Publish={});var t=MoGu.APP.Publish;t.Publish_Pub_Box_Init_Daren=function(e){var i=("1"==MOGUPROFILE.is_subsite?"上传美图":"上传你的搭配晒货照",['<div class="publish_img">','<div class="publish_wrap clearfix">','<div class="dapei item">','<a href="javascript:;" class="upload_wrap">','<div class="upload_file">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" name="image" class="add_file" tab="4">',"</form>","</div>",'<div class="upload_box">','<img src="http://s8.mogujie.cn/pic/131022/sp1ku_kqywm3c2kfbegrlwgfjeg5sckzsew_98x98.jpg">',"</div>",'<div class="upload_btn">',"</div>","</a>","</div>",'<div class="look item">','<a href="javascript:;" class="upload_wrap">','<div class="upload_file">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" name="image" class="add_file" tab="3">',"</form>","</div>",'<div class="upload_box">','<img src="http://s6.mogujie.cn/pic/131022/sp1ku_kqywomlckfbfiq2ugfjeg5sckzsew_98x98.jpg">',"</div>",'<div class="upload_btn">',"</div>","</a>","</div>",'<div class="other item">','<a href="javascript:;" class="upload_wrap">','<div class="upload_file">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" name="image" class="add_file">',"</form>","</div>",'<div class="upload_box">','<img src="http://s6.mogujie.cn/pic/131022/sp1ku_kqyvo4kfkfbegq2ugfjeg5sckzsew_98x98.jpg">',"</div>",'<div class="upload_btn">',"</div>","</a>","</div>","</div>","</div>"].join("")),o={title:'分享照片<b style="margin-left:20px;font-size:12px;color:#ff3b60">选择对应的分类，被精彩的概率会更高哦</b><a href="http://www.mogujie.com/group/topic/1z14w" target="_blank" class="publish_img_share" style="position: absolute; top: -25px; right: 17px; width: 120px; height: 88px; overflow: hidden; text-indent: -999em; background: url(http://s12.mogujie.cn/pic/140516/未标题-1_kq2eeutykrbhm2cugfjeg5sckzsew_120x88.png) no-repeat; _filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=\'scale\',src=\'http://s12.mogujie.cn/pic/140516/未标题-1_kq2eeutykrbhm2cugfjeg5sckzsew_120x88.png\'); _background-image: none;">分享得佣金</a>',lightBoxId:"lb_publish_box",scroll:!1,contentHtml:i,isBgClickClose:!1,type:"default"},n=new t.MGLightBox(o);n.init(),$("#lb_publish_box .chose_goods").click(function(){t.Publish_Goods_Init(n,e)}),t.Publish_Imgs_Init(n,e)}}),require(["js/tool.js","js/func.js","js/lightbox.js","js/publish_widget.js","js/addpic_widget.js","js/publish.js","js/publish_img.js"],function(){MoGu.APP.Publish&&MoGu.APP.Publish.Publish_Pub_Box_Init_Daren()}),define("index",function(){});