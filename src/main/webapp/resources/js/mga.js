!function(a,b,c){b.MGTOOL={},a.extend(MGTOOL,{byteLength:function(a){var b=a.match(/[^\x00-\x80]/g);return a.length+(b?b.length:0)},jsMbSubstr:function(a,b){if(!a||!b)return"";var c=0,d=0,e="",f=a.length;for(d=0;f>d;d++){if(c=a.charCodeAt(d)>255?c+=2:++c,c>2*b)return e;e+=a.charAt(d)}return a},formatMoney:function(a,b,c){if(b=MGTOOL.empty(a)?"2":b,MGTOOL.empty(c))return a.toFixed(b);var d=0>a?"-":"",e=parseInt(a=Math.abs(+a||0).toFixed(b),10)+"",f=(f=e.length)>3?f%3:0;return d+(f?e.substr(0,f)+c:"")+e.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+c)+(b?"."+Math.abs(a-e).toFixed(b).slice(2):"")}}),a.extend(MGTOOL,{emptyObj:function(a){for(var b in a)return!1;return!0},empty:function(a){return null==a||0===a.length},objToJson:function(a){return JSON.stringify(a)}}),a.extend(MGTOOL,{setCookie:function(a,b,c){c=c||{},null===b&&(b="",c.expires=-1);var d="";if(c.expires&&("number"==typeof c.expires||c.expires.toUTCString)){var e;"number"==typeof c.expires?(e=new Date,e.setTime(e.getTime()+864e5*c.expires)):e=c.expires,d="; expires="+e.toUTCString()}var f=c.path?"; path="+c.path:"",g=c.secure?"; secure":"",h="";c.domain?h="; domain="+c.domain:(h=document.domain.toString().split("."),h="; domain=."+h[1]+"."+h[2]),document.cookie=[a,"=",encodeURIComponent(b),d,f,h,g].join("")},getCookie:function(a){var b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null!==b?decodeURIComponent(b[2]):""},removeCookie:function(a){MGTOOL.setCookie(a,null,{expires:-1})},setCacheCookie:function(b,c,d,e){d=d||{},null===c&&(c="");var f="undefined"==typeof e?MGTOOL.getCookie("__mgjuuid"):e;a.ajax({url:"/collect/uedcookie",type:"POST",timeout:6e4,data:{cookiename:b,uuid:f,type:"set",value:c,lifetime:86400*d.expires},dataType:"json",success:function(a){""===a&&alert(MGLANG.msgTimeout)}})},getCacheCookie:function(b,c){var d="undefined"==typeof c?MGTOOL.getCookie("__mgjuuid"):c,e="";return a.ajax({url:"/collect/uedcookie",type:"POST",timeout:6e4,async:!1,data:{cookiename:b,uuid:d,type:"get"},dataType:"json",success:function(a){{var b=a.status.code;a.status.msg}if(1001==b){var c=a.result.data.value;e=c}else alert(MGLANG.msgTimeout)}}),e}}),a.extend(MGTOOL,{getQueryString:function(a,b){b="undefined"!=typeof b?b:location.href;var c=new RegExp("(^|\\?|&)"+a+"=([^&]*)(\\s|&|$)","i");return c.test(b)?RegExp.$2.replace(/\+/g," "):""},getPicExtension:function(a){return/(.+)\.(.+)/.exec(a)?RegExp.$2:""},filterDomain:function(a){var b=/http:\/\/[^\/]+/;return a.replace(b,"")}}),a.extend(MGTOOL,{throttleM:{isLoading:!1,throttoleXhr:function(a,b){var c=this;if(!c.isLoading){b=b||500,c.isLoading=!0;var d=a();d.complete=function(){setTimeout(function(){c.isLoading=!1},b)}}}}}),a.extend(MGTOOL,{getMsgLength:function(a){var b=a.length;if(b>0){for(var c=41,d=140,e=24,f=a,g=a.match(/http[s]?:\/\/[a-zA-Z0-9-]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/\/,:;@&=\?\~\#\%]*)*/gi)||[],h=0,i=0,j=g.length;j>i;i++){var k=MGTOOL.byteLength(g[i]);/^(http:\/\/mogujie.cn)/.test(g[i])||(h+=/^(http:\/\/)+(mogujie.cn|mogujie.com)/.test(g[i])?c>=k?k:d>=k?e:k-d+e:d>=k?e:k-d+e,f=f.replace(g[i],""))}return Math.ceil((h+MGTOOL.byteLength(f))/2)}return 0},getAbsoluteLocation:function(c){if(1!==arguments.length||null===c)return null;var d=a(c),e=d.offset(),f=e.top,g=e.left,h=d.height(),i=a(b).height(),j=a(document).scrollTop(),k=f>=j&&j+i>=f,l=f+h+200>=j&&j+i>=f-400;return{absoluteTop:f,absoluteLeft:g,isInView:k,isLoad:l}},distance2Bottom:function(c){var d=a(document),e=a(b),f=d.scrollTop(),g=e.height(),h=d.height();return f+g+c>=h},isParent:function(a,b){for(;a!==c&&null!==a&&"BODY"!=a.tagName.toUpperCase();){if(a==b)return!0;a=a.parentNode}return!1},template:function(a,b){return doT.template(a)(b)},log:function(a){b.console!==c&&console.log(a)},dataFormat:function(a,b){var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b}}),a.extend(MGTOOL,{trim:function(b){return a.trim(b)},getRequest:function(a,b){return this.getQueryString(a,b)}})}(jQuery,window);var MOGU=MOGU||{};!function(a){MOGU.Globe_Textarea_Auto_Height=function(b){var c=b.height(),d=function(){0>c&&(c=b.height()),(a.browser.mozilla||a.browser.safari)&&b.height(c);var d=b[0].scrollHeight,e=c>d?c:d;e=1.5*c>e?c:d,b.height(e)};b.bind("keyup",d).bind("input",d).bind("propertychange",d).bind("focus",d)},MOGU.Globe_Goods_URL_Support=function(a){var b=/item(.[\w]+)?.taobao.com\/(.?)[item.htm|item_num_id|item_detail|itemID|item_id|default_item_id]/i,c=/detail.tmall/i,d=/auction\d?.paipai.com/i,e=/buy.caomeipai.com\/goods/i,f=/www.360buy.com\/product/i,g=/product.dangdang.com\/Product.aspx\?product_id=/i,h=/book.360buy.com/i,i=/www.vancl.com\/StyleDetail/i,j=/www.vancl.com\/Product/i,k=/vt.vancl.com\/item/i,l=/item.vancl.com\/\d+/i,m=/item.vt.vancl.com\/\d+/i,n=/(mbaobao.com\/pshow)|(mbaobao.com\/item)/i,o=/item.buy.qq.com\/item/i,p=/[www|us].topshop.com\/webapp\/wcs\/stores\/servlet\/ProductDisplay/i,q=/quwan.com\/goods/i,r=/nala.com.cn\/product/i,s=/maymay.cn\/pitem/i,t=/asos.com/i,u=/www.100f1.com\/ProductInfo_/i,v=/www.gaojie.com\/product/i,w=/a.m.taobao.com\/i/i,x=/www.51yugou.com\//i,y=/www.1mall.com\//i,z=/www.yihaodian.com\//i,A=/www.xipin.me\//i,B=/www.nuandao.com\//i,C=/www.rosebeauty.com.cn\//i,D=/www.hmeili.com\//i,E=/www.yueji.com\//i,F=/www.yougou.com\//i,G=/cn.shopbop.com\//i,H=/item.jd.com\//i,I=/[www|shop].mogujie.com(.*)\/detail/i;return b.test(a)||c.test(a)||h.test(a)||f.test(a)||d.test(a)||e.test(a)||g.test(a)||i.test(a)||j.test(a)||k.test(a)||l.test(a)||m.test(a)||n.test(a)||p.test(a)||q.test(a)||r.test(a)||s.test(a)||t.test(a)||u.test(a)||v.test(a)||o.test(a)||w.test(a)||x.test(a)||z.test(a)||A.test(a)||B.test(a)||C.test(a)||D.test(a)||E.test(a)||F.test(a)||y.test(a)||G.test(a)||H.test(a)||I.test(a)},MOGU.Globe_Input_Text=function(b,c){c=c||b.val(),b.focus(function(){var b=a(this);a.trim(b.val())==c&&b.val(""),b.css("color","#000")}),b.blur(function(){var b=a(this);""==a.trim(b.val())&&(b.val(c),b.css("color","#ccc"))})},MOGU.Globe_Input_Text_Hide=function(b){b.focus(function(){var b=a(this);a.trim(b.val())==a.trim(b.attr("def-v"))&&b.val(""),b.css("color","#000")}),b.blur(function(){var b=a(this);""==a.trim(b.val())&&(b.val(b.attr("def-v")),b.css("color","#ccc"))})},MOGU.WB_Word_Count=function(b,c,d){var e=d?d:140;if(a("#"+b)[0]){var f=function(){var d=0;d=c?MGTOOL.getMsgLength(a("#"+c).val()):MGTOOL.getMsgLength(a("#"+b).find(".pub_txt").val());var f=e-d;0==d?a("#"+b).find(".word_count").html(e):d>e?(a("#"+b).find(".word_count_wrap").html('您已超过<em class="word_count"></em>个字').find(".word_count").html(Math.abs(f)),a("#"+b).find(".word_count_wrap").show(),a("#"+b).find(".word_count").addClass("out")):(a("#"+b).find(".word_count_wrap").html('还可以输入<em class="word_count"></em>个字').find(".word_count").html(f),a("#"+b).find(".word_count").removeClass("out"))};c?a("#"+c).bind("keyup",f).bind("input",f).bind("propertychange",f):a("#"+b).find(".pub_txt").bind("keyup",f).bind("input",f).bind("propertychange",f)}},MOGU.Globe_Range_Input=function(a){if(a[0].createTextRange){var b=a[0].createTextRange();b.moveEnd("character",a.val().length),b.moveStart("character",a.val().length),b.select()}else a[0].setSelectionRange(a.val().length,a.val().length),a.focus()},MOGU.Globe_Check_Login=function(){return""==MOGUPROFILE.userid?(MOGU.user_handsome_login_init(),MOGU.user_handsome_login(),!1):!0},MOGU.Globe_Short_Link_From=function(){a(".mg_slink").live("click",function(){var b=window.location.toString();if(!(b.indexOf("is_qzone=1")>=0)){var c=this,d=c.href,e=a(c).attr("s"),f=a(c).attr("c");""==f&&(f=MOGUPROFILE.userid);var g=d,h="";h=-1==d.indexOf("?")?"?c="+f+"&s="+e:"&c="+f+"&s="+e,g+=h,c.href=g,setTimeout(function(){c.href=d},500)}})},MOGU.Globe_Short_Link_From(),MOGU.Globe_Bind_Keybord_Submit=function(b,c,d){d=d||"need_focus","need_focus"==d&&(b.focus(function(){a("body").unbind("keydown"),a("body").bind("keydown",function(a){a.ctrlKey&&13==a.keyCode&&c.click()})}),b.blur(function(){a("body").unbind("keydown")})),"not_need_focus"==d&&a(document).bind("keydown",function(b){b.ctrlKey&&13==b.keyCode&&(c.click(),a("body").unbind("keydown"))})},MOGU.GLobe_GetObj_Length=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},MOGU.Empty_Message_Tip=function(a){var b=a?a:{},c=b.pub_obj,d=null,e=0;d=setInterval(function(){e++,6==e?(clearInterval(d),c.focus()):e%2==0?c.addClass("empty_tip"):c.removeClass("empty_tip")},120)},MOGU.Defult_Post_data=function(b){if(b instanceof jQuery||(b=a(b)),b.hasClass("disable"))return!1;b.addClass("disable");var c=b.data(),d=c.url||"";if(""!==d){var e=function(a){1001===a.status.code?window.location.reload():alert(a.status.msg)};jQuery.ajax({url:d,type:"POST",dataType:"json",data:c,complete:function(){b.removeClass("disable")},success:function(a){e(a)}})}},MOGU.Globe_Trace_Log=function(b){var c=log_stat_url_tmp+"&rerefer="+encodeURIComponent(window.location.href)+"&tracename="+b;a.ajax({url:c,type:"post",dataType:"jsonp",jsonpCallback:"logCallBack",success:function(){}})},a.fn.serializeObject=function(){var b={},c=this.serializeArray();return a.each(c,function(){void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||""}),b},MOGU.SerializeFormObject=function(a){a.serializeObject()}}(jQuery),$(function(){$(document).off("click",".__trace__").on("click",".__trace__",function(){var a=$(this).attr("data-trace");a&&MOGU.Globe_Trace_Log(a)})}),function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();!function(a){MGLightBox=function(b){var c=this,d={title:"",titleLink:"",titleLinkText:"",lightBoxId:"",ajax:!1,contentHtml:"",scroll:!1,isBgClickClose:!0,resizeshow:!0,closeCallBack:function(){}},e=null,f='<div id="{id}" class="light_box"><iframe frameborder="0" scrolling="no" class="lb_fix"></iframe>{content}</div>',g='<table class="lb_wrap clearfix r5"><tbody><tr><td><div class="lb_hd">{title}{title_link}<a href="javascript:;" class="lb_close">×</a></div><div class="lb_bd">{body}</div></td></tr></tbody></table>',h='<div class="light_box_fullbg"></div>',i='<table class="lb_info r5"><tbody><tr><td><div class="lb_l">{text}......（<a class="lb_cs" href="javascript:;">取消</a>）</div></td></tr></tbody></table>',j='<table class="lb_info r5"><tbody><tr><td><div class="lb_s">{text}</div></td></tr></tbody></table>',k='<table class="lb_info r5"><tbody><tr><td><div class="lb_f">{text}</div></td></tr></tbody></table>',l=a.extend(d,b),m=null,n=null,o=null,p=!1,q=function(){var a=(document.documentElement.scrollTop||document.body.scrollTop)+((document.documentElement.clientHeight||document.body.clientHeight)-m.height())/2,b=window.location.toString();return 0>a?a=0:b.indexOf("is_qzone")>0&&(a/=6),a};c.getBoxFrame=function(){return m},c.getFrameId=function(){return l.lightBoxId},c.getBackground=function(){return o},c.close=function(){e&&e.abort(),m.hide(),l.closeCallBack(),m.remove(),0==a(".light_box").size()&&o.remove(),a("body").unbind("keydown")},c.hide=function(){m.hide(),o.hide(),a("body").unbind("keydown")},c.show=function(){m.show(),o.show()},c.resize=function(){var b=a(window).width(),c=(b-m.width())/2,d=q();if(n.css({width:m.width(),height:m.height()}),a.browser.msie&&"6.0"==a.browser.version&&o.css("height",document.documentElement.clientHeight||document.body.clientHeight),l.scroll)if(a.browser.msie&&"6.0"==a.browser.version)m.css({left:c,top:d}).show(),p||a(window).scroll(function(){var a=q();m.css("top",a)});else{d=((document.documentElement.clientHeight||document.body.clientHeight)-m.height())/2;var e=window.location.toString();0>d?d=0:e.indexOf("is_qzone")>0&&(d/=6),m.css({left:c,top:d,position:"fixed"}).show()}else m.css({left:c,top:d}).show()},c.init=function(){if(""!=l.lightBoxId){var b=f.replace(/{id}/g,l.lightBoxId).replace(/{content}/,g);l.title&&""!=l.title&&(b=b.replace(/{title}/g,'<span class="lb_title">'+l.title+"</span>")),b=""!=l.titleLinkText?b.replace(/{title_link}/g,'<span class="lb_lnk">（<a href="'+l.titleLink+'" target="_blank">'+l.titleLinkText+"</a>）</span>"):b.replace(/{title_link}/g,""),b=l.ajax?b.replace(/{body}/g,""):b.replace(/{body}/g,l.contentHtml);var d=a(".light_box_fullbg");0==d.size()?a("body").append(b+h):(a("body").append(b),d.eq(0).show()),m=a("#"+l.lightBoxId),n=a(".lb_fix"),o=a(".light_box_fullbg"),l.ajax?c.loading():(c.resize(),l.resizeshow&&a(window).resize(function(){m.filter(":visible").length<=0||c.resize()}),m.find(".lb_close").click(function(){c.close()})),l.isBgClickClose&&a(".light_box_fullbg").click(function(){c.close()})}},c.fadeout=function(){e&&e.abort(),m.fadeOut(500),o.fadeOut(500,function(){c.close()})},c.startAjax=function(a){e=a},c.buildContent=function(b){if(0==m.find(".lb_wrap").size()){var d=g.replace(/{body}/,b);l.title&&""!=l.title&&(d=d.replace(/{title}/g,'<span class="lb_title">'+l.title+"</span>")),d=""!=l.titleLinkText?d.replace(/{title_link}/g,'<span class="lb_lnk">（<a href="'+l.titleLink+'" target="_blank">'+l.titleLinkText+"</a>）</span>"):d.replace(/{title_link}/g,""),m.find(".lb_info").after(d).remove(),a("#"+l.lightBoxId+" .lb_close").click(function(){c.close()})}else m.find(".lb_bd").html(b);c.resize()},c.success=function(a){var b=j.replace(/{text}/,a);m.find(".lb_wrap").after(b).remove(),c.resize(),setTimeout(function(){c.fadeout()},1e3)},c.success_close=function(a,b){var d=j.replace(/{text}/,a);m.find(".lb_wrap").after(d).remove(),c.resize();var b=b||1e3;setTimeout(function(){c.close()},b)},c.fail=function(a,b){var d=k.replace(/{text}/,a);m.find(".lb_wrap").after(d).remove(),c.resize();var b=b||2e3;setTimeout(function(){c.close()},b)},c.loading=function(a){a=a||"请稍后";var b=i.replace(/{text}/,a);m.find(".lb_wrap").after(b).remove(),c.resize(),m.find(".lb_l .lb_cs").click(function(){c.close()}),c.resize()}}}(jQuery);window.Messenger=function(){function t(t,e){var i="";if(arguments.length<2?i="target error - target and name are both requied":"object"!=typeof t?i="target error - target itself must be window object":"string"!=typeof e&&(i="target error - target name must be string type"),i)throw new Error(i);this.target=t,this.name=e}function e(t,e){this.targets={},this.name=t,this.listenFunc=[],i=e||i,this.initListen()}var i="[PROJECT_NAME]",o="postMessage"in window;return t.prototype.send=o?function(t){this.target.postMessage(i+t,"*")}:function(t){var e=window.navigator[i+this.name];"function"==typeof e&&e(i+t,window)},e.prototype.addTarget=function(e,i){var o=new t(e,i);this.targets[i]=o},e.prototype.initListen=function(){var t=this,e=function(e){"object"==typeof e&&e.data&&(e=e.data),e=e.slice(i.length);for(var o=0;o<t.listenFunc.length;o++)t.listenFunc[o](e)};o?"addEventListener"in document?window.addEventListener("message",e,!1):"attachEvent"in document&&window.attachEvent("onmessage",e):window.navigator[i+this.name]=e},e.prototype.listen=function(t){this.listenFunc.push(t)},e.prototype.clear=function(){this.listenFunc=[]},e.prototype.send=function(t){var e,i=this.targets;for(e in i)i.hasOwnProperty(e)&&i[e].send(t)},e}();var MOGU=window.MOGU||{};MOGU.alert=MOGU.alert||function(t){window.alert(t)},MOGU.IM_Module=function(t,e,i,o,a,n,r){n=n||(n=MoGu.util);var s="http://www.mogujie.com",d=t.ActiveXObject&&!t.XMLHttpRequest?!0:!1,c={style2:{width:"82",height:"26"},"default":{width:"85",height:"24"},widget1:{width:"40",height:"55"},widget2:{width:"40",height:"55"},widget3:{width:"18",height:"22"},yaya_style:{width:"64",height:"70"}},l=null,m=function(t){for(var e in c)if(t.hasClass(e))return e;return null},u=function(t,e){if(void 0===e){var i=n.getCookie(t);return""===i?void 0:r.parse(i)}n.setCookie(t,r.stringify(e),{expires:1,path:"/"})},f=function(t,e){if(void 0===e){var i=n.getCookie(t);return""===i?void 0:i}n.setCookie(t,e,{expires:1,path:"/"})},p=function(t){var e,o,a,n;o=['<div id="J_im_loadingdom" class="im-waiting">','<img class="lo_yaya" src="//s6.mogujie.cn/pic/140514/ubzlo_kqzdcv2mozbfqwtwgfjeg5sckzsew_93x93.gif" width="93" height="93">','<p class="lo_word J_im_loading_dis"></p>',"</div>"].join(""),e=['<style id="J_im_loadingstyle">','.im-waiting{display:none;position:fixed;left:50%;top:50%;margin-left:-66px;margin-top:-66px;width:130px;height:130px;background:#fff;border:1px solid #dcdcdc;z-index:1000;border-radius:8px;box-shadow:0 0 12px rgba(0, 0, 0, .3);_position:absolute;_top:expression(document.compatMode && document.compatMode=="CSS1Compat"?documentElement.scrollTop+documentElement.clientHeight/2:document.body.scrollTop+document.body.clientHeight/2);}',".im-waiting .lo_yaya{display:block;margin:4px auto 0;}",".im-waiting .lo_word{color:#FC3C75;text-align:center;font-size:14px;}","</style>"].join(""),a=i("#J_im_loadingstyle"),a.length<=0&&i("head").append(e),n=i("#J_im_loadingdom"),n.length<=0&&(n=i(o),i("body").append(n)),n.find(".J_im_loading_dis").html(t),n.show(300),setTimeout(function(){h()},3e4)},h=function(){i("#J_im_loadingdom").hide(300)},g=function(t,e,o,n){var r,c,l,m,u=/com\/detail\/(1[a-z0-9]+)/;r=s+"/mtalk/imv2/",a&&a.atc&&(r+="?atc="+a.atc),c=['<style id="J_imframe_style">','.im-frame{position:fixed;visibility:hidden;width:569px;height:418px;right:120px;bottom:36px;z-index:1000;_position:absolute;_bottom:auto;_top:expression((document.compatMode && document.compatMode=="CSS1Compat"?documentElement.scrollTop+(documentElement.clientHeight-this.clientHeight):document.body.scrollTop+(document.body.clientHeight-this.clientHeight))-36);}',".im-closed{right:-600px!important;_right:120px;_display:none;}",".im-frame-proxy{position:fixed;width:476px;height:28px;right:148px;bottom:401px;z-index:1001;cursor:move;}",".im-proxy-closed{display:none;}",".ST_im-frame-proxy-move{background:#EBFAFF;opacity:.8;filter:alpha(opacity=80);}","html,body{_background-image:url(about:blank);_background-attachment:fixed;}","</style>"].join(""),l=['<iframe class="im-frame im-closed" id="J_imframe" src="" allowtransparency="true" scrolling="no" marginwidth="0" marginheight="0" width="569" height="418" frameborder="0"></iframe>'].join(""),m=['<div class="im-frame-proxy im-proxy-closed" id="J_imframe_proxy"></div>'].join("");var h=i("#J_imframe_style");h.length<=0&&i("head").append(c);var g=i("#J_imframe"),y=i("#J_imframe_proxy");if(g.length<=0&&(g=i(l),y=i(m),i("body").append(g),d||i("body").append(y),setTimeout(function(){g.css("visibility","visible")},1e3),p("正在连接...")),g.hasClass("im-closed")&&(g.removeClass("im-closed"),y.removeClass("im-proxy-closed")),t)g.attr("src",r+"#chat/"+t);else if(e){e.indexOf("#")<0&&(e+="#23");var _=decodeURIComponent(n).match(u),b="";_&&_[1]&&(b+="/g"+_[1]),g.attr("src",r+"#chat/b"+encodeURIComponent(e)+b)}else{var w=f("imcuid");w=w&&w.split("/"),w&&"hold"===w[0]&&w[1]?g.attr("src",r+"#chat/"+w[1]):g.attr("src",r+"#chat")}},y=function(e,o,a,n,d,c){if("service"===a){var m,f,p,h,y;t.webkitNotifications&&0!==t.webkitNotifications.checkPermission()&&t.webkitNotifications.requestPermission(function(){}),h="__mogutalk_boot",y={enable:"true"},e?(y.uid=e,u(h,y)):o&&(o.indexOf("#")<0&&(o+="#23"),y.bid=o,u(h,y)),f=u("__mogutalk_life"),p=+new Date,m=Math.abs(p-parseInt(f,10)),(void 0===f||m>4e3)&&t.open(s+"/mtalk","im","top=50,left=100,width=1000,height=640,location=yes,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbar=no")}else if("cm"===a){var _={};c&&"true"===c&&(_.imclient="1.0"),i.ajax({url:"/mtalk/im/calltobusiness",data:_,type:"POST",dataType:"json",success:function(){}})}else self!==top?l&&l.send(r.stringify({code:1001,data:{uid:e,bid:o,utype:a,refer:n,from:d}})):g(e,o,a,n,d)},_=function(){self!==top?(l=new Messenger("Frame","ImFrame"),l.addTarget(t.parent,"Parent")):(l=new Messenger("Parent","ImFrame"),l.listen(function(t){try{switch(t=r.parse(t),t.code){case 1001:var e=t.data;y(e.uid,e.bid,e.utype,e.refer,e.from);break;case 1002:i("#J_imframe").addClass("im-closed"),i("#J_imframe_proxy").addClass("im-proxy-closed");break;case 1003:i("#J_imframe").remove(),i("#J_imframe_proxy").remove(),h();break;case 1004:i("#J_imframe").removeClass("im-closed"),i("#J_imframe_proxy").removeClass("im-proxy-closed");break;case 1005:o.user_handsome_login_init(),o.user_handsome_login(!1,{callback:function(){location.reload()}});break;case 1006:var e=t.data;e.msg&&o.alert(e.msg);break;case 1007:var e=t.data;e&&e.msg?p(e.msg):h()}}catch(a){}}))},b=function(){var t=function(t){if(t){var e,o,n,r,d,l,m,u,f,p,h,g;if(e=i(t),o=e.attr("data-style"),m=e.attr("data-bid"),u=e.attr("data-uid"),f=e.attr("data-type"),client=e.attr("data-client"),p=e.attr("data-from"),h=e.html(),n=c[o],void 0!==n&&(r=n.width,d=n.height,g=""===a.userid?"x":"√",l=[s+"/mtalk/widget/enterbutton?","style=",o,"&width=",r,"&height=",d,"&cnt=",encodeURIComponent(h),"&islogin=",encodeURIComponent(g)],u?(l.push("&uid="),l.push(encodeURIComponent(u))):m&&(l.push("&bid="),l.push(encodeURIComponent(m))),f&&(l.push("&type="),l.push(encodeURIComponent(f))),u||m||f)){client&&"true"===client&&(l.push("&client="),l.push(encodeURIComponent(client))),l.push("&from="+(p||"")),l.push("&refer="+encodeURIComponent(location.href));var y=i('<iframe src="" width="'+r+'" height="'+d+'" frameborder="0" scrolling="no" marginheight="0" allowtransparency="true"></iframe>');e.html(y),y.attr("src",l.join(""))}}};i(".mogutalk_widget_btn").each(function(){t(this)}),i(e).on("createim:widget",function(e,i){t(i)})},w=function(){i(".mogutalk_btn").each(function(){var t,e,o,n,r,s=null,d=!1;if(t=i(this),s=m(t),null!==s){if(r=t.attr("data-islogin"),(a&&""!==a.userid||r&&"√"===r)&&(d=!0),o=t.attr("data-uid"),n=t.attr("data-bid"),e={},data_block={},o)e.userId=o,data_block.uid=o;else{if(!n)return;n.indexOf("#")<0&&(n+="#23"),e.shopId=n.split("#")[0],e.type=n.split("#")[1],data_block.bid=n.split("#")[0]}i.ajax({url:"/mtalk/im/customeronline",data:e,dataType:"json",success:function(e){if(e&&1001===e.status.code){var i=1===e.result.isOnline?!0:!1;i||(t.addClass("mogutalk_btn_offline"),"default"!==s&&t.addClass(s+"_offline"))}}}),d&&i.ajax({url:"/mtalk/user/isblock",data:data_block,dataType:"json",success:function(e){void 0!==e&&1001===e.status.code&&e.result&&e.result.isBlock===!0&&t.addClass("isblock")}})}})},v=function(){i(e).on("click",".mogutalk_btn",function(t){t.preventDefault();var e,n,d,c,m,u,f,p;if(e=i(this),n=!1,u=e.attr("data-islogin"),(a&&""!==a.userid||u&&"√"===u)&&(n=!0),!n){if(a)return o.user_handsome_login_init(),void o.user_handsome_login(!1,{callback:function(){location.reload()}});if(u)return void(l?l.send(r.stringify({code:1005})):top.location.href=s+"/login?refer="+e.attr("data-refer"))}if(d=e.attr("data-uid"),c=e.attr("data-bid"),m=e.attr("data-type"),p=e.attr("data-refer"),f=e.attr("data-from"),client=e.attr("data-client"),e.hasClass("isblock")){var h="您不能和对方对话～";return void(a?o.alert(h):l&&l.send(r.stringify({code:1006,data:{msg:h}})))}y(d,c,m,p,f,client)}),i(e).on("click",".duoduo_chat",function(t){t.preventDefault();var e=i(this).attr("data-uid");i.ajax({url:"/mtalk/im/calltotalk",data:{uid:e},type:"POST",dataType:"json",success:function(t){o.alert(t&&t.status?1001===t.status.code?"已联系用户，请切换到多多查看！":1002010===t.status.code?"请先登录多多！":t.status.msg:"网络错误，请稍后再试")}})})},x=function(){var t={startX:148,startY:401,mouseStartX:0,mouseStartY:0,originWidth:476,originHeight:28,width:569,height:418,offsetX:-28,offsetY:-365},o=i("#J_imframe"),a=0,n=function(){var e=i(".im-frame-proxy");e.length<=0||(e.animate({right:t.startX+t.offsetX+"px",bottom:t.startY+t.offsetY+"px"},100,function(){e.css({width:t.originWidth+"px",height:t.originHeight+"px",right:t.startX+"px",bottom:t.startY+"px"}).removeClass("ST_im-frame-proxy-move")}),o.length<=0&&(o=i("#J_imframe")),o.animate({opacity:1},100))},r=function(){clearTimeout(a),a=setTimeout(function(){n()},500)};i(e).on("mousedown",".im-frame-proxy",function(e){e.preventDefault();var a=i(this);t.startX=parseInt(a.css("right"),10),t.startY=parseInt(a.css("bottom"),10),t.mouseStartX=e.clientX,t.mouseStartY=e.clientY,a.css({width:t.width+"px",height:t.height+"px",right:t.startX+t.offsetX+"px",bottom:t.startY+t.offsetY+"px"}).addClass("ST_im-frame-proxy-move"),o.length<=0&&(o=i("#J_imframe")),o.animate({opacity:.9},100),r()}).on("mousemove",".ST_im-frame-proxy-move",function(e){e.preventDefault();var o=i(this);o.css({right:t.startX+(t.mouseStartX-e.clientX)+t.offsetX+"px",bottom:t.startY+(t.mouseStartY-e.clientY)+t.offsetY+"px"}),r()}).on("mouseup",".im-frame-proxy",function(e){e.preventDefault();var n=i(this);t.startX=t.startX+(t.mouseStartX-e.clientX),t.startY=t.startY+(t.mouseStartY-e.clientY),n.css({width:t.originWidth+"px",height:t.originHeight+"px",right:t.startX+"px",bottom:t.startY+"px"}).removeClass("ST_im-frame-proxy-move"),o.length<=0&&(o=i("#J_imframe")),o.css({right:t.startX+t.offsetX+"px",bottom:t.startY+t.offsetY+"px"}),o.animate({opacity:1},100),clearTimeout(a)})};return{init:function(){_(),b(),w(),v(),d||x()}}}(window,document,jQuery,window.MOGU,window.MOGUPROFILE,window.MGTOOL,window.JSON),$(document).ready(function(){MOGU.IM_Module.init()});var swfobject=function(){function e(){if(!G){try{var e=M.getElementsByTagName("body")[0].appendChild(h("span"));e.parentNode.removeChild(e)}catch(t){return}G=!0;for(var n=R.length,a=0;n>a;a++)R[a]()}}function t(e){G?e():R[R.length]=e}function n(e){if(typeof x.addEventListener!=L)x.addEventListener("load",e,!1);else if(typeof M.addEventListener!=L)M.addEventListener("load",e,!1);else if(typeof x.attachEvent!=L)m(x,"onload",e);else if("function"==typeof x.onload){var t=x.onload;x.onload=function(){t(),e()}}else x.onload=e}function a(){P?i():r()}function i(){var e=M.getElementsByTagName("body")[0],t=h(k);t.setAttribute("type",O);var n=e.appendChild(t);if(n){var a=0;!function(){if(typeof n.GetVariable!=L){var i=n.GetVariable("$version");i&&(i=i.split(" ")[1].split(","),X.pv=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)])}else if(10>a)return a++,setTimeout(arguments.callee,10),void 0;e.removeChild(t),n=null,r()}()}else r()}function r(){var e=D.length;if(e>0)for(var t=0;e>t;t++){var n=D[t].id,a=D[t].callbackFn,i={success:!1,id:n};if(X.pv[0]>0){var r=y(n);if(r)if(!g(D[t].swfVersion)||X.wk&&X.wk<312)if(D[t].expressInstall&&s()){var f={};f.data=D[t].expressInstall,f.width=r.getAttribute("width")||"0",f.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(f.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(f.align=r.getAttribute("align"));for(var d={},u=r.getElementsByTagName("param"),p=u.length,v=0;p>v;v++)"movie"!=u[v].getAttribute("name").toLowerCase()&&(d[u[v].getAttribute("name")]=u[v].getAttribute("value"));l(f,d,n,a)}else c(r),a&&a(i);else b(n,!0),a&&(i.success=!0,i.ref=o(n),a(i))}else if(b(n,!0),a){var h=o(n);h&&typeof h.SetVariable!=L&&(i.success=!0,i.ref=h),a(i)}}}function o(e){var t=null,n=y(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=L)t=n;else{var a=n.getElementsByTagName(k)[0];a&&(t=a)}return t}function s(){return!J&&g("6.0.65")&&(X.win||X.mac)&&!(X.wk&&X.wk<312)}function l(e,t,n,a){J=!0,A=a||null,N={success:!1,id:n};var i=y(n);if(i){"OBJECT"==i.nodeName?(E=f(i),S=null):(E=i,S=n),e.id=F,(typeof e.width==L||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==L||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),M.title=M.title.slice(0,47)+" - Flash Player Installation";var r=X.ie&&X.win?"ActiveX":"PlugIn",o="MMredirectURL="+x.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+M.title;if(typeof t.flashvars!=L?t.flashvars+="&"+o:t.flashvars=o,X.ie&&X.win&&4!=i.readyState){var s=h("div");n+="SWFObjectNew",s.setAttribute("id",n),i.parentNode.insertBefore(s,i),i.style.display="none",function(){4==i.readyState?i.parentNode.removeChild(i):setTimeout(arguments.callee,10)}()}d(e,t,n)}}function c(e){if(X.ie&&X.win&&4!=e.readyState){var t=h("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(f(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(f(e),e)}function f(e){var t=h("div");if(X.win&&X.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(k)[0];if(n){var a=n.childNodes;if(a)for(var i=a.length,r=0;i>r;r++)1==a[r].nodeType&&"PARAM"==a[r].nodeName||8==a[r].nodeType||t.appendChild(a[r].cloneNode(!0))}}return t}function d(e,t,n){var a,i=y(n);if(X.wk&&X.wk<312)return a;if(i)if(typeof e.id==L&&(e.id=n),X.ie&&X.win){var r="";for(var o in e)e[o]!=Object.prototype[o]&&("data"==o.toLowerCase()?t.movie=e[o]:"styleclass"==o.toLowerCase()?r+=' class="'+e[o]+'"':"classid"!=o.toLowerCase()&&(r+=" "+o+'="'+e[o]+'"'));var s="";for(var l in t)t[l]!=Object.prototype[l]&&(s+='<param name="'+l+'" value="'+t[l]+'" />');i.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+s+"</object>",W[W.length]=e.id,a=y(e.id)}else{var c=h(k);c.setAttribute("type",O);for(var f in e)e[f]!=Object.prototype[f]&&("styleclass"==f.toLowerCase()?c.setAttribute("class",e[f]):"classid"!=f.toLowerCase()&&c.setAttribute(f,e[f]));for(var d in t)t[d]!=Object.prototype[d]&&"movie"!=d.toLowerCase()&&u(c,d,t[d]);i.parentNode.replaceChild(c,i),a=c}return a}function u(e,t,n){var a=h("param");a.setAttribute("name",t),a.setAttribute("value",n),e.appendChild(a)}function p(e){var t=y(e);t&&"OBJECT"==t.nodeName&&(X.ie&&X.win?(t.style.display="none",function(){4==t.readyState?v(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function v(e){var t=y(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function y(e){var t=null;try{t=M.getElementById(e)}catch(n){}return t}function h(e){return M.createElement(e)}function m(e,t,n){e.attachEvent(t,n),H[H.length]=[e,t,n]}function g(e){var t=X.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function w(e,t,n,a){if(!X.ie||!X.mac){var i=M.getElementsByTagName("head")[0];if(i){var r=n&&"string"==typeof n?n:"screen";if(a&&(T=null,I=null),!T||I!=r){var o=h("style");o.setAttribute("type","text/css"),o.setAttribute("media",r),T=i.appendChild(o),X.ie&&X.win&&typeof M.styleSheets!=L&&M.styleSheets.length>0&&(T=M.styleSheets[M.styleSheets.length-1]),I=r}X.ie&&X.win?T&&typeof T.addRule==k&&T.addRule(e,t):T&&typeof M.createTextNode!=L&&T.appendChild(M.createTextNode(e+" {"+t+"}"))}}}function b(e,t){if(U){var n=t?"visible":"hidden";G&&y(e)?y(e).style.visibility=n:w("#"+e,"visibility:"+n)}}function C(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=L?encodeURIComponent(e):e}var E,S,A,N,T,I,L="undefined",k="object",j="Shockwave Flash",B="ShockwaveFlash.ShockwaveFlash",O="application/x-shockwave-flash",F="SWFObjectExprInst",$="onreadystatechange",x=window,M=document,V=navigator,P=!1,R=[a],D=[],W=[],H=[],G=!1,J=!1,U=!0,X=function(){var e=typeof M.getElementById!=L&&typeof M.getElementsByTagName!=L&&typeof M.createElement!=L,t=V.userAgent.toLowerCase(),n=V.platform.toLowerCase(),a=n?/win/.test(n):/win/.test(t),i=n?/mac/.test(n):/mac/.test(t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o=!1,s=[0,0,0],l=null;if(typeof V.plugins!=L&&typeof V.plugins[j]==k)l=V.plugins[j].description,!l||typeof V.mimeTypes!=L&&V.mimeTypes[O]&&!V.mimeTypes[O].enabledPlugin||(P=!0,o=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof x.ActiveXObject!=L)try{var c=new ActiveXObject(B);c&&(l=c.GetVariable("$version"),l&&(o=!0,l=l.split(" ")[1].split(","),s=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(f){}return{w3:e,pv:s,wk:r,ie:o,win:a,mac:i}}();return function(){X.w3&&((typeof M.readyState!=L&&"complete"==M.readyState||typeof M.readyState==L&&(M.getElementsByTagName("body")[0]||M.body))&&e(),G||(typeof M.addEventListener!=L&&M.addEventListener("DOMContentLoaded",e,!1),X.ie&&X.win&&(M.attachEvent($,function(){"complete"==M.readyState&&(M.detachEvent($,arguments.callee),e())}),x==top&&function(){if(!G){try{M.documentElement.doScroll("left")}catch(t){return setTimeout(arguments.callee,0),void 0}e()}}()),X.wk&&function(){return G?void 0:/loaded|complete/.test(M.readyState)?(e(),void 0):(setTimeout(arguments.callee,0),void 0)}(),n(e)))}(),function(){X.ie&&X.win&&window.attachEvent("onunload",function(){for(var e=H.length,t=0;e>t;t++)H[t][0].detachEvent(H[t][1],H[t][2]);for(var n=W.length,a=0;n>a;a++)p(W[a]);for(var i in X)X[i]=null;X=null;for(var r in swfobject)swfobject[r]=null;swfobject=null})}(),{registerObject:function(e,t,n,a){if(X.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=a,D[D.length]=i,b(e,!1)}else a&&a({success:!1,id:e})},getObjectById:function(e){return X.w3?o(e):void 0},embedSWF:function(e,n,a,i,r,o,c,f,u,p){var v={success:!1,id:n};X.w3&&!(X.wk&&X.wk<312)&&e&&n&&a&&i&&r?(b(n,!1),t(function(){a+="",i+="";var t={};if(u&&typeof u===k)for(var y in u)t[y]=u[y];t.data=e,t.width=a,t.height=i;var h={};if(f&&typeof f===k)for(var m in f)h[m]=f[m];if(c&&typeof c===k)for(var w in c)typeof h.flashvars!=L?h.flashvars+="&"+w+"="+c[w]:h.flashvars=w+"="+c[w];if(g(r)){var C=d(t,h,n);t.id==n&&b(n,!0),v.success=!0,v.ref=C}else{if(o&&s())return t.data=o,l(t,h,n,p),void 0;b(n,!0)}p&&p(v)})):p&&p(v)},switchOffAutoHideShow:function(){U=!1},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:g,createSWF:function(e,t,n){return X.w3?d(e,t,n):void 0},showExpressInstall:function(e,t,n,a){X.w3&&s()&&l(e,t,n,a)},removeSWF:function(e){X.w3&&p(e)},createCSS:function(e,t,n,a){X.w3&&w(e,t,n,a)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=M.location.search||M.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return C(t);for(var n=t.split("&"),a=0;a<n.length;a++)if(n[a].substring(0,n[a].indexOf("="))==e)return C(n[a].substring(n[a].indexOf("=")+1))}return""},expressInstallCallback:function(){if(J){var e=y(F);e&&E&&(e.parentNode.replaceChild(E,e),S&&(b(S,!0),X.ie&&X.win&&(E.style.display="block")),A&&A(N)),J=!1}}}}();var imio=function(t,o,e,n,i){function a(t){this.e_pre="imio:",this.data={connectionStatus:!1,connectionType:null,service:""},this.config=e.extend({connectMethod:["serviceHost","ajaxServiceHost","ajaxServiceBakHost"],socketSwf:MOGUPROFILE.cdnHost+"/dist/swf/push.v1.swf",serviceHost:"122.225.67.108:101.68.210.108:8808",ajaxServiceHost:"http://122.225.67.108:80",ajaxServiceBakHost:"http://101.68.210.108:80",timestamp:+new Date},t)}var c=function(t){if("object"!=typeof t)return null;var o,e=parseInt(100*Math.random(),10)+100,n="",i=0;for(var a in t)n+=t[a];o=n.split("");for(var c=0,s=o.length;s>c;c++)i+=o[c].charCodeAt();return t._n=e,t._p=i%e,t};return a.prototype.emit=function(t){this.uinfo=e.extend({uid:"",uuid:"",token:""},t),this.uinfo.uid&&this.connectSvr()},a.prototype.on=function(t,n){e(o).on(this.e_pre+t,function(t,o){n&&n(o)})},a.prototype.trigger=function(t,n){e(o).trigger(this.e_pre+t,[n])},a.prototype.connectSvr=function(){var t=this,o=t.config.connectMethod,e={serviceHost:"flash",ajaxServiceHost:"ajax",ajaxServiceBakHost:"ajax"},i=n.getFlashPlayerVersion();if(void 0===i||0===i.major)for(var a=0,c=o.length;c>a;a++)if("serviceHost"===o[a]){o.splice(a,1);break}var s=0;!function r(n){var i=t.data.connectionStatus;if(!i&&n)t.data.service=t.config[n],t.data.connectionType=e[n],t.start(e[n]);else if(!i&&void 0===n)return t.trigger("loading:status","timeout"),void clearTimeout(s);s=setTimeout(function(){var e=o.shift();t.data.connectionStatus||(r(e),e&&t.trigger("loading:status","reconnect"))},1e4)}(o.shift())},a.prototype.httpConnect=function(){e("#imioflashobj").remove();var t=this,o={uid:t.uinfo.uid,token:t.uinfo.token,status:1};o=c(o),e.ajax({url:t.data.service+"/push/login",data:o,dataType:"jsonp",timeout:9e3,success:function(o){if(o&&1001===o.status.code){if(t.data.connectionStatus)return;t.uinfo.uuid=o.result.uuid,t.call(encodeURIComponent('{"code":1001,"type":"_imioLoginCB"}')),t.startPoll(),t.autoToken(),t.send("getUnReadCounter")}}})},a.prototype.flashConnect=function(){var t=this,o=e("#imioflashobj");o.length<=0&&(o=e('<span id="imioflashobj"></span>'),e("body").append(o));var i=t.config,a=e.extend({serverList:i.serviceHost},t.uinfo),c={wmode:"transplate",allowscriptaccess:"always"},s={id:"imioflashobj",name:"imioflashobj"};window._imioSocket={call:function(o){t.connectionStatus||t.autoToken(),t.call(o)}},n.embedSWF(t.config.socketSwf+"?_="+t.config.timestamp,"imioflashobj","0","0","9.0.0","",a,c,s)},a.prototype.start=function(t){"flash"===t?this.flashConnect():"ajax"===t&&this.httpConnect()},a.prototype.startPoll=function(){var t=this,o=(t.config,t.uinfo);!function n(){e.ajax({url:t.data.service+"/push/poll",data:{uid:o.uid,uuid:o.uuid,token:o.token,type:"poll"},type:"GET",dataType:"jsonp",timeout:5e4,success:function(o){return null===o||(t.call(encodeURIComponent(i.stringify(o))),"errorCode"!==o.type||4011!==o.data&&4002!==o.data&&4005!==o.data&&4444!==o.data)?void n():void t.showNotice(o.data)},error:function(){t.showNotice(6002)}})}()},a.prototype.autoToken=function(){var t=this;t.startAutoToken||(!function o(){setTimeout(function(){e.ajax({url:"http://www.mogujie.com/mtalk/iauth",type:"GET",data:null,dataType:"jsonp",success:function(e){e&&e.status&&1001===e.status.code&&(t.uinfo.token=e.result.token,o())}})},36e5)}(),t.startAutoToken=!0)},a.prototype.showNotice=function(t){t+="";var o={4004:"消息发送超时",6000:"网络连接出错",6001:"您不能和对方对话",10001:"抱歉！没有客服在线",4002:"参数错误，请重新登录",4003:"您已断开连接，请重新登录",4005:"用户校验失败，请重新登陆",4011:"您已在其他地方上线，请重新打开",4444:"您已经离线，请重新打开",6002:"连接失败，请重新打开"};this.trigger("notice:show",{code:+t,msg:void 0===o[t]?"未知错误["+t+"]":o[t]})},a.prototype.call=function(t){t=i.parse(decodeURIComponent(t));var o=this;if(t&&1001===t.code)switch(t.type){case"_imioLoginCB":o.data.connectionStatus=!0;break;case"_imioSocket":o.trigger("data:update",t.data)}},a.prototype.send=function(t,o){o=encodeURIComponent(i.stringify(o));var n=this;if("flash"===n.data.connectionType){var a=e("#imioflashobj")[0];if(!a)return;return void function c(t,o){n.data.connectionStatus?a[t](o):"flash"===n.data.connectionType&&setTimeout(function(){c(t,o)},100)}(t,o)}return"ajax"===n.data.connectionType?void function(t,o){var a={uid:n.uinfo.uid,uuid:n.uinfo.uuid,token:n.uinfo.token,type:t};void 0!==o&&(a.data=decodeURIComponent(o)),e.ajax({url:n.data.service+"/push/request",data:a,type:"GET",dataType:"jsonp",success:function(t){t&&t.data?n.call(encodeURIComponent(i.stringify(t))):t&&4003===t.code&&n.showNotice(4003)},error:function(){n.showNotice(6002)}})}(t,o):void 0},{connect:function(t){return new a(t)}}}(window,document,jQuery,swfobject,JSON);!function(e,i,t,o){var n="undefined"!=typeof e.MOGU?e.MOGU:{},d="undefined"!=typeof e.MOGUPROFILE?e.MOGUPROFILE:{},u="undefined"!=typeof e.MGTOOL?e.MGTOOL:{};if(void 0!=d&&void 0!=d.userid&&""!=d.userid){var a=t("head").find("link"),s=a.eq(a.length-1).attr("href"),r=+new Date;"string"==typeof s&&s.indexOf("$")>0&&(!window.ActiveXObject||window.XMLHttpRequest)&&(r=s.split("$")[1].split(".")[0]),function(){var e,i=d.userid,a=d.push_token,s=d.push_serviceHost,f=d.push_ajaxServiceHost,c=d.push_ajaxServiceBakHost;e=o.connect({serviceHost:s,ajaxServiceHost:f,ajaxServiceBakHost:c,timestamp:r}),e.on("data:update",function(e){n.cinfo=e,t("body").trigger("cinfodatarecieve",[e])}),e.emit({uid:i,token:a,uuid:u.getCookie("__mgjuuid"),mgj:u.getCookie("__ud_"),fromsite:u.getCookie("from_site")})}()}}(window,document,jQuery,window.imio);(function(a){MOGU.imgCodeCheck=function(){var t=false;var i=a(".img_code_spin");if(i.length==0){t=true;return t}for(var c=0;c<i.length;c++){var e=a(i[c]);if(e.val()!=0){t=true;break}}return t};MOGU.imgCaptchaInit=function(){var t=a(".imgcheck_image_div");var i=a("#imgcheck_code_change");var c=function(a,t){var i=-75*((t+1)%4);var c=a[0].style.backgroundPosition.split(" ");a[0].style.backgroundPosition=c[0]+" "+i+"px"};t.click(function(){var t=a(this).attr("f");var i=a("#img_code_spin_"+t);var e=parseInt(i.val());c(a(this),e);i.val(e+1)});i.click(function(){MOGU.imgCaptchaRecaptcha()})};MOGU.imgCaptchaRecaptcha=function(t){var i=function(t){var i=a(".imgcheck_image_div");var c=i.length;for(var e=0;e<c;e++){var r=i[e];var n=r.getAttribute("f");var o=a("#img_code_spin_"+n);o.val(0);var u=a(r);u.css("background-image","url(/captchaimg/"+t+")");u.css({"background-position":-75*e+"px 0"})}};if(t===undefined){a.ajax({url:"/reimgcaptcha",type:"POST",timeout:6e4,data:{},dataType:"json",cache:false,success:function(a){var t=a.status.code;var c=a.status.msg;if(t==1001){var e=a.result.data.captchaId;i(e)}},error:function(a,t,i){if("timeout"==t){alert(MGLANG.msgTimeout)}}})}else{setTimeout(function(){i(t)},1)}};MOGU.imgCaptchaInit()})(jQuery);var MOGU=MOGU||{};!function(a,b){var c={};c.Util={mask:function(){var b=a(".light_box_fullbg");b.length<=0&&(b=a(['<div class="light_box_fullbg"></div>'].join("")),a("body").append(b))},show:function(b,c){var d,e,f,g=a("#vp_wrap"),h=a(".light_box_fullbg").eq(0);g.length<=0&&(g=a(['<div class="vp_wrap" id="vp_wrap">','<h5 class="vp_t"></h5>','<a href="javascript:;" class="vp_cls">×</a>','<div class="v_pop_box"></div>',"</div>"].join("")),a("body").append(g),h.off("click").on("click",function(){clearTimeout(f),g.addClass("vp_shake"),f=setTimeout(function(){g.removeClass("vp_shake")},500)})),g.find(".vp_t").html(c.title),e={alert:function(){return d=a(".vp_alert"),d.length<=0&&(d=a(['<div class="vp_alert vp_inner">','<p class="vp_cnt"></p>','<a href="javascript:;" class="vp_btn vp_ok">确定</a>',"</div>"].join(""))),d.show().find(".vp_cnt").html(c.content),d},confirm:function(){return d=a(".vp_cfm"),d.length<=0&&(d=a(['<div class="vp_cfm vp_inner">','<p class="vp_cnt"></p>','<a href="javascript:;" class="vp_btn vp_ok">确定</a>','<a href="javascript:;" class="vp_btn vp_cancel">取消</a>',"</div>"].join(""))),d.show().find(".vp_cnt").html(c.content),d}},g.find(".v_pop_box").append(e[b]()),g.css({display:"block",opacity:0}).css({"margin-left":-g.width()/2-1,"margin-top":-g.height()/2-1,opacity:1}),h.show()},close:function(b,c){a(".light_box_fullbg").eq(0).hide(),a("#vp_wrap").find(".vp_inner").hide().end().hide(),void 0!==c&&"function"==typeof c&&c(b)},debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}},b.alert=a.alert=function(b,d,e){var f=a.extend({title:"提示",content:b},e),g=function(){a("#vp_wrap").off("click").on("click",".vp_ok, .vp_cls",function(){c.Util.close(void 0,d)})};!function(){c.Util.mask(),c.Util.show("alert",f),g()}()},b.confirm=a.confirm=function(b,d,e){var f=a.extend({title:"提示",content:b},e),g=function(){a("#vp_wrap").off("click").on("click",".vp_cls, .vp_cancel",function(a){a.preventDefault(),c.Util.close(!1,d)}).on("click",".vp_ok",function(a){a.preventDefault(),c.Util.close(!0,d)})};return"object"==typeof arguments[1]&&arguments[1].length>0?(c.Confirm.apply(this,arguments),void 0):(function(){c.Util.mask(),c.Util.show("confirm",f),g()}(),void 0)},c.Confirm=function(b,c,d){var e=c,f=function(){var c=a("#vp_tip");return c.length<=0&&(c=a(['<div class="vp_tip" id="vp_tip">','<p class="vp_tip_cnt"></p>','<a href="javascript:;" class="vp_min_btn vp_min_ok">确定</a>','<a href="javascript:;" class="vp_min_btn vp_min_cancel">取消</a>',"</div>"].join(""))),c.find(".vp_tip_cnt").html(b),c.removeClass("vp_tip_min").removeClass("vp_tip_max").css("opacity",0).show(),c},g=function(){a("#vp_tip").off("click").on("click",".vp_min_ok",function(a){a.preventDefault(),h(!0,d)}).on("click",".vp_min_cancel",function(a){a.preventDefault(),h(!1,d)})},h=function(b,c){a("#vp_tip").hide(),void 0!==c&&"function"==typeof c&&c(b)},i=function(){var b=a("#vp_tip"),c=e.offset(),d=b.width();120>d&&b.addClass("vp_tip_min"),d>240&&b.addClass("vp_tip_max"),b.css({top:c.top-b.outerHeight(),left:c.left+(e.outerWidth()-b.outerWidth())/2,opacity:1})};!function(){a("body").append(f()),i(),g()}()}}(jQuery,MOGU);define("md/log/core",[],function(){var e={REPORT_URL:"//book.log.juangua.com/mogu.js",moduleNames:[],imgs:{},entrySent:!1,leaveSent:!1,init:function(){this.initTime=this.helper.getNewTime(),this.uuid=this.helper.getCookie("__mgjuuid")+this.initTime;for(var e in this.modules)this.registModule(e,this.modules[e]);this.addEvent()},addEvent:function(){var e=this;window.onbeforeunload=function(){var n=parseInt((e.helper.getNewTime()-e.initTime)/1e3)+"s";e.leaveSend([],{staytime:n},!1)}},modules:{},extend:function(e,n){var t=this.modules[e];t?$.extend(t,n):this.modules[e]=n,this.registModule(e,n)},registModule:function(e,n){"function"==typeof n.init&&n.init(),-1==$.inArray(e,this.moduleNames)&&(this.moduleNames.push(e),this[e]=n)},helper:{parseTime:function(e){return new Date(parseInt(e)).toLocaleString()},getNewTime:function(){return(new Date).getTime()},getCookie:function(e){var n,t=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return n=document.cookie.match(t),n?unescape(n[2]):null},filter:function(e){return"string"!=typeof e?e:e.replace(/\?|&/gi,"")}},exports:function(e,n){$.isPlainObject(e)?(n=e,e=this.moduleNames):e&&e.length||(e=this.moduleNames);var t,o,i,r=[],a=this;if($.each(e,function(e,n){if(t=a.modules[n],!t||"function"!=typeof t.exports)return!0;var d;try{if(i=t.exports(),!$.isPlainObject(i))return!0;o=$.map(i,function(e,n){return d=n.indexOf("extra_param")>-1?":":"=",[a.helper.filter(n),d,a.helper.filter(e)].join("")}),r.push(o.join("&"))}catch(u){}}),$.isPlainObject(n)&&!$.isEmptyObject(n)){var d=$.map(n,function(e,n){var t=n.indexOf("extra_param")>-1?":":"=";return[a.helper.filter(n),t,a.helper.filter(e)].join("")});d.length&&r.push(d.join("&"))}return r.join("&")},sendLog:function(e,n){var t=this;if(e){var o=$.ajax({url:t.REPORT_URL,method:"get",data:n,async:!1,timeout:1e3});o.error(function(){o&&o.abort()})}else{var i=new Image,r="_img_"+Math.random();t.imgs[r]=i,i.onload=i.onerror=function(){t.imgs[r]=null},i.src=[t.REPORT_URL,"?",n].join("")}},defaultSend:function(e,n,t){n=n||{};var o=this.exports(e,n);this.sendLog(t,o)},entrySend:function(e,n,t){var o=this;if(!this.entrySent){this.entrySent=!0,n=n||{},$.extend(n,{uuid:o.uuid,action:"entry"});var i=this.exports(e,n);this.sendLog(t,i)}},leaveSend:function(e,n,t){var o=this;if(!this.leaveSent){this.leaveSent=!0,n=n||{},$.extend(n,{uuid:o.uuid,action:"leave"});var i=this.exports(e,n);this.sendLog(t,i)}}};return e.init(),window.MoGu=window.MoGu||{},window.MoGu.App=window.MoGu.App||{},window.MoGu.App.Log=e,e}),define("md/log/netspeed",["md/log/core"],function(e){if(0!==location.protocol.indexOf("https")){var n={complete:!1,cdnUrl:".mogucdn.com/pic/140729/im_ieydszdgmezgkobvmiytambqgyyde_22x22.png",testCdn:["s6","s7","s17","s18"],timeArr:[],init:function(){this.addEvent()},addEvent:function(){var n=this;$(function(){var t=e.helper.getNewTime();$.each(n.testCdn,function(o,i){!function(o,i){var r=new Image;r.onload=function(){var i=e.helper.getNewTime();n.timeArr[o]=i-t;for(var r=0,a=0,d=n.timeArr.length;d>a;a++)void 0!==n.timeArr[a]&&r++;r>=n.testCdn.length&&(n.complete=!0)},r.src="http://"+i+n.cdnUrl+"?_="+ +new Date}(o,i)})})},exports:function(){var e=[],n=this;return $.each(n.testCdn,function(t,o){e.push(o+":"+(n.timeArr[t]||0))}),{netspeed:e.join(",")}}};return e.extend("NetSpeed",n),n}}),define("md/log/performance",["md/log/core"],function(e){if(!window.performance)return{complete:!0};var n={complete:!1,timing:window.performance.timing,blankTime:0,readyTime:0,onloadTime:0,init:function(){var e=this;e.setData()},setData:function(){var e=this,n=e.timing.domainLookupStart;e.blankTime=(window.__trace__headendt||0)-n,e.readyTime=e.timing.domInteractive-n,e.onloadTime=e.timing.domComplete-n,e.onloadTime>=0?e.complete=!0:setTimeout(function(){e.setData()},1e3)},exports:function(){var e=this;return{pfm:["b:"+e.blankTime,"r:"+e.readyTime,"o:"+e.onloadTime].join(",")}}};return n.init(),e.extend("Performance",n),n}),define("md/log/hoter",["md/log/core"],function(e){var n=$(window),t={url:location.href,getPageUrl:function(){return encodeURIComponent(this.url)},getMousePoint:function(e){var n={x:0,y:0};return"undefined"!=typeof window.pageYOffset?(n.x=window.pageXOffset,n.y=window.pageYOffset):"undefined"!=typeof document.compatMode&&"BackCompat"!=document.compatMode?(n.x=document.documentElement.scrollLeft,n.y=document.documentElement.scrollTop):"undefined"!=typeof document.body&&(n.x=document.body.scrollLeft,n.y=document.body.scrollTop),n.x+=e.clientX,n.y+=e.clientY,n},encodeEv:function(e){var t=this.getMousePoint(e);return 0===t.x||0===t.y||isNaN(t.x)||isNaN(t.y)?"":["cx:"+t.x,"cy:"+t.y,"win:"+n.width()+"x"+n.height()].join(",")},exports:function(){var e=this;return{pageurl:e.getPageUrl()}}};return e.extend("Hoter",t),t}),define("md/log/browser",["md/log/core"],function(e){var n={url:location.href,screen:window.screen.width+"x"+window.screen.height,userAgent:window.navigator.userAgent,getPageUrl:function(){return encodeURIComponent(this.url)},getBrowser:function(){var e=["chrome","firefox","mozilla","webkit","safari","opera","msie","ie","webview"],n=["android","iphone","ipad","wp"],t="";return $.browser&&$.each(e,function(e,n){return $.browser[n]===!0?(t+=n,$.browser.version&&(t+=":"+$.browser.version),!1):void 0}),$.os&&$.each(n,function(e,n){return $.os[n]===!0?(t+=","+n,$.os.version&&(t+=":"+$.os.version),!1):void 0}),t},exports:function(){var e=this;return{pageurl:e.getPageUrl(),screen:e.screen,browser:e.getBrowser()}}};e.extend("ClientInfo",n)}),define("md/log/error",["md/log/core"],function(e){var n={errors:[],init:function(){this.addEvent()},addEvent:function(){var e=this;window.onerror=function(n,t,o){e.errors.push({msg:n,line:o})}},exports:function(){var e,n=[];return $.each(this.errors,function(t,o){e=[o.msg,"@line",o.line].join(""),n.push(e)}),{errors:n.join(",")}}};e.extend("PageError",n)}),require(["md/log/core","md/log/netspeed","md/log/performance","md/log/hoter","md/log/browser","md/log/error"],function(e,n,t,o){n&&t&&(!function i(){setTimeout(function(){n.complete===!0&&t.complete===!0?e.defaultSend(["ClientInfo","PageError","NetSpeed","Performance"],{_:+new Date},!1):i()},1e3)}(),$(document).on("click.hoter",function(n){var t=o.encodeEv(n);t&&e.defaultSend(["Hoter"],{cur:t,_:+new Date},!1)}))}),define("modules/base/log",function(){});!function(t,e){e.MOGU=e.MOGU||{};var n={init:function(){t(document).off(".mga").on("click.mga",'[data-mga="event"]',function(e){return function(n){var a,i,o,c,r;return a=t(n.currentTarget),o=a.data("category")||a[0].tagName,i=a.data("action")||n.type,c=a.data("label")||a[0].className,r=a.data("value")||a.html(),e.triggerEvent(o,i,c,r)}}(this))},triggerEvent:function(t,e,n,a){var i=this;clearTimeout(o);var o=setTimeout(function(){i.event(t,e,n,a)},500)},event:function(e,n,a){var i={action:n,page:e,pos:a};t.ajax({type:"POST",url:"http://www.mogujie.com/itemsactionlog",data:i,success:function(){}})},isInScope:function(n){return n.length>0&&t(e).scrollTop()<n.offset().top+n.outerHeight()&&t(e).scrollTop()+t(e).height()>n.offset().top?!0:!1},pageview:function(t,e,n){var a=this;clearTimeout(i);var i=setTimeout(function(){a.isInScope(n)&&a.event(t,"view",e,null)},500)}};n.init(),MOGU.mga=n,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("mga",[],function(){return n})}(jQuery,window);