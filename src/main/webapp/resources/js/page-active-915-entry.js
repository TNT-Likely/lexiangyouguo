require(["core/core"],function(){var t=MoGu.util.getStore(),e={lb:null,lbDom:null,init:function(t){this.lb&&this.lb.close();var t=$.extend({},this.defaultConfig,t);this.lb=new MGLightBox(t),this.lb.init(),this.lbDom=$("#"+t.lightBoxId)},defaultConfig:{title:"通知",lightBoxId:"lb_notice_id",contentHtml:"",scroll:!0,isBgClickClose:!1}},i={loca:"",options:{actLink:"http://www.mogujie.com/act/newuser?f=20140915newuser",leftCloseKey:"win_left_test",mainCloseKey:"win_main_915",backList:["top.mogujie.com","www.mogujie.com/zadmin","www.mogujie.com/tuling","www.mogujie.com/seller","open.mogujie","webapp","cps","mtalk","book/elegant"],mainWhiteList:[{href:"/",attr:".primary_main"}],leftWhiteList:[{href:"/",attr:".primary_main"}]},init:function(){var e=this;if(e.loca=e.filterOriPath(location.href),!(null===t||$(".light_box_fullbg").length>0||$(".float_left_protect").length>0)){var i=t.get(e.options.mainCloseKey),n=MoGu.util.getCookie("__cpsuid")||"";if("12ndxf4"!==n&&"12qeck4"!==n&&"12qggls"!==n&&!t.get("act_915_v")){var o=0;!e.registed()&&e._isNextDay(i)&&(e.mainAlert(),t.set("act_0915_v_count",1)),t.get("act_0915_v_count")>0&&t.get("act_0915_v_count")<8&&e._isNextDay(i)&&(e.mainAlert(),o=t.get("act_0915_v_count"),o++,t.set("act_0915_v_count",o))}}},isLogin:function(){return MOGUPROFILE&&MOGUPROFILE.userid?!0:!1},registed:function(){return MoGu&&MoGu.util&&""!==MoGu.util.getCookie("__ud_")?!0:!1},passBlackList:function(){var t=this,e=!0;return $.each(t.options.backList,function(i,n){return t.loca.indexOf(n)>=0?void(e=!1):void 0}),e},goWhiteList:function(t,e){var i=this;$.each(t,function(t,n){i.loca.indexOf(n.href)>=0&&$(n.attr).length>0&&"function"==typeof e&&e()})},mainAlert:function(){var i=this,n=this.options.actLink;this.lb&&this.lb.close(),e.init({contentHtml:['<div class="active_full_pre_main_wrap">','<a href="'+n+'" target="_blank" class="a5m_link">立即参加</a>','<span class="a5m_close">x</span>','<i class="a5m_bg"></i>',"</div>"].join("")}),e.lbDom.on("click",".a5m_close, .a5m_link",function(n){var o=$(n.currentTarget);e.lb.close(),t.set(i.options.mainCloseKey,(new Date).getTime()),o.hasClass("a5m_link")&&t.set("act_915_v",!0)})},leftAlert:function(){var e=this,i=e.options.actLink,n=$(".fm960:eq(0)");if(n.length||(n=$(".wrap:eq(0)")),n.length){var o=$(['<div class="active_full_pre_float_wrap float_left_protect">','<a href="'+i+'" target="_blank" class="a5f_link">立即参加</a>','<span class="a5f_close">x</span>','<i class="a5f_bg"></i>',"</div>"].join(""));$("body").append(o);var a=n.offset(),l=$(window).width(),s=o.outerWidth()+10,c=l-s<n.outerWidth()||a.left-s<=0?0:a.left-s;o.css("left",c).show(),o.on("click",".a5f_close",function(){o.remove(),t.set(e.options.leftCloseKey,(new Date).getTime())})}},filterOriPath:function(t){var e=/http:\/\/[^\/]+/;return t.replace(e,"")},_isNextDay:function(t){if(!t)return!0;var e=new Date,i=new Date(t),n=e.getFullYear(),o=e.getMonth(),a=e.getDay(),l=i.getFullYear(),s=i.getMonth(),t=i.getDay();return n!=l||o!=s||a>t?!0:!1}};i.init()});