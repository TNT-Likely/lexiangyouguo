define("pages/shopping/js/shopindex-common",[],function(){var e=function(){this.highClassName="on"};return e.prototype={add2Collection:function(e){$.browser.msie&&6==$.browser.version&&$.isPlainObject(e)&&e.wrap.length&&e.target&&this._registerEvent(e)},_registerEvent:function(e){var t=this;e.wrap.on("mouseenter",e.target,function(){$(this).addClass(t.highClassName).siblings().removeClass(t.highClassName)}),e.wrap.on("mouseleave",e.target,function(){$(this).removeClass(t.highClassName)})}},new e}),define("pages/shopping/js/shopindex-top",["pages/shopping/js/shopindex-common"],function(e){var t=$(".sp_topbanner");e.add2Collection({wrap:t.find(".nav_list"),target:"li"})}),define("pages/shopping/js/shopindex-filter",[],function(){var e={wrap:$(".price_custom"),init:function(){this.minPrice=this.wrap.find(".min_price"),this.maxPrice=this.wrap.find(".max_price"),this.subBtn=this.wrap.find(".p_sub"),this.addEvent()},addEvent:function(){var e=this;this.wrap.on("click",".p_sub",function(){return e.validate()&&e.wrap.trigger("submit"),!1}),this.wrap.on("keydown",function(t){13==t.keyCode&&e.validate()&&e.wrap.trigger("submit")})},validate:function(){var e=/\d+/,t=1*this.minPrice.val(),i=1*this.maxPrice.val();return e.test(t)?e.test(i)?t>i?(alert("最大价格不能小于最小价格"),!1):!0:(alert("最大价格续是一个数字"),!1):(alert("最小价格续是一个数字"),!1)}};e.init(),$(".yx_filter").on("click","li",function(){{var e=$(this);e.find(".ck_box")}location.href=e.data("url")})}),define("pages/shopping/js/shopindex-wall",[],function(){var e=MoGu.ui.getdoT();if(e){var t=function(e){var t={wrap:null,tpl:"",data:{},startPage:2,querySection:2,scrollDiff:1e3};e=$.extend({},t,e),this.container=e.wrap,this.feedTpl=e.tpl,this.isEnd=!1,this.loadError=!1,this.page=e.startPage||2,this.documentH=$(document).height(),this.winH=$(window).height(),this.scrollDiff=e.scrollDiff,this.loadingEl=$(".lr_loading"),this.isQuering=!1,this.screenNum=this.getScreenNum(),this.postData=e.data||{},this.init()};return t.prototype={init:function(){this.container.length&&""!=this.feedTpl&&this.addEvent()},addEvent:function(){var e=this;this.randStr=this.randomString(5),this.onScrollEveName="scroll.lw_"+this.randStr,$(window).on(this.onScrollEveName,function(){var t=$(this),i=t.scrollTop();e.documentH-(i+e.winH)<=e.scrollDiff&&e.loadFeeds()}).trigger(this.onScrollEveName),$(window).on("rezize",function(){e.screenNum=e.getScreenNum()})},randomString:function(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");e||(e=Math.floor(Math.random()*t.length));for(var i="",n=0;e>n;n++)i+=t[Math.floor(Math.random()*t.length)];return i},getFeeds:function(){var e=this,t={section:e.page,book:MOGUPROFILE.book||"",location:MOGUPROFILE.location||""};return $.ajax({url:"/book/ajax",type:"POST",dataType:"json",data:$.extend({},t,e.postData)})},getScreenNum:function(){return parseInt(this.container.width()/this.container.find(".iwf").eq(0).width())},loadFeeds:function(e){if(!(this.isQuering||this.loadError||this.isEnd)){e=e||1;var t=this;this.isQuering=!0,this.loadingEl.show(),this.getFeeds().then(function(i){if(1001!=i.status.code)return void t.stopLoading();i=i.result,t.page++,t.isEnd=i.isEnd||!1,e--,t.isQuering=!1,t.loadingEl.hide();var n=i.list.length,a=n%t.screenNum;a&&(i.list=i.list.slice(0,n-a)),t.renderFeeds(i.list),t.documentH=$(document).height(),t.isEnd&&(t.renderPager(i.pagination),$(window).off(t.onScrollEveName)),t._afterLoad({page:t.page,isEnd:t.isEnd,respone:i}),!t.isEnd&&e>0&&t.loadFeeds(e)},function(){t.stopLoading()})}},stopLoading:function(){this.isQuering=!1,this.loadError=!0,this.loadingEl.hide(),$(window).off(this.onScrollEveName)},renderFeeds:function(t){this.container.append(e.template(this.feedTpl)({feeds:t}))},renderPager:function(e){this.container.append(e)},addAfterLoadFeed:function(e){this.afterLoadList||(this.afterLoadList=[]),$.isFunction(e)&&this.afterLoadList.push(e)},_afterLoad:function(e){this.afterLoadList||(this.afterLoadList=[]),$.each(this.afterLoadList,function(t,i){i(e)})}},t}}),require(["pages/shopping/js/shopindex-top","pages/shopping/js/shopindex-filter","pages/shopping/js/shopindex-wall"],function(e,t,i){var n=new i({wrap:$("#imagewall_container"),tpl:["{{~it.feeds :feed:i}}",'<div class="iwf" data-tradeitemid="{{=feed.tradeItemId}}" data-tid="{{=feed.tid}}">','<a href="{{=feed.link}}" class="img" target="_blank"><img src="{{=feed.img}}_220x330.jpg" alt="{{=feed.title}}"></a>','<p class="title">','<a href="{{=feed.link}}" target="_blank">{{=feed.title}}</a>',"{{ if(feed.tags && feed.tags[1]){ }}",'<span class="iwf_icon icon_buyerrec">买手推荐</span>',"{{ }else if(feed.ctags){ }}",'{{ if(feed.ctags.text == "秋冬新款"){ }}','<span class="iwf_icon icon_qdxk">秋冬新款</span>',"{{ } }}","{{ } }}","</p>",'<div class="goods_info">','<b class="price_info"><i>￥</i>{{=feed.price}}</b>','<span class="fav_num">{{=feed.cfav}}</span>',"</div>","{{ if(feed.tags && feed.tags[0]){ }}",'<a class="icon_yx iwf_icon" target="_blank" href="{{=feed.link}}">{{=feed.tags[0].text}}</a>',"{{ } }}",'<span class="atags">{{=feed.atags}}</span>',"</div>","{{~}}"].join("")});n.addAfterLoadFeed(function(){var e=log_stat_url_tmp+"&refer="+encodeURIComponent("/book/ajax")+"&rerefer="+encodeURIComponent(window.location.href)+"&anchor="+window.log_stat_anchor;$.ajax({url:e,type:"post",dataType:"jsonp",jsonpCallback:"logCallBack"})}),n.addAfterLoadFeed(function(e){e.isEnd&&$.get("/trade/ad/cpm/loadShoppingCpmAd",{},function(e){e=e[0];var t=new Image;$(t).load(function(){$("#imagewall_container").after('<div class="footer_banner"><a href="'+e.url+'" target="_blank"><img data-mga="event" data-label="pos" data-value="shopping_bot" src="'+e.image+'" alt="'+e.title+'"></a></div>')}).attr("src",e.image)},"json")})});