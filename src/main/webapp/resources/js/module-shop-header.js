(function(a){a.fn.extend({MOGU_Follow:function(b){var c={a_addfo:"<a href='javascript:;' class='addfo'>\u52a0\u5173\u6ce8</a>",a_delfo:"<a href='javascript:;' class='delfo'>\u53d6\u6d88\u5173\u6ce8</a>",span_fook:"<span class='fo_ok'>OK</span>",span_followed:"<span class='followed'>\u5df2\u5173\u6ce8</span>",add_all:"<span class='addall'>\u4e92\u76f8\u5173\u6ce8</span><a class='unfollow' href='javascript:void(0);' >\u53d6\u6d88</a>",add_ok:'<span class="add_ok">\u5df2\u5173\u6ce8</span><a href="javascript:void(0);" class="unfollow">\u53d6\u6d88</a>',
add_e:"<a class='add_e' href='javascript:;'>\u5173\u6ce8</a>",add_a:"<span class='addall' href='javascript:;'>\u4e92\u76f8\u5173\u6ce8</span>"},f=a.extend({wrap_div_class:"followdiv",add_fos:"one",addfo_class:"addfo"},b),b=a("."+f.wrap_div_class),d={};a(".addfo,.add_e",b).live("click",function(){if(MOGUPROFILE.userid==""){MOGU.user_handsome_login_init();var c=a(this);MOGU.user_handsome_login(!1,{callback:function(){c.click()}})}else{if("one"===f.add_fos)var b=a(this).parent().attr("uid"),b=Array(b);
d={followIds:b};g("/collect/addfollow",d,a(this),"add_follow")}});a(".unfollow",b).live("click",function(){if(!confirm("\u786e\u5b9a\u8981\u53d6\u6d88\u5173\u6ce8\u4e48\uff1f"))return!1;d={followIds:a(this).parent().attr("uid")};g("/collect/unfollow",d,a(this),"del_fo")});a(".addfo_all").click(function(){var c=[],b=[];a(".si_friends .sif_f").each(function(){a(this).find(".s_in").attr("checked")=="checked"&&(c.push(a(this).find(".foit").attr("uid")),b.push(a(this).find(".foit").attr("sname")),a(this).parent().remove(),
a(this).fadeOut(500,function(){}))});if(c.length==0)return alert("\u8bf7\u9009\u62e9\u7528\u6237!"),!1;a(".si_friends li").size()==0&&a(".sina_invite, .si_down").fadeOut();d={followIds:c,zone_sina_fo:"zone_sina_fo",sina_name_array:b};g("/collect/addfollow",d,a(this),"add_follow")});var g=function(b,d,e,g){a.ajax({url:b,type:"POST",timeout:6E4,data:d,dataType:"json",success:function(a){if(a==null)alert(MGLANG.msgTimeout);else{var b=a.status.msg;a.status.code==1001?(a=a.result.data.relationships[0],
"add_follow"==g?e.parent().attr("type")=="all"?a=="r1"?e.parent().html(c.add_ok):a=="r3"&&e.parent().html(c.add_all):e.attr("type")!="sina"&&(e.parent().attr("type")=="group"?e.parent().html(c.span_followed):a=="r1"?e.parent().html(c.span_followed):a=="r3"&&e.parent().html(c.add_a)):"del_fo"==g&&(a=="r2"?e.parent().html(c.add_e):a=="r0"&&e.parent().html(c.a_addfo))):alert(b)}},error:function(a,c){"timeout"==c&&alert(MGLANG.msgTimeout)}})};return this}});MOGU.FollowStar=function(){a(".follow_star_div .addfo").live("click",
function(){if(MOGUPROFILE.userid==""){MOGU.user_handsome_login_init();var b=a(this);MOGU.user_handsome_login(!1,{callback:function(){b.click()}})}else{var c=a(this).parent(),f=c.attr("sid"),d='<span class="add_ok">\u5df2\u5173\u6ce8</span><a href="javascript:;" class="unfollow">\u53d6\u6d88</a>';c.attr("type")=="noadd"&&(d='<span class="followed">\u5df2\u5173\u6ce8</span>');a.ajax({url:"/star/follow",data:{starId:f},type:"post",dataType:"json",success:function(a){if(a==null)alert(MGLANG.msgTimeout);
else{var b=a.status.msg;a.status.code==1001?c.html(d):alert(b)}}})}});a(".follow_star_div .unfollow").live("click",function(){if(MOGUPROFILE.userid==""){MOGU.user_handsome_login_init();var b=a(this);MOGU.user_handsome_login(!1,{callback:function(){b.click()}})}else{var c=a(this).parent(),f=c.attr("sid");a.ajax({url:"/star/delfollow",data:{starId:f},type:"post",dataType:"json",success:function(a){if(a==null)alert(MGLANG.msgTimeout);else{var b=a.status.msg;a.status.code==1001?c.html('<a class="addfo" href="javascript:;">\u5173\u6ce8</a>'):
alert(b)}}})}})};a(".followdiv").MOGU_Follow();MOGU.FollowStar()})(jQuery);
!function(a){a.fn.pubimg=function(b){var c={callback:function(a,b,c,d,e){MGTOOL.log("code:"+a),MGTOOL.log("msg:"+b),MGTOOL.log("imgId:"+c),MGTOOL.log("path:"+d),MGTOOL.log(e)},prefun:function(){return!0},ifUserLogin:!0},d=a.extend({},c,b),e=function(){var a="publish_tool_photo_success_",b=Math.floor(99*Math.random()+1),c=a+b;return window[c]?e():c};return d.funName=e(),this.each(function(){var b=a(this),c=!0;b.unbind("click"),b.bind("click",function(){if(d.ifUserLogin&&""==MOGUPROFILE.userid){MOGU.user_handsome_login_init();var a=b,e={callback:function(){a.show(),a.click()}};return MOGU.user_handsome_login(!1,e),c=!1,!1}return d.prefun&&!d.prefun(b)?(c=!1,!1):(c=!0,void 0)}),b.unbind("change"),b.bind("change",function(){if(!c)return!1;var e={title:"",lightBoxId:"lb_loading",ajax:!0,isBgClickClose:!1};loading_light_box=new MGLightBox(e),loading_light_box.init();var f=null;setTimeout(function(){a("#ifr_picup").parent().remove(),f&&clearInterval(f);var c=b.parents("form");"www.mogujie.com"!=location.hostname?0==c.find("input[name=host]").size()&&c.append('<input type="hidden" value="'+location.host+'" name="host">'):(0==c.find("input[name=host]").size()&&c.append('<input type="hidden" value="'+location.host+'" name="host">'),c.attr("action","http://upload.mogujie.com/upload/addpic/")),0==c.find("input[name=callback]").size()&&c.append('<input type="hidden" value="'+d.funName+'" name="callback">'),0==a("#ifr_picup").size()&&a("body").append('<div style="display: none;"><iframe frameborder="0" name="ifr_picup" id="ifr_picup" src="about:blank"></iframe></div>'),c.attr("target","ifr_picup"),c.submit(),b.val("");var e=0;f=setInterval(function(){180==e&&(a("#ifr_picup").parent().remove(),alert(MGLANG.msgTimeout),clearInterval(f)),e++},1e3),window[d.funName]=function(a,c,e,g){return loading_light_box.close(),clearInterval(f),1001!=a?(alert(c),void 0):(d.callback(a,c,e,g,b),void 0)}},0)})})}}(jQuery);(function(a){MOGU.Zone_Choose_Album=function(){var f=a(".chose_album .choose"),g=a(".chose_album .choose_r");a(".chose_album .choose").live("click",function(){a("#zone_album").size()==0&&a("body").append('<div class="my_album" id="zone_album"><div class="album_pr"><div class="my_album_list"></div><div class="create clearfix"><input type="text" class="album_name" value="\u8f93\u5165\u65b0\u4e13\u8f91\u540d"><a href="javascript:;" class="blue_button to_create r3">\u521b\u5efa</a></div></div></div>');
var e=a(".my_album"),d=a(this).offset();e.css({top:d.top+a(this).height(),left:d.left});e.toggle();if(e.css("display")=="none")return a("body").unbind("click"),!1;else a.ajax({url:"/album/useralbums",type:"post",timeout:6E4,dataType:"json",success:function(c){if(c==null)alert(MGLANG.msgTimeOut);else{var b=c.status.msg;if(c.status.code==1001){b=c.result.html;c=c.result.pages;f.addClass("slide");g.addClass("slide_r");a(".chose_album .choose");var e=a("#zone_album .my_album_list");e.html(b);c>1&&e.addClass("scroll");
MOGU.Globe_Input_Text(a("#zone_album .album_name"));i()}else alert(b)}},error:function(a,b){"timeout"==b&&alert(MGLANG.msgTimeout)}})});a("#zone_album .album_ul li").live("click",function(){var e=a("#zone_album"),d=a(this).find(".m_i"),c=a(this);if(!d.prop("checked")){a("#zone_album .album_ul li").removeClass("checked");d.prop("checked",!0);var d=c.find(".m_a"),b=a(".chose_album .choose");b.data("albumid",c.attr("album"));b.html(MGTOOL.jsMbSubstr(d.text(),10)+"<b></b>")}e.hide();f.removeClass("slide");
g.removeClass("slide_r");a(".chose_album .cancel").show()}).live({mouseenter:function(){a(this).addClass("checked")},mouseleave:function(){a(this).removeClass("checked")}});a("#zone_album .create .to_create").live("click",function(){var e=a("#zone_album"),d=a("#zone_album .album_name").attr("value");d===""||d==="\u8f93\u5165\u65b0\u4e13\u8f91\u540d"?(e.show(),alert("\u8bf7\u8f93\u5165\u65b0\u4e13\u8f91\u540d")):a.ajax({url:"/album/newajax",type:"post",timeout:6E4,data:{title:d,type:0},dataType:"json",
success:function(c){if(c==null)alert(MGLANG.msgTimeOut);else{var b=c.status.msg;if(c.status.code==1001){var b=c.result.title,c=c.result.albumId,d=a(".chose_album .choose");d.data("albumid",c);d.html(MGTOOL.jsMbSubstr(b,10)+"<b></b>");e.hide();f.removeClass("slide");g.removeClass("slide_r");a(".chose_album .cancel").show()}else alert(b)}},error:function(a,b){"timeout"==b&&alert(MGLANG.msgTimeout)},complete:function(){e.hide()}})});var i=function(){if(a("#zone_album").css("display")=="block"){var e=
a("#zone_album .create .album_name"),d=a("#zone_album .page_slide"),c=a(".chose_album");a("body").bind("click",function(b){b=b||window.event;b=b.target||b.srcElement;!h(b,e[0])&&!h(b,d[0])&&!h(b,c[0])&&(a("#zone_album").hide(),a("body").unbind("click"))})}},h=function(a,d){for(;a!=void 0&&a!=null&&a.tagName.toUpperCase()!="BODY";){if(a==d)return!0;a=a.parentNode}return!1};a(".chose_album .cancel").live("click",function(){a(".chose_album .choose").removeData("albumid");a(".chose_album .choose").html("\u9009\u62e9\u4e13\u8f91<b></b>");
a(".chose_album .cancel").hide()})};MOGU.Zone_Choose_Album()})(jQuery);
!function(a){var b=['<ul class="lb_tab">',"{{ $.each(it.tab, function(index, item) { }}",'<li f="{{=index + 1}}" title="{{=item.name}}" class="rt3 {{ if (index === 0) { }} c {{ } }}">','<a href="javascript:;" onclick="return false;">{{=item.name}}</a>',"</li>","{{ }); }}","</ul>"].join(""),c=['<ul class="face_l" title="{{=it.name}}">',"{{ $.each(it.face, function(index, item) { }}",'<li title="{{=item.title}}">','<a href="javascript:;" ><img src="{{=item.src}}" /></a>',"</li>","{{ }); }}","</ul>"].join("");window.MGFACE={};var d=function(d){MGFACE.faceTab=MGTOOL.template(b,{tab:d.tab}),MGFACE.facePage={};for(var e=d.page,f=0,g=e.length;g>f;f++)MGFACE.facePage["f"+(f+1)]=MGTOOL.template(c,e[f]);MOGU.WB_Add_Face_Init_New=function(b){var c=this,d={output:"#pub_content",fix:25,left_fix:0},e=a.extend(d,b),f=null,g=null,h="lb_face_v2",i=!1,j=e.output;c.init=function(){a("#"+h).remove(),a("#"+h+" .lb_tab li a").unbind("click"),a("#"+h+" .lb_close").unbind("click"),a("#"+h+" .lb_bd li a").unbind("click"),clearTimeout(f);var b=MGTEMPLATE.twitterLightBox;b=b.replace(/{title}/g,MGFACE.faceTab).replace(/{body}/g,MGFACE.facePage.f1).replace(/{id}/g,h),a("body").append(b),g=a("#"+h);var c=e.click_obj.offset(),d=c.left-e.left_fix;c.left+500>a(window).width()&&(d=c.left-470,g.find(".arrows").css("left",475)),g.css({top:c.top+e.fix+"px",left:d+"px"}),g.show(),f=setTimeout(function(){g.remove()},3e3),g.hover(function(){clearTimeout(f),g.show(),i=!0},function(){clearTimeout(f),f=setTimeout(function(){g.remove()},500),i=!1}),a("#"+h+" .lb_tab li a").bind("click",function(){a("#"+h+" .lb_tab li").removeClass("c"),a(this).parent().addClass("c"),a("#"+h+" .lb_bd").html(MGFACE.facePage["f"+a(this).parent().attr("f")]),k()});var k=function(){a("#"+h+" .lb_bd li a").bind("click",function(b){var c=j.val();c==j.attr("def-v")&&(j.val(""),c=""),j.focus();var d="["+a(this).parent().attr("title")+"]";if("undefined"!=typeof document.selection)document.selection.createRange().text=d;else{var e=j[0].selectionStart;j.val(c.substr(0,e)+d+c.substring(e,c.length)),j[0].setSelectionRange(e+d.length,e+d.length)}clearTimeout(f),a("#"+h).show(),f=setTimeout(function(){a("#"+h).remove()},2e3),b.preventDefault()})};k(),a("#"+h+" .lb_close").bind("click",function(b){a("#"+h).remove(),b.preventDefault()})}}};a(document).ready(function(){a.ajax({url:MOGUPROFILE.cdnHost+"/__/js/module/module-data-face.js$2014010301.js",cache:!0,dataType:"script",success:function(){MOGU&&MOGU.__faceData&&d(MOGU.__faceData)}})})}(jQuery);(function(d){MOGU.Img_Pub_Widget=function(i){var j={img_limit:3,pub_img_content:d(".pub_img_content"),up_another_div:d(".pub_img_content .up_another"),up_default_div:d(".pub_img_content .default"),del_wrap:"img_wrap",hide_img_content:!1},b=d.extend(j,i),g=function(a){a==0?b.up_default_div.show():a<b.img_limit?(b.up_default_div.hide(),b.up_another_div.show(),b.pub_img_content.show()):(b.up_default_div.hide(),b.up_another_div.hide())},f={get_img_array:function(){return typeof b.pub_img_content.data("img_array")===
"undefined"?"":b.pub_img_content.data("img_array")},get_img_count:function(){var a=this.get_img_array();return d.trim(a)==""?0:a.replace(/^,+/,"").replace(/,+$/,"").split(/,+/).length},set_img_count:function(a){var c=this.get_img_array();MGTOOL.log("1:"+c);c+=a+",";MGTOOL.log("2:"+c);b.pub_img_content.data("img_array",c);return this.get_img_count()},del_img_count:function(a){var c=this.get_img_array(),c=c.replace(a+",","");b.pub_img_content.data("img_array",c);return this.get_img_count()}};(function(){b.pub_img_content.find(".add_file").pubimg({prefun:function(){b.pub_img_content.data("img_array");
var a=f.get_img_count();return b.img_limit>a},callback:function(a,c,e,h){b.uppic_cb?b.uppic_cb(a,c,e,h):(a={imgId:e,path:h+"_100x100.jpg"},d(".up_another").show(),d(".up_another").before(MGTOOL.template('<div class="img_wrap r5"><img src="{{= it.path }}" class="r5"><a href="javascript:;" class="del" iid="{{= it.imgId }}"></a></div>',a)));e=f.set_img_count(e);g(e)}})})();(function(){b.pub_img_content.find(".del").live("click",function(){var a=d(this);a.parents("."+b.del_wrap).remove();d(".up_another").hide();
a=f.del_img_count(a.attr("iid"));g(a)})})()}})(jQuery);
(function(a){MOGU.WB_Add_Face_Init=function(){var f=null,b=null,d=null,i=!1;a(".add_face").live("click",function(){var c=a(this).attr("w");(i=c=="fw"||c=="sm"||c=="at_ta"||c=="lpt"||c=="book_addalbum"||c=="acc"||c=="follow_add"||c=="whisper"||c=="group_add"||c=="message_talk")||a(".light_box").remove();clearTimeout(f);var e=MGTEMPLATE.twitterLightBox,e=e.replace(/{title}/g,MGFACE.faceTab).replace(/{body}/g,MGFACE.facePage.f1).replace(/{id}/g,"lb_face");a("body").append(e);d=a("#lb_face");var e=a(this).offset(),
g=25;c=="fw"&&(g=60);var h=e.left;e.left+500>a(window).width()&&(h=e.left-470,d.find(".arrows").css("left",475));d.css({top:e.top+g+"px",left:h+"px"});c=="album_rpl"&&d.css({top:e.top+g+"px",left:h-400+"px"});d.show();switch(c){case "tpk":case "evt":case "note":b=a("#pub_content");break;case "pub":b=a("#pub_content");break;case "f":b=a(this).parents(".cf_pub_b").find(".pub_txt");break;case "fw":b=a("#lb_forward .fw_content");break;case "cm":b=a(this).next(".reply_content");break;case "newtpk":b=a("#topic_con textarea");
break;case "single":b=a("#comment_box .comment_content");break;case "singlef":b=a(".single_talk .forward_content");break;case "share":b=a("#publish_editor");break;case "sm":b=a("#lb_message .sm_content");break;case "at_ta":b=a("#lb_home_at_ta .at_content");break;case "lpt":b=a(".lbp_box .pub_txt");break;case "book_rpl":b=a("#reply_body .rep_cont");break;case "dapei_rpl":b=a("#reply_body_dapei .rep_cont");break;case "book_addalbum":b=a("#lb_addalbum .album_text");break;case "follow_add":b=a("#lb_album_tuijian .content_test");
break;case "addalbum":b=a(this).parents(".content").find(".album_all");break;case "whisper":b=a(".sub_final_stat .sub_text");break;case "album_rpl":b=a(this).parents(".pub_box_all").find(".txt");break;case "cover_rpl":b=a(this).parents(".pub_box").find(".txt");break;case "acc":b=a("#lb_fillalbum .lb_edit_box .cont");break;case "mg_share":b=a(this).parents(".text").find("textarea");break;case "mg_sharegoods":b=a(this).parents(".edit").find("textarea");break;case "cover_talk":b=a(this).parent(".pub_bottom").prev(".pub_content");
break;case "album_talk":b=a(this).parent(".pub_bottom").prev(".pub_content");break;case "group_add":b=a(this).parents(".t_follow").find("textarea");break;case "message_talk":b=a(this).parent().prev("textarea");break;case "book_jia_rpl":b=a(this).parents(".reply_box").find("textarea")}f=setTimeout(function(){d.remove()},3E3);d.hover(function(){clearTimeout(f);d.show()},function(){clearTimeout(f);f=setTimeout(function(){d.remove()},500)})});a("#lb_face .lb_tab li a").live("click",function(){a("#lb_face .lb_tab li").removeClass("c");
a(this).parent().addClass("c");a("#lb_face .lb_bd").html(MGFACE.facePage["f"+a(this).parent().attr("f")])});a("#lb_face .lb_close").live("click",function(){a("#lb_face").remove()});a("#lb_face .lb_bd li a").live("click",function(){var c=b.val();b.focus();var e="["+a(this).parent().attr("title")+"]";if(typeof document.selection!="undefined")document.selection.createRange().text=e;else{var d=b[0].selectionStart;b.val(c.substr(0,d)+e+c.substring(d,c.length));b[0].setSelectionRange(d+e.length,d+e.length)}i&&
(clearTimeout(f),a("#lb_face").show(),f=setTimeout(function(){a("#lb_face").remove()},2E3))})};MOGU.WB_Add_Face_Init()})(jQuery);
window.Messenger=function(){function t(t,e){var i="";if(arguments.length<2?i="target error - target and name are both requied":"object"!=typeof t?i="target error - target itself must be window object":"string"!=typeof e&&(i="target error - target name must be string type"),i)throw new Error(i);this.target=t,this.name=e}function e(t,e){this.targets={},this.name=t,this.listenFunc=[],i=e||i,this.initListen()}var i="[PROJECT_NAME]",o="postMessage"in window;return t.prototype.send=o?function(t){this.target.postMessage(i+t,"*")}:function(t){var e=window.navigator[i+this.name];"function"==typeof e&&e(i+t,window)},e.prototype.addTarget=function(e,i){var o=new t(e,i);this.targets[i]=o},e.prototype.initListen=function(){var t=this,e=function(e){"object"==typeof e&&e.data&&(e=e.data),e=e.slice(i.length);for(var o=0;o<t.listenFunc.length;o++)t.listenFunc[o](e)};o?"addEventListener"in document?window.addEventListener("message",e,!1):"attachEvent"in document&&window.attachEvent("onmessage",e):window.navigator[i+this.name]=e},e.prototype.listen=function(t){this.listenFunc.push(t)},e.prototype.clear=function(){this.listenFunc=[]},e.prototype.send=function(t){var e,i=this.targets;for(e in i)i.hasOwnProperty(e)&&i[e].send(t)},e}();var MOGU=window.MOGU||{};MOGU.alert=MOGU.alert||function(t){window.alert(t)},MOGU.IM_Module=function(t,e,i,o,a,n,r){n=n||(n=MoGu.util);var s="http://www.mogujie.com",d=t.ActiveXObject&&!t.XMLHttpRequest?!0:!1,c={style2:{width:"82",height:"26"},"default":{width:"85",height:"24"},widget1:{width:"40",height:"55"},widget2:{width:"40",height:"55"},widget3:{width:"18",height:"22"},yaya_style:{width:"64",height:"70"}},l=null,m=function(t){for(var e in c)if(t.hasClass(e))return e;return null},u=function(t,e){if(void 0===e){var i=n.getCookie(t);return""===i?void 0:r.parse(i)}n.setCookie(t,r.stringify(e),{expires:1,path:"/"})},f=function(t,e){if(void 0===e){var i=n.getCookie(t);return""===i?void 0:i}n.setCookie(t,e,{expires:1,path:"/"})},p=function(t){var e,o,a,n;o=['<div id="J_im_loadingdom" class="im-waiting">','<img class="lo_yaya" src="//s6.mogujie.cn/pic/140514/ubzlo_kqzdcv2mozbfqwtwgfjeg5sckzsew_93x93.gif" width="93" height="93">','<p class="lo_word J_im_loading_dis"></p>',"</div>"].join(""),e=['<style id="J_im_loadingstyle">','.im-waiting{display:none;position:fixed;left:50%;top:50%;margin-left:-66px;margin-top:-66px;width:130px;height:130px;background:#fff;border:1px solid #dcdcdc;z-index:1000;border-radius:8px;box-shadow:0 0 12px rgba(0, 0, 0, .3);_position:absolute;_top:expression(document.compatMode && document.compatMode=="CSS1Compat"?documentElement.scrollTop+documentElement.clientHeight/2:document.body.scrollTop+document.body.clientHeight/2);}',".im-waiting .lo_yaya{display:block;margin:4px auto 0;}",".im-waiting .lo_word{color:#FC3C75;text-align:center;font-size:14px;}","</style>"].join(""),a=i("#J_im_loadingstyle"),a.length<=0&&i("head").append(e),n=i("#J_im_loadingdom"),n.length<=0&&(n=i(o),i("body").append(n)),n.find(".J_im_loading_dis").html(t),n.show(300),setTimeout(function(){h()},3e4)},h=function(){i("#J_im_loadingdom").hide(300)},g=function(t,e,o,n){var r,c,l,m,u=/com\/detail\/(1[a-z0-9]+)/;r=s+"/mtalk/imv2/",a&&a.atc&&(r+="?atc="+a.atc),c=['<style id="J_imframe_style">','.im-frame{position:fixed;visibility:hidden;width:569px;height:418px;right:120px;bottom:36px;z-index:1000;_position:absolute;_bottom:auto;_top:expression((document.compatMode && document.compatMode=="CSS1Compat"?documentElement.scrollTop+(documentElement.clientHeight-this.clientHeight):document.body.scrollTop+(document.body.clientHeight-this.clientHeight))-36);}',".im-closed{right:-600px!important;_right:120px;_display:none;}",".im-frame-proxy{position:fixed;width:476px;height:28px;right:148px;bottom:401px;z-index:1001;cursor:move;}",".im-proxy-closed{display:none;}",".ST_im-frame-proxy-move{background:#EBFAFF;opacity:.8;filter:alpha(opacity=80);}","html,body{_background-image:url(about:blank);_background-attachment:fixed;}","</style>"].join(""),l=['<iframe class="im-frame im-closed" id="J_imframe" src="" allowtransparency="true" scrolling="no" marginwidth="0" marginheight="0" width="569" height="418" frameborder="0"></iframe>'].join(""),m=['<div class="im-frame-proxy im-proxy-closed" id="J_imframe_proxy"></div>'].join("");var h=i("#J_imframe_style");h.length<=0&&i("head").append(c);var g=i("#J_imframe"),y=i("#J_imframe_proxy");if(g.length<=0&&(g=i(l),y=i(m),i("body").append(g),d||i("body").append(y),setTimeout(function(){g.css("visibility","visible")},1e3),p("正在连接...")),g.hasClass("im-closed")&&(g.removeClass("im-closed"),y.removeClass("im-proxy-closed")),t)g.attr("src",r+"#chat/"+t);else if(e){e.indexOf("#")<0&&(e+="#23");var _=decodeURIComponent(n).match(u),b="";_&&_[1]&&(b+="/g"+_[1]),g.attr("src",r+"#chat/b"+encodeURIComponent(e)+b)}else{var w=f("imcuid");w=w&&w.split("/"),w&&"hold"===w[0]&&w[1]?g.attr("src",r+"#chat/"+w[1]):g.attr("src",r+"#chat")}},y=function(e,o,a,n,d,c){if("service"===a){var m,f,p,h,y;t.webkitNotifications&&0!==t.webkitNotifications.checkPermission()&&t.webkitNotifications.requestPermission(function(){}),h="__mogutalk_boot",y={enable:"true"},e?(y.uid=e,u(h,y)):o&&(o.indexOf("#")<0&&(o+="#23"),y.bid=o,u(h,y)),f=u("__mogutalk_life"),p=+new Date,m=Math.abs(p-parseInt(f,10)),(void 0===f||m>4e3)&&t.open(s+"/mtalk","im","top=50,left=100,width=1000,height=640,location=yes,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbar=no")}else if("cm"===a){var _={};c&&"true"===c&&(_.imclient="1.0"),i.ajax({url:"/mtalk/im/calltobusiness",data:_,type:"POST",dataType:"json",success:function(){}})}else self!==top?l&&l.send(r.stringify({code:1001,data:{uid:e,bid:o,utype:a,refer:n,from:d}})):g(e,o,a,n,d)},_=function(){self!==top?(l=new Messenger("Frame","ImFrame"),l.addTarget(t.parent,"Parent")):(l=new Messenger("Parent","ImFrame"),l.listen(function(t){try{switch(t=r.parse(t),t.code){case 1001:var e=t.data;y(e.uid,e.bid,e.utype,e.refer,e.from);break;case 1002:i("#J_imframe").addClass("im-closed"),i("#J_imframe_proxy").addClass("im-proxy-closed");break;case 1003:i("#J_imframe").remove(),i("#J_imframe_proxy").remove(),h();break;case 1004:i("#J_imframe").removeClass("im-closed"),i("#J_imframe_proxy").removeClass("im-proxy-closed");break;case 1005:o.user_handsome_login_init(),o.user_handsome_login(!1,{callback:function(){location.reload()}});break;case 1006:var e=t.data;e.msg&&o.alert(e.msg);break;case 1007:var e=t.data;e&&e.msg?p(e.msg):h()}}catch(a){}}))},b=function(){var t=function(t){if(t){var e,o,n,r,d,l,m,u,f,p,h,g;if(e=i(t),o=e.attr("data-style"),m=e.attr("data-bid"),u=e.attr("data-uid"),f=e.attr("data-type"),client=e.attr("data-client"),p=e.attr("data-from"),h=e.html(),n=c[o],void 0!==n&&(r=n.width,d=n.height,g=""===a.userid?"x":"√",l=[s+"/mtalk/widget/enterbutton?","style=",o,"&width=",r,"&height=",d,"&cnt=",encodeURIComponent(h),"&islogin=",encodeURIComponent(g)],u?(l.push("&uid="),l.push(encodeURIComponent(u))):m&&(l.push("&bid="),l.push(encodeURIComponent(m))),f&&(l.push("&type="),l.push(encodeURIComponent(f))),u||m||f)){client&&"true"===client&&(l.push("&client="),l.push(encodeURIComponent(client))),l.push("&from="+(p||"")),l.push("&refer="+encodeURIComponent(location.href));var y=i('<iframe src="" width="'+r+'" height="'+d+'" frameborder="0" scrolling="no" marginheight="0" allowtransparency="true"></iframe>');e.html(y),y.attr("src",l.join(""))}}};i(".mogutalk_widget_btn").each(function(){t(this)}),i(e).on("createim:widget",function(e,i){t(i)})},w=function(){i(".mogutalk_btn").each(function(){var t,e,o,n,r,s=null,d=!1;if(t=i(this),s=m(t),null!==s){if(r=t.attr("data-islogin"),(a&&""!==a.userid||r&&"√"===r)&&(d=!0),o=t.attr("data-uid"),n=t.attr("data-bid"),e={},data_block={},o)e.userId=o,data_block.uid=o;else{if(!n)return;n.indexOf("#")<0&&(n+="#23"),e.shopId=n.split("#")[0],e.type=n.split("#")[1],data_block.bid=n.split("#")[0]}i.ajax({url:"/mtalk/im/customeronline",data:e,dataType:"json",success:function(e){if(e&&1001===e.status.code){var i=1===e.result.isOnline?!0:!1;i||(t.addClass("mogutalk_btn_offline"),"default"!==s&&t.addClass(s+"_offline"))}}}),d&&i.ajax({url:"/mtalk/user/isblock",data:data_block,dataType:"json",success:function(e){void 0!==e&&1001===e.status.code&&e.result&&e.result.isBlock===!0&&t.addClass("isblock")}})}})},v=function(){i(e).on("click",".mogutalk_btn",function(t){t.preventDefault();var e,n,d,c,m,u,f,p;if(e=i(this),n=!1,u=e.attr("data-islogin"),(a&&""!==a.userid||u&&"√"===u)&&(n=!0),!n){if(a)return o.user_handsome_login_init(),void o.user_handsome_login(!1,{callback:function(){location.reload()}});if(u)return void(l?l.send(r.stringify({code:1005})):top.location.href=s+"/login?refer="+e.attr("data-refer"))}if(d=e.attr("data-uid"),c=e.attr("data-bid"),m=e.attr("data-type"),p=e.attr("data-refer"),f=e.attr("data-from"),client=e.attr("data-client"),e.hasClass("isblock")){var h="您不能和对方对话～";return void(a?o.alert(h):l&&l.send(r.stringify({code:1006,data:{msg:h}})))}y(d,c,m,p,f,client)}),i(e).on("click",".duoduo_chat",function(t){t.preventDefault();var e=i(this).attr("data-uid");i.ajax({url:"/mtalk/im/calltotalk",data:{uid:e},type:"POST",dataType:"json",success:function(t){o.alert(t&&t.status?1001===t.status.code?"已联系用户，请切换到多多查看！":1002010===t.status.code?"请先登录多多！":t.status.msg:"网络错误，请稍后再试")}})})},x=function(){var t={startX:148,startY:401,mouseStartX:0,mouseStartY:0,originWidth:476,originHeight:28,width:569,height:418,offsetX:-28,offsetY:-365},o=i("#J_imframe"),a=0,n=function(){var e=i(".im-frame-proxy");e.length<=0||(e.animate({right:t.startX+t.offsetX+"px",bottom:t.startY+t.offsetY+"px"},100,function(){e.css({width:t.originWidth+"px",height:t.originHeight+"px",right:t.startX+"px",bottom:t.startY+"px"}).removeClass("ST_im-frame-proxy-move")}),o.length<=0&&(o=i("#J_imframe")),o.animate({opacity:1},100))},r=function(){clearTimeout(a),a=setTimeout(function(){n()},500)};i(e).on("mousedown",".im-frame-proxy",function(e){e.preventDefault();var a=i(this);t.startX=parseInt(a.css("right"),10),t.startY=parseInt(a.css("bottom"),10),t.mouseStartX=e.clientX,t.mouseStartY=e.clientY,a.css({width:t.width+"px",height:t.height+"px",right:t.startX+t.offsetX+"px",bottom:t.startY+t.offsetY+"px"}).addClass("ST_im-frame-proxy-move"),o.length<=0&&(o=i("#J_imframe")),o.animate({opacity:.9},100),r()}).on("mousemove",".ST_im-frame-proxy-move",function(e){e.preventDefault();var o=i(this);o.css({right:t.startX+(t.mouseStartX-e.clientX)+t.offsetX+"px",bottom:t.startY+(t.mouseStartY-e.clientY)+t.offsetY+"px"}),r()}).on("mouseup",".im-frame-proxy",function(e){e.preventDefault();var n=i(this);t.startX=t.startX+(t.mouseStartX-e.clientX),t.startY=t.startY+(t.mouseStartY-e.clientY),n.css({width:t.originWidth+"px",height:t.originHeight+"px",right:t.startX+"px",bottom:t.startY+"px"}).removeClass("ST_im-frame-proxy-move"),o.length<=0&&(o=i("#J_imframe")),o.css({right:t.startX+t.offsetX+"px",bottom:t.startY+t.offsetY+"px"}),o.animate({opacity:1},100),clearTimeout(a)})};return{init:function(){_(),b(),w(),v(),d||x()}}}(window,document,jQuery,window.MOGU,window.MOGUPROFILE,window.MGTOOL,window.JSON),$(document).ready(function(){MOGU.IM_Module.init()});!function(e){var t={REPORT_URL:"//book.log.juangua.com/mogu.js",moduleNames:[],imgs:{},entrySent:!1,leaveSent:!1,init:function(){this.initTime=this.helper.getNewTime(),this.uuid=this.helper.getCookie("__mgjuuid")+this.initTime;for(var e in this.modules)this.registModule(e,this.modules[e]);this.addEvent()},addEvent:function(){var e=this;window.onbeforeunload=function(){var t=parseInt((e.helper.getNewTime()-e.initTime)/1e3)+"s";e.leaveSend([],{staytime:t},!1)}},modules:{},extend:function(t,n){var i=this.modules[t];i?e.extend(i,n):this.modules[t]=n,this.registModule(t,n)},registModule:function(t,n){"function"==typeof n.init&&n.init(),-1==e.inArray(t,this.moduleNames)&&(this.moduleNames.push(t),this[t]=n)},helper:{parseTime:function(e){return new Date(parseInt(e)).toLocaleString()},getNewTime:function(){return(new Date).getTime()},getCookie:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return t=document.cookie.match(n),t?unescape(t[2]):null},filter:function(e){return"string"!=typeof e?e:e.replace(/\?|&/gi,"")}},exports:function(t,n){e.isPlainObject(t)?(n=t,t=this.moduleNames):t&&t.length||(t=this.moduleNames);var i,r,o,a=[],s=this;if(e.each(t,function(t,n){if(i=s.modules[n],!i||"function"!=typeof i.exports)return!0;var u;try{if(o=i.exports(),!e.isPlainObject(o))return!0;r=e.map(o,function(e,t){return u=t.indexOf("extra_param")>-1?":":"=",[s.helper.filter(t),u,s.helper.filter(e)].join("")}),a.push(r.join("&"))}catch(c){}}),e.isPlainObject(n)&&!e.isEmptyObject(n)){var u=e.map(n,function(e,t){return concatSplit=t.indexOf("extra_param")>-1?":":"=",[s.helper.filter(t),concatSplit,s.helper.filter(e)].join("")});u.length&&a.push(u.join("&"))}return a.join("&")},sendLog:function(t,n){var i=this;if(t){var r=e.ajax({url:i.REPORT_URL,method:"get",data:n,async:!1,timeout:1e3});r.error(function(){r&&r.abort()})}else{var o=new Image,a="_img_"+Math.random();i.imgs[a]=o,o.onload=o.onerror=function(){i.imgs[a]=null},o.src=[i.REPORT_URL,"?",n].join("")}},defaultSend:function(e,t,n){t=t||{};var i=this.exports(e,t);this.sendLog(n,i)},entrySend:function(t,n,i){var r=this;if(!this.entrySent){this.entrySent=!0,n=n||{},e.extend(n,{uuid:r.uuid,action:"entry"});var o=this.exports(t,n);this.sendLog(i,o)}},leaveSend:function(t,n,i){var r=this;if(!this.leaveSent){this.leaveSent=!0,n=n||{},e.extend(n,{uuid:r.uuid,action:"leave"});var o=this.exports(t,n);this.sendLog(i,o)}}};t.init(),MOGU.LogApp=t}(jQuery),function(e,t){if(t){var n={url:location.href,screenWidth:window.screen.width,userAgent:window.navigator.userAgent,getPageUrl:function(){return this.url.replace(/(\?|\&)/gi,"%")},getBrowser:function(){var e={};if("object"!=typeof navigator||"string"!=typeof navigator.userAgent)return"others";var t=navigator.userAgent.toLowerCase();if(!t||""==t||"string"!=typeof t)return"others";var n;return(n=t.match(/msie ([\d.]+)/i))?e.ie=n[1]:(n=t.match(/chrome\/([\d.]+)/i))?e.chrome=n[1]:(n=t.match(/firefox\/([\d.]+)/i))?e.firefox=n[1]:(n=t.match(/opera.([\d.]+)/i))?e.opera=n[1]:(n=t.match(/version\/([\d.]+).*safari/i))?e.safari=n[1]:0,e.ie?"IE: "+e.ie:e.firefox?"Firefox: "+e.firefox:e.chrome?"Chrome: "+e.chrome:e.opera?"Opera: "+e.opera:e.safari?"Safari: "+e.safari:"others"},exports:function(){var e=this;return{pageurl:e.getPageUrl(),screenwidth:e.screenWidth,broswer:e.getBrowser()}}};t.extend("ClientInfo",n)}}(jQuery,MOGU.LogApp),function(e,t){if(t){var n={errors:[],init:function(){this.addEvent()},addEvent:function(){var e=this;window.onerror=function(t,n,i){e.errors.push({msg:t,line:i})}},exports:function(){var t,n=[];return e.each(this.errors,function(e,i){t=[i.msg,"@line",i.line].join(""),n.push(t)}),{errors:n.join(",")}}};t.extend("PageError",n)}}(jQuery,MOGU.LogApp),function(e,t){if(t&&0!==location.protocol.indexOf("https")){var n={cdnUrl:".mogujie.cn/pic/140515/嘉年华(3)_kqzg4ykel5bdkrlwgfjeg5sckzsew_600x291.jpg",testCdn:["s13","s6","s12","s7"],timeArr:[],init:function(){this.addEvent()},addEvent:function(){var n=this;e(function(){e.each(n.testCdn,function(i,r){var o=new Image,a=t.helper.getNewTime();e(o).load(function(){n.timeArr.push(t.helper.getNewTime()-a)}).attr("src","http://"+r+n.cdnUrl)})})},exports:function(){var t=[],n=this;return e.each(n.testCdn,function(e,i){t.push(i+":"+(n.timeArr[e]||0)+"ms")}),{netspeed:t.join(",")}}};t.extend("NetSpeed",n)}}(jQuery,MOGU.LogApp),function(e,t){if(t&&window.performance){var n={timing:window.performance.timing,blankTime:0,readyTime:0,onloadTime:0,setData:function(){var e=this,t=e.timing.domainLookupStart;e.blankTime=(window.__trace__headendt||0)-t,e.readyTime=e.timing.domInteractive-t,e.onloadTime=e.timing.domComplete-t},exports:function(){var e=this;return e.setData(),{pfm:["b:"+e.blankTime,"r:"+e.readyTime,"o:"+e.onloadTime].join(",")}}};t.extend("Performance",n)}}(jQuery,MOGU.LogApp),function(e,t){t&&e(window).on("load",function(){t.defaultSend(["ClientInfo","PageError","NetSpeed","Performance"],{_:+new Date},!1)})}(jQuery,MOGU.LogApp);var MOGU=MOGU||{};!function(a,b){var c={};c.Util={mask:function(){var b=a(".light_box_fullbg");b.length<=0&&(b=a(['<div class="light_box_fullbg"></div>'].join("")),a("body").append(b))},show:function(b,c){var d,e,f,g=a("#vp_wrap"),h=a(".light_box_fullbg").eq(0);g.length<=0&&(g=a(['<div class="vp_wrap" id="vp_wrap">','<h5 class="vp_t"></h5>','<a href="javascript:;" class="vp_cls">×</a>','<div class="v_pop_box"></div>',"</div>"].join("")),a("body").append(g),h.off("click").on("click",function(){clearTimeout(f),g.addClass("vp_shake"),f=setTimeout(function(){g.removeClass("vp_shake")},500)})),g.find(".vp_t").html(c.title),e={alert:function(){return d=a(".vp_alert"),d.length<=0&&(d=a(['<div class="vp_alert vp_inner">','<p class="vp_cnt"></p>','<a href="javascript:;" class="vp_btn vp_ok">确定</a>',"</div>"].join(""))),d.show().find(".vp_cnt").html(c.content),d},confirm:function(){return d=a(".vp_cfm"),d.length<=0&&(d=a(['<div class="vp_cfm vp_inner">','<p class="vp_cnt"></p>','<a href="javascript:;" class="vp_btn vp_ok">确定</a>','<a href="javascript:;" class="vp_btn vp_cancel">取消</a>',"</div>"].join(""))),d.show().find(".vp_cnt").html(c.content),d}},g.find(".v_pop_box").append(e[b]()),g.css({display:"block",opacity:0}).css({"margin-left":-g.width()/2-1,"margin-top":-g.height()/2-1,opacity:1}),h.show()},close:function(b,c){a(".light_box_fullbg").eq(0).hide(),a("#vp_wrap").find(".vp_inner").hide().end().hide(),void 0!==c&&"function"==typeof c&&c(b)},debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}},b.alert=a.alert=function(b,d,e){var f=a.extend({title:"提示",content:b},e),g=function(){a("#vp_wrap").off("click").on("click",".vp_ok, .vp_cls",function(){c.Util.close(void 0,d)})};!function(){c.Util.mask(),c.Util.show("alert",f),g()}()},b.confirm=a.confirm=function(b,d,e){var f=a.extend({title:"提示",content:b},e),g=function(){a("#vp_wrap").off("click").on("click",".vp_cls, .vp_cancel",function(a){a.preventDefault(),c.Util.close(!1,d)}).on("click",".vp_ok",function(a){a.preventDefault(),c.Util.close(!0,d)})};return"object"==typeof arguments[1]&&arguments[1].length>0?(c.Confirm.apply(this,arguments),void 0):(function(){c.Util.mask(),c.Util.show("confirm",f),g()}(),void 0)},c.Confirm=function(b,c,d){var e=c,f=function(){var c=a("#vp_tip");return c.length<=0&&(c=a(['<div class="vp_tip" id="vp_tip">','<p class="vp_tip_cnt"></p>','<a href="javascript:;" class="vp_min_btn vp_min_ok">确定</a>','<a href="javascript:;" class="vp_min_btn vp_min_cancel">取消</a>',"</div>"].join(""))),c.find(".vp_tip_cnt").html(b),c.removeClass("vp_tip_min").removeClass("vp_tip_max").css("opacity",0).show(),c},g=function(){a("#vp_tip").off("click").on("click",".vp_min_ok",function(a){a.preventDefault(),h(!0,d)}).on("click",".vp_min_cancel",function(a){a.preventDefault(),h(!1,d)})},h=function(b,c){a("#vp_tip").hide(),void 0!==c&&"function"==typeof c&&c(b)},i=function(){var b=a("#vp_tip"),c=e.offset(),d=b.width();120>d&&b.addClass("vp_tip_min"),d>240&&b.addClass("vp_tip_max"),b.css({top:c.top-b.outerHeight(),left:c.left+(e.outerWidth()-b.outerWidth())/2,opacity:1})};!function(){a("body").append(f()),i(),g()}()}}(jQuery,MOGU);!function(a){MOGU.Publish_Imgs_Init=function(c,d){a("#lb_publish_box .add_file").pubimg({callback:function(e,f,g,h,i){c.close();var j={title:"我要分享",lightBoxId:"lb_publish_imgs",scroll:!1,ajax:!0,isBgClickClose:!1},k=new MGLightBox(j);k.init();var l={imgId:g,path:h};d=i.attr("tab")?{tab:i.attr("tab")}:d,d&&d.isdapeiroom&&(l={imgId:g,path:h,isdapeiroom:1,roomTitle:d.roomTitle});a.ajax({url:"/twitter/imgpubview",type:"POST",timeout:6e4,data:l,dataType:"json",success:function(c){if(null==c||""==c)alert(MGLANG.msgTimeout);else{var e=c.status.code,f=c.status.msg;if(1001==e){var h=c.result.data.html;if(k.buildContent(h),d&&d.albumId&&a("#lb_publish_imgs .chose_album").hide(),MOGU.Globe_Input_Text_Hide(a(".pub_box_op .pub_txt")),MOGU.Globe_Input_Text_Hide(a(".pub_addlink .addlink_con")),b(),"0"==MOGUPROFILE.is_subsite)var i=140;else var i=300;MOGU.WB_Word_Count("lb_publish_imgs","pub_content_img",i);var j={img_limit:8,pub_img_content:a(".pub_img_content"),up_another_div:a(".pub_img_content .up_another"),up_default_div:a(".pub_img_content .default")};a(".pub_img_content").data("img_array",g+","),MOGU.Img_Pub_Widget(j),a("#pub_content_img").focus(function(){a(".pub_img_content .word_count_wrap").show()}).blur(function(){a(".pub_img_content .word_count_wrap").hide()}),a("#lb_publish_imgs .pub_submit").click(function(){var b=a(".pub_img_content").data("img_array"),c=a("#lb_publish_imgs"),e=c.find(".pub_out input").prop("checked"),f=c.find(".pub_txt"),g=f.val();g=f.attr("def-v")==g?"":g;var h=MGTOOL.getMsgLength(a.trim(g));if(h>i)return alert("最多可以输入"+i+"个字，您输入得太多了。"),!1;var j=c.find(".choose").data("albumid"),l={content:g,imgIds:b,albumId:j,sync:e,local:MOGUPROFILE.local};if(d)for(var m in d)"undefined"!=typeof d[m]&&(l[m]=d[m]);if("undefined"==typeof l.albumId){if(j=c.find(".choose").attr("albumid"),"undefined"==typeof j)return alert("你还未选择专辑"),!1;l.albumId=j}l.imageGoods=[],a(".pub_link_list .link_item").each(function(){l.imageGoods.push(a(this).data("imageGoods"))});var n={data:l,succ_cb:function(b,c){d?d.albumId?(k.success_close("发表成功！"),"true"==d.reload&&setTimeout(function(){window.location.reload()},1e3)):d.starId?k.success_close('发表成功，请等待审核！ <a href="/album/show/'+j+'" class="to_see">去看看</a>',2e3):1==d.isdapeiroom&&0==d.pictureType?(a("#try_apply .twitterid").val(c.result.twitterId),a(".apply_step1 .dapei_upimg").html('<img src="'+c.result.imgUrl+'" />'),k.success_close("发表成功！",1e3)):1==d.isdapeiroom&&1==d.pictureType?window.location.href=window.location.href:k.success_close('发表成功！ <a href="/album/show/'+j+'" class="to_see">去看看</a>',2e3):k.success_close('发表成功！ <a href="/album/show/'+j+'" class="to_see">去看看</a>',2e3),a(".pub_img_content").data("img_array","")},fail_cb:function(){k.fail('发表失败！ <a href="javascript:;" class="try_again">再试一次</a>'),a(".pub_img_content").data("img_array","")}};MOGU.Publish_Pub_Submit(n)})}else alert(f)}},error:function(a,b){"timeout"==b&&alert(MGLANG.msgTimeout)},complete:function(){}})}})};var b=function(){a(".pub_addlink .addlink_btn").bind("click",function(){var b=a.trim(a(".pub_addlink .addlink_con").val()),c=a(".pub_addlink .addlink_con").attr("def-v");return""==b||b==c?(alert("请填写商品地址"),!1):MOGU.Globe_Goods_URL_Support(b)?a(".pub_addlink .pub_link_list li").size()>=6?(alert("最多只能添加6个相关链接哦！"),!1):(a.ajax({url:"/twitter/goodsinfo",type:"POST",timeout:6e4,data:{url:b,type:1},dataType:"json",success:function(b){if(null==b||""==b)alert(MGLANG.msgTimeout),goods_frame.remove();else{var c=b.status.code,d=b.status.msg;if(1001==c){var e=b.result.data.detail,f=e.num_id,g=e.shop_seller,f=e.num_id,h=e.from,i=e.iid,j=".link_item_"+f+"_"+h+"_"+i;if(a(".pub_link_list "+j).size()>0)return alert("不能添加相同的商品"),void 0;var k=b.result.data.html,l=a(".pub_addlink .pub_link_list li").size()+1;a(".pub_link_list").show(),a(".pub_link_list").append(k.replace(/{num}/g,l));var m=a(".pub_link_list "+j);m.data("imageGoods",e);var n="还可添加"+(6-l)+"条链接";6==l&&(n="最多只能添加6个相关链接哦！"),a(".pub_addlink .addlink_con").val(n).attr("def-v",n).css({color:"#ccc"});var o=0;a(".pub_link_list .link_item").each(function(b,c){a(c).attr("shop")==g&&o++}),o>=3&&a(".pub_addlink .error").show()}else alert(d)}}}),void 0):(alert("请填写正确的商品地址"),!1)}),a(".pub_link_list .link_item .del").live("click",function(){var b=0,c=a(this).parents(".link_item"),d=c.attr("shop");MGTOOL.log(d),a(".pub_link_list .link_item").each(function(c,e){a(e).attr("shop")==d&&b++}),c.remove(),a(".pub_link_list .link_item").each(function(b,c){a(c).find(".num").html(b+1)});var e=a(".pub_link_list .link_item").size();0==e&&a(".pub_link_list").hide();var f="还可添加"+(6-e)+"条链接";a(".pub_addlink .addlink_con").val(f).attr("def-v",f).css({color:"#ccc"}),3==b&&a(".pub_addlink .error").hide()})};MOGU.Publish_Goods_Init=function(a,b){var c=['<div class="pub_goods_url clearfix">','<div class="clearfix">','<input class="g_url fl" type="text" value="将商品网址粘贴到这里" placeholder="将商品网址粘贴到这里">','<input class="g_s fl" value="确定" type="button">',"</div>",'<div class="support_site">','<span class="title">已支持以下网站</span>','<p class="support_list">','<a href="http://www.taobao.com/" target="_blank">淘宝</a>','<a href="http://www.paipai.com/" target="_blank">拍拍</a>','<a href="http://www.dangdang.com/" target="_blank">当当</a>','<a href="http://www.vancl.com/" target="_blank">凡客</a>','<a href="http://www.360buy.com/" target="_blank">京东</a>','<a href="http://www.topshop.com/" target="_blank">Topshop</a>','<a href="http://buy.caomeipai.com/" target="_blank">草莓派</a>','<a href="http://www.mbaobao.com/" target="_blank">麦包包</a>','<a href="http://www.nala.com.cn/" target="_blank">NALA</a>','<a href="http://www.maymay.cn/" target="_blank">Maymay</a>','<a href="http://www.asos.com/" target="_blank">asos</a>','<a href="http://www.100f1.com/" target="_blank">我的百分之一</a>','<a href="http://www.51yugou.com/" target="_blank">稀品网</a>','<a href="http://www.rosebeauty.com.cn/" target="_blank">玫瑰社区</a>','<a href="http://cn.shopbop.com/" target="_blank">SHOPBOP</a>',"</p>","</div>","</div>"].join("");a.buildContent(c),MOGU.Publish_Goods_Func(a,b)},MOGU.Publish_Goods_Func=function(b,c){var d=a("#lb_publish_box");MOGU.Globe_Input_Text(d.find(".g_url")),d.find(".g_s").click(function(){b.close();var e=a(this);if(1!=e.data("isSubmit")){var f=MGTOOL.trim(d.find(".g_url").val());if(""==f)return alert("请填写商品地址"),!1;if(!MOGU.Globe_Goods_URL_Support(f))return alert("请填写正确的商品地址"),!1;var g={title:"我要分享",lightBoxId:"lb_publish_goods",scroll:!1,ajax:!0,isBgClickClose:!1},h=new MGLightBox(g);h.init(),e.data("isSubmit",1),getGoodInfo=a.ajax({url:"/twitter/goodsinfo",type:"POST",timeout:6e4,data:{url:f},dataType:"json",success:function(b){if(null==b||""==b)alert(MGLANG.msgTimeout),d.remove();else{var e=b.status.code,f=b.status.msg;if(1001==e){var g=b.result.data.detail,i=g.num_id;MOGU.WB_Goods_Array={},MOGU.WB_Goods_Array[i]=g;var j=b.result.data.html;h.buildContent(j),MOGU.WB_Word_Count("lb_publish_goods","pub_content_goods",140),MOGU.Globe_Input_Text_Hide(a(".pub_box_op .pub_txt")),c&&c.albumId&&a("#lb_publish_goods .chose_album").hide(),a("#lb_publish_goods .pub_submit").click(function(){var b=a("#lb_publish_goods"),d=b.find(".pub_out input").prop("checked"),e=b.find(".pub_txt"),f=e.val(),g="/twitter/newtwitter";f=e.attr("def-v")==f?"":f;var i=MGTOOL.getMsgLength(a.trim(f));if(i>140)return alert("最多可以输入140个字，您输入得太多了。"),!1;var j=b.find(".choose").data("albumid"),k={content:f,albumId:j,goods:MGTOOL.objToJson(MOGU.WB_Goods_Array),sync:d,local:MOGUPROFILE.local};if(c)for(var l in c)"undefined"!=typeof c[l]&&(k[l]=c[l]);if("undefined"==typeof k.albumId){if(j=b.find(".choose").attr("albumid"),"undefined"==typeof j)return alert("你还未选择专辑"),!1;k.albumId=j}k.url&&k.url.length>0&&(g=k.url);var m={data:k,url:g,succ_cb:function(){c?(c.albumId&&h.success_close("发表成功"),"true"==c.reload&&setTimeout(function(){window.location.reload()},1e3)):h.success_close('发表成功！ <a href="/album/show/'+j+'" class="to_see">去看看</a>',2e3),MOGU.WB_Goods_Array={}},fail_cb:function(){h.fail('发表失败！ <a href="javascript:;" class="try_again">再试一次</a>'),MOGU.WB_Goods_Array={}}};MOGU.Publish_Pub_Submit(m)})}else alert(f),d.remove()}},error:function(a,b){"timeout"==b&&alert(MGLANG.msgTimeout)},complete:function(){e.removeData("isSubmit")}})}})},MOGU.Publish_Pub_Submit=function(b){var c={url:"/twitter/newtwitter",data:{},pub_btn:a(".pub_submit"),succ_cb:function(){},fail_cb:function(){}},d=a.extend(c,b);if(1!=d.pub_btn.data("isSubmit")){var e=d.data;e._fk=1,a.ajax({url:d.url,type:"POST",timeout:6e4,data:e,dataType:"json",beforeSend:function(){d.pub_btn.data("isSubmit",1)},success:function(a){if(null==a||""==a)alert(MGLANG.msgTimeout);else{var b=a.status;if(void 0==b||null==b)return alert(MGLANG.msgTimeout),void 0;var c=b.code,e=b.msg;1001==c?d.succ_cb(b,a):2710==c?alert(e):(d.fail_cb(b,a),alert(e))}},error:function(a,b){"timeout"==b&&alert(MGLANG.msgTimeout)},complete:function(){d.pub_btn.removeData("isSubmit")}})}},MOGU.Publish_Pub_Box_Init=function(b){var c="1"==MOGUPROFILE.is_subsite?"上传美图":"上传你的搭配晒货照",d=['<div class="pub_chose clearfix">','<a href="javascript:;" class="chose_goods chose_type r5">',"<b></b>","<p>商品</p>","<span>输入网购商品的链接</span>","</a>",'<a href="javascript:;" class="chose_pic chose_type r5">','<div class="up_pic_wrap">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" id="upload_img" name="image" class="add_file">',"</form>","</div>","<b></b>","<p>照片</p>","<span>"+c+"</span>","</a>","</div>"].join(""),e={title:"我要分享",lightBoxId:"lb_publish_box",scroll:!1,contentHtml:d,isBgClickClose:!1,type:"default"},f=new MGLightBox(e);f.init(),a("#lb_publish_box .chose_goods").click(function(){MOGU.Publish_Goods_Init(f,b)}),MOGU.Publish_Imgs_Init(f,b)},MOGU.Home_Pub_Face=function(){a(".pub_box_op .add_face_new").live("click",function(){var b=a(this).parents(".pub_box_op").find(".pub_txt"),c={click_obj:a(this),output:b},d=new MOGU.WB_Add_Face_Init_New(c);d.init()})},MOGU.Home_Pub_Face()}(jQuery);MOGU.Publish_Pub_Box_Init_Daren=function(a){var b=("1"==MOGUPROFILE.is_subsite?"上传美图":"上传你的搭配晒货照",['<div class="publish_img">','<div class="publish_wrap clearfix">','<div class="dapei item">','<a href="javascript:;" class="upload_wrap">','<div class="upload_file">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" name="image" class="add_file" tab="4">',"</form>","</div>",'<div class="upload_box">','<img src="http://s8.mogujie.cn/pic/131022/sp1ku_kqywm3c2kfbegrlwgfjeg5sckzsew_98x98.jpg">',"</div>",'<div class="upload_btn">',"</div>","</a>","</div>",'<div class="look item">','<a href="javascript:;" class="upload_wrap">','<div class="upload_file">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" name="image" class="add_file" tab="3">',"</form>","</div>",'<div class="upload_box">','<img src="http://s6.mogujie.cn/pic/131022/sp1ku_kqywomlckfbfiq2ugfjeg5sckzsew_98x98.jpg">',"</div>",'<div class="upload_btn">',"</div>","</a>","</div>",'<div class="other item">','<a href="javascript:;" class="upload_wrap">','<div class="upload_file">','<form action="/upload/addpic" method="post" enctype="multipart/form-data" target="ifr_picup" class="add_pic_form">','<input type="hidden" id="coverImgId" value="">','<input type="file" hidefocus="true" name="image" class="add_file">',"</form>","</div>",'<div class="upload_box">','<img src="http://s6.mogujie.cn/pic/131022/sp1ku_kqyvo4kfkfbegq2ugfjeg5sckzsew_98x98.jpg">',"</div>",'<div class="upload_btn">',"</div>","</a>","</div>","</div>","</div>"].join("")),c={title:'分享照片<b style="margin-left:20px;font-size:12px;color:#ff3b60">选择对应的分类，被精彩的概率会更高哦</b><a href="http://www.mogujie.com/group/topic/1z14w" target="_blank" class="publish_img_share" style="position: absolute; top: -25px; right: 17px; width: 120px; height: 88px; overflow: hidden; text-indent: -999em; background: url(http://s12.mogujie.cn/pic/140516/未标题-1_kq2eeutykrbhm2cugfjeg5sckzsew_120x88.png) no-repeat; _filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=\'scale\',src=\'http://s12.mogujie.cn/pic/140516/未标题-1_kq2eeutykrbhm2cugfjeg5sckzsew_120x88.png\'); _background-image: none;">分享得佣金</a>',lightBoxId:"lb_publish_box",scroll:!1,contentHtml:b,isBgClickClose:!1,type:"default"},d=new MGLightBox(c);d.init(),$("#lb_publish_box .chose_goods").click(function(){MOGU.Publish_Goods_Init(d,a)}),MOGU.Publish_Imgs_Init(d,a)};!function(a){MGTEMPLATE.at_ta='<div class="at_pub_area"><div class="atpa_tool"><a href="javascript:;"><img src="/img/add_face_c.png" w="at_ta" style="margin-top:5px" class="fl add_face"></a><span class="at_count">还可以输入<b>140</b>字</span></div><textarea class="at_content"></textarea><div class="at_submit_box"><a class="at_submit" href="javascript:;">发   送</a><a href="javascript:;" class="at_cancel">取消</a></div></div>',MGTEMPLATE.sendMessage='<div class="sm_pub_area"><div class="smpa_tool"><a href="javascript:;"><img src="/img/add_face_c.png" w="sm" style="margin-top:5px" class="fl add_face"></a><span class="sm_count">说明：长度不超过400字</span></div><textarea class="sm_content"></textarea><div class="sm_submit_box"><a class="sm_submit" href="javascript:;">发   送</a><a href="javascript:;" class="sm_cancel">取消</a></div></div>',MOGU.send_message_init=function(){var b="",c=null;a(".send_message").die("click").live("click",function(){b=a(this).attr("toid"),a.ajax({url:"/collect/isinblacklist",type:"POST",data:{blacklistid:b},dataType:"json",success:function(d){if(null==d)alert(MGLANG.msgTimeout);else{var e=d.status.code,f=d.status.msg;if(1001==e){var g=d.result.inblacklist;if(1==g)return alert("由于对方的隐私设置，你暂时还不能给她发私信"),!1;var h={title:"发私信",lightBoxId:"lb_message",contentHtml:MGTEMPLATE.sendMessage,scroll:!0};if(a("#lb_message").size()>0)return!1;c=new MGLightBox(h),c.init(),a(".sm_submit").unbind("click").bind("click",function(){var d=a("#lb_message .sm_content").val();MOGU.send_msessage(b,d,c)}),a(".sm_cancel").unbind("click").bind("click",function(){c.close()})}else alert(f)}}})})},MOGU.send_msessage=function(b,c,d){var e={message_toId:b,message_content:c};a.ajax({url:"/message/ajaxsend",type:"POST",data:e,dataType:"json",success:function(a){if(null==a)alert(MGLANG.msgTimeout);else{var b=a.status.code,c=a.status.msg;1001==b?d.success_close("发送成功！",500):6002==b?alert(c):alert(c)}}})},MOGU.home_home_at_ta_init=function(){a(".home_at_ta").live("click",function(){var b=a(this),c=b.attr("toid"),d=b.attr("title")||"有什么想对她说的？";a.ajax({url:"/collect/isinblacklist",type:"POST",data:{blacklistid:c},dataType:"json",success:function(c){if(null==c)alert(MGLANG.msgTimeout);else{var e=c.status.code,f=c.status.msg;if(1001==e){var g=c.result.inblacklist;if(1==g)return alert("由于对方的隐私设置，你暂时还不能@她"),!1;var h={title:d,lightBoxId:"lb_home_at_ta",contentHtml:MGTEMPLATE.at_ta,scroll:!0};if(a("#lb_home_at_ta").size()>0)return!1;var i=new MGLightBox(h);i.init();var j=b.attr("toname");a("#lb_home_at_ta .at_content").val("@"+j+": ");var k=a("#lb_home_at_ta"),l=k.find(".at_content"),m=l.val().length;if(l[0])if(l[0].createTextRange){var n=l[0].createTextRange();n.moveEnd("character",m),n.moveStart("character",m),n.select()}else l[0].setSelectionRange(m,m),l.focus();var o=function(){var a=MGTOOL.getMsgLength(l.val()),b=k.find(".at_count b");0==a?(b.text(140),b.css("color","#690")):(b.text(140-a),a>140?b.css("color","#F92D09"):b.css("color","#690"))};o(),l.bind("keyup",o).bind("input",o).bind("propertychange",o),a(".at_submit").click(function(){MOGU.home_at_ta(l.val(),i)}),a(".at_cancel").click(function(){a("#lb_home_at_ta,.light_box_fullbg").remove()})}else alert(f)}}})})},MOGU.home_at_ta=function(b,c){a.ajax({url:"/twitter/newtwitter",type:"POST",data:{content:b,_fk:1},dataType:"json",success:function(a){if(null==a)alert(MGLANG.msgTimeout);else{var b=a.status.code,d=a.status.msg;1001==b?c.success_close("发送成功！",500):6002==b?alert(d):alert(d)}}})},MOGU.send_message_init(),MOGU.home_home_at_ta_init()}(jQuery);!function(e){!function(){!function(t){var n=t(".header_2014"),s=e.doT,i={jsLoaded:[],preCommonJs:["/js/module-publishimg.js","/js/module/module-chose-album.js","/js/module/module-addpic-widget.js","/js/module/module-publish.js"],urlPre:"http://www.mogujie.com/__",isLoading:!1,getCommonJs:function(){return this.preCommonJs},getScript:function(e,n){var s=this;if(t.isArray(e)&&!s.isLoading){s.isLoading=!0;var i=[].concat(s.preCommonJs,e),a=[s.urlPre,i.join(",")].join("");t.inArray(a,s.jsLoaded)>-1||t.ajax({url:a,dataType:"script",cache:!0}).done(function(){s.jsLoaded.push(a),t.isFunction(n)&&n(),s.isLoading=!1})}}},a={emmitBtn:n.find(".site_publish_img"),isLoaded:!1,init:function(){this.addEvent()},addEvent:function(){var e=this;e.emmitBtn.on("click",function(){function t(){MOGU.Publish_Pub_Box_Init_Daren(),e.isLoaded=!0}return e.isLoaded?t():i.getScript(["/js/module/module-publish-img.js"],t),!1})}};a.init();var o={};o.Tpl={headerMsgTpl:['<ul class="ext_mode login_ext message_oper">','<li class="s2">',"{{? it.catmeNew > 0 }} ",'<a href="http://www.mogujie.com/infocenter/atme">对话<span>({{= it.catmeNew }})</span></a>',"{{??}} ",'<a href="http://www.mogujie.com/infocenter/atme">对话</a>',"{{?}} ","</li>",'<li class="s2">',"{{? it.cfavedNew > 0 }} ",'<a href="http://www.mogujie.com/infocenter/fav/">喜欢我的<span>({{= it.cfavedNew }})</span></a>',"{{??}} ",'<a href="http://www.mogujie.com/infocenter/fav/">喜欢我的</a>',"{{?}} ","</li>",'<li class="s2">',"{{? it.cmsgNew > 0 }} ",'<a href="http://www.mogujie.com/infocenter/privatemsg/">我的私信<span>({{= it.cmsgNew }})</span></a>',"{{??}} ",'<a href="http://www.mogujie.com/infocenter/privatemsg/">我的私信</a>',"{{?}} ","</li>",'<li class="s2">',"{{? it.csysmsgNew > 0 }} ",'<a href="http://www.mogujie.com/infocenter/sysmsg/">系统通知<span>({{= it.csysmsgNew }})</span></a>',"{{??}} ",'<a href="http://www.mogujie.com/infocenter/sysmsg/">系统通知</a>',"{{?}} ","</li>",'<li class="s2">',"{{? it.fansNew > 0 }} ",'<a href="http://www.mogujie.com/u/'+MOGUPROFILE.userid+'/fans">我的粉丝<span>({{= it.fansNew }})</span></a>',"{{??}} ",'<a href="http://www.mogujie.com/u/'+MOGUPROFILE.userid+'/fans">我的粉丝</a>',"{{?}} ","</li>",'<li class="s2 clear_notice">','<a href="javascript:;">我知道了</a>',"</li>","</ul>"].join("")},o.View={init:function(){this.addEvent()},addEvent:function(){var e=this;t("body").on("cinfodatarecieve",function(n,s){if(s){var i=s,a={};a.twitterNew=parseInt(i.cmessageNew),a.catmeNew=parseInt(i.a),a.cfavedNew=parseInt(i.b),a.cmsgNew=parseInt(i.c),a.fansNew=parseInt(i.d),a.csysmsgNew=parseInt(i.e),a.cactiveNew=parseInt(i.f),a.intelligent=parseInt(i.g),a.ccartNew=parseInt(i.h),a.chatNew=parseInt(i.i),t.each(e.renders,function(e,n){t.isFunction(n)&&n(a)})}})},renders:{renderHeaderMsg:function(e){var i=n.find(".message_center"),a=i.find(".message_oper");if(i.length){a.length&&a.remove();var r=i.find(".m_num"),c=e.catmeNew+e.fansNew+e.cfavedNew+e.cmsgNew+e.csysmsgNew;r.text(c>0?"("+c+")":""),a=s.template(o.Tpl.headerMsgTpl)({catmeNew:e.catmeNew,cfavedNew:e.cfavedNew,cmsgNew:e.cmsgNew,csysmsgNew:e.csysmsgNew,fansNew:e.fansNew,chatNew:e.chatNew}),i.append(a),a=i.find(".message_oper"),n.on("click",".clear_notice a",function(){MGTOOL.setCookie("__mgjccInfo",null,{path:"/"}),t.post("/collect/cancelinfo");var e={catmeNew:0,cfavedNew:0,cmsgNew:0,csysmsgNew:0,fansNew:0,chatNew:0};return a.replaceWith(s.template(o.Tpl.headerMsgTpl)(e),function(){r.text(""),a.hide()}),!1})}},renderShopMsg:function(e){var n=t("#header"),i=n.find(".msg_tip"),a=n.find("#notice_menu");if(n.length&&i.length){var r=i.find(".msg_notice"),c=e.catmeNew+e.fansNew+e.cfavedNew+e.cmsgNew+e.csysmsgNew+e.chatNew;r.text(c>0?"消息("+c+")":"消息");var l=t(s.template(o.Tpl.headerMsgTpl)({catmeNew:e.catmeNew,cfavedNew:e.cfavedNew,cmsgNew:e.cmsgNew,csysmsgNew:e.csysmsgNew,fansNew:e.fansNew,chatNew:e.chatNew}));a.empty().append(l.html()),n.on("click",".clear_notice a",function(){MGTOOL.setCookie("__mgjccInfo",null,{path:"/"}),t.post("/collect/cancelinfo");var e={catmeNew:0,cfavedNew:0,cmsgNew:0,csysmsgNew:0,fansNew:0,chatNew:0},n=t(s.template(o.Tpl.headerMsgTpl)(e));return a.html(n.html()).hide(),r.text("消息"),!1})}},renderShopCart:function(e){var t=n.find(".shopping_cart_v2");t.length&&t.find(".cart_info b").text(e.ccartNew)},renderShopDetailCart:function(e){var n=t("#header").find(".shoppingcard");n.length&&n.find(".ffred").text(e.ccartNew)},renderMsgCenter:function(e){var n=t(".message_piece_bd .message_menu");if(n.length){var s=n.find(".info_atme"),i=n.find(".info_fav"),a=n.find(".info_privatemsg"),o=n.find(".info_sysmsg");s.html(e.catmeNew>0&&s.length?'对话 <b class="atme r5">'+(e.catmeNew>999?"999+":e.catmeNew)+"</b>":"对话"),i.html(e.cfavedNew>0&&i.length?'喜欢我的 <b class="info_fav r5">'+(e.cfavedNew>999?"999+":e.cfavedNew)+"</b>":"喜欢我的"),a.html(e.cmsgNew>0&&a.length?'私信 <b class="info_fav r5">'+(e.cmsgNew>999?"999+":e.cmsgNew)+"</b>":"私信"),o.html(e.csysmsgNew>0&&o.length?'系统通知 <b class="info_fav r5">'+(e.csysmsgNew>999?"999+":e.csysmsgNew)+"</b>":"系统通知")}},renderBacktopShopCart:function(e){var n=t(".back2top_wrap .shop_cart");n.length&&(e.ccartNew?n.find(".num").html(e.ccartNew).show():n.find(".num").hide())},renderBacktopMsg:function(e){var n=t(".back2top_wrap .mogutalk_btn");n.length&&(e.chatNew?n.find(".num").html(e.chatNew).show():n.find(".num").hide())},renderTradeNum:function(e){var n=t("#intelligent_trade");n.length&&intelligent_trade.html('达人集市<span class="num">('+e.intelligent+")</span>")},renderShopDetailShopCart:function(e){var n=t("#shop_widget .num");n.length&&n.html(e.ccartNew)}}},o.View.init();var r=function(){this.highClassName="s1_on"};r.prototype={add2Collection:function(e){t.browser.msie&&6==t.browser.version&&t.isPlainObject(e)&&e.wrap.length&&e.target&&this._registerEvent(e)},_registerEvent:function(e){var n=this;e.wrap.on("mouseenter",e.target,function(){t(this).addClass(n.highClassName).siblings().removeClass(n.highClassName)}),e.wrap.on("mouseleave",e.target,function(){t(this).removeClass(n.highClassName)})}},(new r).add2Collection({wrap:t(".header_top"),target:".s1"})}(jQuery),function(t){function n(e,t){this.init(e,t)}function s(){function e(e){return t.trim(e).replace(/(<|>|'|"|window|alert|eval|$|jQuery)/gi,"")}h.on("keyup keydown",function(n){var i=t(this),a=t("#select_type");if(!a.length||"bao"===a.val()||"5"===a.val())switch(n.keyCode){case 40:if("keyup"==n.type||!l.data("isshow"))break;g.chooseIndex=g.chooseIndex+1>g.tipLength-1?0:++g.chooseIndex;var o=v.changeListTab(g.chooseIndex);h.val(o);break;case 38:if("keyup"==n.type||!l.data("isshow"))break;g.chooseIndex=g.chooseIndex-1<0?g.tipLength-1:--g.chooseIndex;var o=v.changeListTab(g.chooseIndex);h.val(o);break;case 13:if("keyup"==n.type)break;n.preventDefault(),s.submitBefore(g.chooseType,g.chooseIndex),d.submit();break;case 37:break;case 39:break;default:clearTimeout(c),c=setTimeout(function(){var t=e(i.val());v.resetFactory(t)},500)}}).on("focus",function(){var n=t(this),s=t("#select_type");if(c&&clearTimeout(c),!s.length||"bao"===s.val()||"5"===s.val()){var i=e(n.val());clearTimeout(c),c=setTimeout(function(){v.resetFactory(i)},300)}}).on("blur",function(){t("body").bind("click",function(e){t(e.target).parents(".seatch_type_msearch").length||(l.empty().data("isshow",!0).hide(),t("body").unbind("click"))})}),l.on("mouseenter",".search_tip li",function(){var e=t(this),n=e.index();g.chooseIndex=n,v.changeListTab(n)}).on("click",".search_tip li",function(){s.submitBefore(g.chooseType,g.chooseIndex),h.val(t(this).find(".title").text()),d.submit()}),l.on("click",".hot_list li",function(){var e=t(this);return s.submitBefore(v.hotTypeName,e.index()),h.val(e.find("span").html()),d.submit(),!1}),l.on("click",".local_del",function(){var e=t(this),n=e.parent();w.del(n.find(".title").attr("title"));var s=w.getTenItem();return v.updateLocalContent(e,s),g.chooseIndex=-1,g.tipLength=s.length,!1}).on("click",".local_title .del_all",function(){var e=t(this);return w.set(),v.destoryLocalContent(e),e.remove(),g.chooseIndex=-1,g.tipLength=0,!1}),r.on("click",".selectbox a",function(e){e.preventDefault(),v.changeType(t(this))}).on("mouseenter",".selectbox",function(){l.hide(),t(this).addClass("sele_hover")}).on("mouseleave",".selectbox",function(){t(this).removeClass("sele_hover")}),d.submit(function(){var n=t(this),i=e(h.val()),a=h.attr("def-v");if(""==i||i==a){if(""==i&&"shop"==t("#select_type").val())return!1;var o=h.data("def");h.val(o||"");var r='<input type="hidden" name="from" value="searchplacehold" id="TJ">';t("#top_nav_form").append(r),setTimeout(function(){t("#TJ").remove()},1e3)}else i==t.trim(h.val())&&"bao"==t("#select_type").val()&&w.addOne(i);if(d.find(".emptyvalue").remove(),n.data("index")>-1&&null!==n.data("type")){var c='<input type="hidden" class="emptyvalue" name="from" value="'+n.data("type")+"querytip"+n.data("index")+'">';d.append(c)}v.destoryContent(),s.submitAfter()})}var i=e,a=i.doT,o=i.store;if(a&&o){var r=t("#nav_search_form");if(r.length){var c,l=t(".top_search_hint"),h=r.find(".ts_txt"),d=t("#top_nav_form"),u=t("#select_type"),p=r.find(".selectbox"),f="/msearch/tips/item",m={nowHost:e.location.host,defultHost:"http://www.mogujie.com",template:'<div class="search_tip_box fl">{{=it.searchResult}}</div>',listItemTemp:['<div class="mr300 tip_wrap">','{{ if(it.titleName && it.titleName != ""){ }}','<h3 class="search_tip_title">{{=it.titleName}}</h3>',"{{ }else{ }}",'<h3 class="search_tip_title">搜索结果</h3>',"{{ } }}",'<ul class="search_tip">',"{{~it.items :item:index}}","{{ if(index < 10){ }}","<li>",'<a href="javascript:;" class="title" title="{{= item.title }}" >{{= item.title }}</a>','<span class="nums">约{{= item.num }}个商品</span>',"</li>","{{ } }}","{{~}}","</ul>","</div>"].join(""),localItemTemp:['<div class="mr300 tip_wrap">','<h3 class="search_tip_title local_title clearfix">',"{{ if(it.items.length){ }}",'<span class="del_all">删除</span>',"{{ } }}","历史记录","</h3>",'<ul class="search_tip">',"{{~it.items :item:index}}","{{ if(index < 10){ }}",'<li class="local_item">','<a href="javascript:;" class="title" title="{{=item}}" >{{=item}}</a>','<span class="nums local_del">x</span>',"</li>","{{ } }}","{{~}}","</ul>","</div>"].join(""),hotKeyTpl:['<div class="search_hot_wrap">','<h3 class="search_tip_title hot_title">热门关键词</h3>','<ul class="hot_list clearfix">',"{{~it.items :item:index}}","{{ if(index < 10){ }}","<li><span>{{= item.title }}</span></li>","{{ } }}","{{~}}","</ul>","</div>"].join(""),emptyTpl:['<div class="mr300 tip_wrap">','<p class="tip_none">暂无相关热门关键词</p>',"</div>"].join("")},w={keyName:"_search_local_history",keyShowName:"_search_local_history_show",maxLength:20,showLength:10,isshow:function(){return!0},abtest:function(){o.set(this.keyShowName,1)},get:function(){return o.get(this.keyName)||[]},getTenItem:function(){var e=this.get();return e.slice(0,this.showLength)},set:function(e){o.set(this.keyName,e||[])},addOne:function(e){if(e=t.trim(e),""!=e){var n=this.get(),s=t.inArray(e,n);-1==s?(n.unshift(e),n.length>this.maxLength&&n.pop()):(n.splice(s,1),n.unshift(e)),this.set(n)}},del:function(e){e=t.trim(e);var n=this.get(),s=t.inArray(e,n);s>-1&&(n.splice(s,1),this.set(n))}};n.prototype.init=function(e,t){this.chooseIndex=-1,this.chooseType=e,this.tipLength=t||0};var g=new n("undefined"),v={ajaxRequest:null,hotKeyArr:[],isShopHost:function(){return!1},resetFactory:function(e){this.isShopHost()?this.resetShopContent(e):w.isshow()?this.resetListContent(e):this.resetOldContent(e)},resetListContent:function(e){function s(e){c.push(r.renderHotContent(e)),i(function(){o()})}function i(s){r.ajaxRequest&&r.ajaxRequest.abort();var i=w.getTenItem();return""==t.trim(e)?(c.push(r.renderLocalContent(i)),g=new n(r.localTypeName,i.length),void(t.isFunction(s)&&s())):void(r.ajaxRequest=t.post(f,{input:e},function(e){if(e&&1001==e.status.code){var i=e.result.tipCount;0==i?c.push(r.renderEmptyContent()):(c.push(r.renderSearchContent(e.result.tips,e.result.nums)),g=new n(r.searchTypeName,i))}t.isFunction(s)&&s()},"json"))}function o(){var e=a.template(m.template)({searchResult:c.join("")});l.html(e),r.showContentBox()}var r=this,c=[];r.hotKeyArr.length?s(r.hotKeyArr):t.post(f,{},function(e){r.hotKeyArr=e.result.tips,s(r.hotKeyArr)},"json")},resetShopContent:function(e){function s(s){o.ajaxRequest&&o.ajaxRequest.abort(),o.ajaxRequest=t.post(f,{input:e},function(e){if(e&&1001==e.status.code){var i=e.result.tipCount;0==i?r.push(o.renderEmptyContent()):(r.push(o.renderSearchContent(e.result.tips,e.result.nums,c)),g=new n(h,i))}t.isFunction(s)&&s()},"json")}function i(){var e=a.template(m.template)({searchResult:r.join("")});l.html(e),l.find(".tip_wrap").removeClass("mr300").addClass("mr300_fix"),o.showContentBox()}var o=this,r=[],c=""!=e?"搜索结果":"热门关键词",h=""!=e?o.searchTypeName:o.hotTypeName;s(function(){i()})},resetOldContent:function(e){function s(s){o.ajaxRequest&&o.ajaxRequest.abort(),o.ajaxRequest=t.post(f,{input:e},function(e){if(e&&1001==e.status.code){var i=e.result.tipCount;0==i?r.push(o.renderEmptyContent()):(r.push(o.renderSearchContent(e.result.tips,e.result.nums,c)),g=new n(h,i))}t.isFunction(s)&&s()},"json")}function i(){var e=a.template(m.template)({searchResult:r.join("")});l.html(e),l.find(".tip_wrap").removeClass("mr300").addClass("mr300_fix"),o.showContentBox()}var o=this,r=[],c=""!=e?"搜索结果":"热门关键词",h=""!=e?o.searchTypeName:o.hotTypeName;s(function(){i()})},searchTypeName:"",renderSearchContent:function(e,t,n){for(var s=[],i=0;i<e.length;i++)s.push({title:e[i],num:t[i]});return a.template(m.listItemTemp)({titleName:n||null,items:s})},localTypeName:"local",renderLocalContent:function(e){return a.template(m.localItemTemp)({items:e})},updateLocalContent:function(e,t){var n=e.parent(),s=e.parents(".search_tip");if(n.length&&s.length)if(t.length<w.showLength)n.remove();else{var i=t[w.showLength-1];n.find(".title").attr("title",i).html(i),n.appendTo(s)}},destoryLocalContent:function(e){var t=e.parents(".tip_wrap").find(".search_tip");t.length&&t.empty()},hotTypeName:"default",renderHotContent:function(e){for(var t=[],n=0;n<e.length;n++)t.push({title:e[n]});return a.template(m.hotKeyTpl)({items:t})},renderEmptyContent:function(){return m.emptyTpl},destoryContent:function(){l.empty().hide()},getContentPosition:function(e,t){var n=t.offset(),s=e.data("fixleft"),i=e.data("fixtop");s&&(n.left+=parseInt(s)),i&&(n.top-=parseInt(i));var a=t.width()-34;e.css({left:n.left,top:n.top+t.height()+2,width:a}).addClass("hasposition")},showContentBox:function(){l.show().data("isshow",!0)},changeListTab:function(e){var t=l.find(".search_tip li"),n=t.eq(e);return t.removeClass("checked"),n.addClass("checked"),n.find(".title").text()},changeType:function(e){var t=e.parent(),n=t.attr("data-index"),s=e.text();if(u.val(n),p.find(".selected").text("搜"+s),t.siblings("li").removeClass("current"),t.addClass("current"),"shop"==n)h.val()==h.attr("def-v")&&h.val("");else if(""==h.val()){var i=h.attr("def-v");h.val(i)}4==n?"shop.mogujie.com"===m.nowHost?d.attr("action",m.defultHost+"/group/search/"):d.attr("action","/group/search/"):"shop.mogujie.com"===m.nowHost?d.attr("action",m.defultHost+"/search"):d.attr("action","/search/"),p.removeClass("sele_hover")}};s.submitBefore=function(e,t){d.data({type:e,index:t})},s.submitAfter=function(){d.removeData("type index"),g.chooseType="undefined",g.chooseIndex=-1};var _=function(){MOGU.Globe_Input_Text_Hide(h),"www.mogujie.com"===m.nowHost||p.parents(".store_header").length||d.attr("action",m.defultHost+d.attr("action")),s()};_()}}}(jQuery),function(e){var t={};t.Model={goodsList:"",goodsNum:0,getGoodsList:function(t){var n=this;return n.goodsList?void(e.isFunction(t)&&t(this.goodsList)):void e.post("/trade/cart/shoptopcart?isnew=1",{},function(s){1001==s.status.code&&(n.goodsList=s.result.html,n.goodsNum=s.result.count||0,e.isFunction(t)&&t(n.goodsList))},"json")},delGood:function(t,n){e.post("/trade/cart/delete",{stockid:t},function(t){1001==t.status.code?e.isFunction(n)&&n():alert(t.status.msg)},"json")}},t.View={wrap:e(".header_2014 .shopping_cart_v2"),init:function(){this.wrap.length&&(this.extendInfo=null,this.loading=this.wrap.find(".shopping_cart_loading"),this.maxShowNum=5,this.addEvent())},addEvent:function(){var n=this;n.wrap.on("mouseenter",function(){var s=e(this);s.addClass("sc_on"),n.loading.show(),n.extendInfo&&n.extendInfo.length?(n.loading.hide(),n.extendInfo.show()):t.Model.getGoodsList(function(t){n.extendInfo=e(t);var i=n.extendInfo.find("li");i.length>n.maxShowNum&&i.slice(n.maxShowNum,i.length).remove(),s.append(n.extendInfo),n.loading.hide(),n.extendInfo.show()})}),n.wrap.on("mouseleave",function(){n.extendInfo&&n.extendInfo.hide()&&e(this).removeClass("sc_on")}),n.wrap.on("click",".del",function(){var s=e(this),i=s.data("stockid"),a=(n.wrap.find(".num"),s.parent()),o=t.Model.goodsNum;t.Model.delGood(i,function(){o--,a.fadeOut("slow",function(){o?(a.remove(),t.Model.goodsNum=o):n.extendInfo.addClass("empty_cart").text("购物车里没有商品！")})})})}},t.View.init()}(jQuery),function(t){var n={wrap:t(".back2top_wrap"),init:function(){this.wrap.length&&(this.offsetEl=t(".wrap").length?t(".wrap").eq(0):t("#body"),this.offsetEl.length&&(this.win=t(e),this.goTop=this.wrap.find(".go_top"),this.setPos(),this.wrap.show(),this.addEvent()))},addEvent:function(){var e=this;this.win.on("resize",function(){e.setPos()}),this.win.on("scroll",function(){t(this).scrollTop()?e.goTop.addClass("show"):e.goTop.removeClass("show")}),this.goTop.on("click",function(){return e.win.scrollTop(0),!1})},setPos:function(){var e=this.offsetEl.offset(),t=this.offsetEl.outerWidth(),n=this.win.width(),s=this.wrap.width(),i=e.left+t+20;this.wrap.css(s+i>n?{left:"auto",right:10}:{left:i,right:"auto"})}};n.init()}(jQuery),function(e){if(store){var t=function(){var t="_nav_buyer_icon",n=e(".header_nav .buyer");store.get(t)||(new Date).getTime()>=Date.parse("2014-10-25 00:00:00")||(e('<i class="icon_buyer_new">new</i>').css({position:"absolute",top:"6px",right:"20px",width:"21px",height:"11px",overflow:"hidden","text-indent":"-999em",background:"url(http://s7.mogucdn.com/pic/140925/fatiao_ieydqzjrguztcmzymmytambqmmyde_21x11.png) no-repeat"}).appendTo(n),n.on("click",function(){store.set(t,!0)}))};t()}}(jQuery)}(jQuery)}(window);(function(a){MOGU.Add_To_Album_Init=function(f,g){if(MOGU.Globe_Check_Login()){var d=new MGLightBox({title:"\u52a0\u5165\u4e13\u8f91",lightBoxId:"lb_addalbum",scroll:!1,ajax:!0,isBgClickClose:!0,type:"default"});d.init();var e=f.attr("type"),h=f.attr("iid");a.ajax({url:"/album/beforeaddalbum",type:"post",timeout:6E4,data:{img_type:e,img_id:h,tid:g},dataType:"json",success:function(b){if(b==null)alert(MGLANG.msgTimeOut);else{var c=b.status.msg;b.status.code==1001?(d.buildContent(b.result.html),MOGU.WB_Word_Count("lb_addalbum",
"pub_content"),MOGU.Globe_Input_Text_Hide(a(".pub_box_op .pub_txt")),MOGU.Album_Add_To_Album(g,e,h,d)):alert(c)}},error:function(a,c){"timeout"==c&&alert(MGLANG.msgTimeout)}})}};MOGU.Album_Add_To_Album=function(f,g,d,e){a(".album_add_content .album_text").focus(function(){a("#lb_addalbum .album_add_content").removeClass("hide_content")});a("#lb_addalbum .submit").click(function(){var h=a("#lb_addalbum"),b=a("#lb_addalbum .album_text"),c=a.trim(b.val()),b=a.trim(b.attr("def-v"));c==b&&(c="");var b=
a("#lb_addalbum .choose").data("albumid"),j=a("#lb_addalbum .choose").attr("valid"),k=a("#lb_addalbum .choose").attr("validcode"),i="";a("#lb_addalbum #pub_out_check").attr("checked")=="checked"&&(i=1);c={tid:f,imgType:g,imgId:d,content:c,albumId:b,sync:i,valid:j,validcode:k};if(typeof c.albumId=="undefined"&&(b=h.find(".choose").attr("albumid"),typeof b=="undefined"))return alert("\u4f60\u8fd8\u672a\u9009\u62e9\u4e13\u8f91"),!1;c.albumId=b;a(this).hide();a(this).next().show();a.ajax({url:"/album/addajax",
type:"POST",timeout:6E4,data:c,dataType:"json",success:function(a){if(a==null)alert(MGLANG.msgTimeout);else{var b=a.status.msg;a.status.code==1001?e.success_close("\u52a0\u5165\u4e13\u8f91\u6210\u529f\uff01",600):(e.close(),alert(b))}},error:function(a,b){"timeout"==b&&alert(MGLANG.msgTimeout)}})});MOGU.Globe_Bind_Keybord_Submit(a("#lb_addalbum .album_text"),a("#lb_addalbum .submit"),"not_need_focus")}})(jQuery);
(function(c){MOGU.Message_Report_Init=function(e,d){var a=MOGUPROFILE.userid,f=new MGLightBox({title:"\u4e3e\u62a5\u4e0d\u826f\u4fe1\u606f",lightBoxId:"lb_jubao",ajax:!0,scroll:!1});f.init();c.ajax({url:"/report/getreportinfo",data:{messageid:e,type:d,userid:a},dataType:"json",type:"POST",timeout:6E4,success:function(b){if(b==null)alert(MGLANG.msgTimeout);else{var a=b.status.msg;b.status.code==1001?(b=b.result.data,f.buildContent(doT.template('<div class="lb_border"><p class="fw_root"><img src="/img/message-icon.png">\u4e0d\u826f\u4fe1\u606f\u662f\u6307\u542b\u6709\u5404\u7c7b\u5356\u5bb6\u5e97\u94fa\u3001\u5546\u54c1\u5e7f\u544a\u3001\u865a\u5047\u4e2d\u5956\u4fe1\u606f\u6216\u5176\u4ed6\u9a9a\u6270\u4f60\u6b63\u5e38\u8611\u83c7\u8857\u751f\u6d3b\u7684\u5185\u5bb9</p></div><div class="fw_pub_area"><div class="fwpa_tool">\u4f60\u8981\u4e3e\u62a5\u7684\u662f<a class="fwpa_a" href="/u/{{= it.fromId }}">@{{= it.uname }}</a>\u7684{{= it.type_text }}\uff1a</div><div class="fwpa_s"><a href="/u/{{= it.fromId }}"><img class="pic_t r3" src="{{= it.avatar }}"></a><div class="fwpa_c">{{ if(!MGTOOL.empty(it.title)){ }}<div class="fwpa_f">{{= it.title }}</div><br />{{ } }}<span >{{= it.content }}</span></div></div><div class="fwpa_p"><span>\u4e3e\u62a5\u7c7b\u578b\uff1a</span><input id="s_m" style="margin-left:3px;" type="radio" name="s" value="0" checked="checked" ><label for="s_m">\u5356\u5bb6\u5e7f\u544a\uff08\u5e97\u94fa\u3001\u5546\u54c1\uff09</label><input id="s_j" type="radio" name="s" value="1"><label for="s_j">\u865a\u5047\u4e2d\u5956\u4fe1\u606f</label><input id="s_e" type="radio" name="s" value="2"><label for="s_e">\u5176\u4ed6</label></div><div class="fwpa_ww">\u8865\u5145\u8bf4\u660e<span>(\u9009\u586b)</span>\uff1a<input class="fwpa_shu r3" type="text" name="n" ></div></div><div class="sub_div"><a href="javascript:;"  class="subreport"><img src="/img/message-button.png"></a><span class="fw_cancel">\u8bf7\u653e\u5fc3,\u6211\u4eec\u4f1a\u5c3d\u5feb\u5904\u7406\uff0c\u4f60\u7684\u9690\u79c1\u5c06\u4f1a\u5f97\u5230\u4fdd\u62a4</span></div>')(b)),
b={reportpage:d,messageId:e,reportFromId:b.toId,reportToId:b.fromId},MOGU.Globe_Bind_Keybord_Submit("",c("#lb_jubao .subreport"),"not_need_focus"),MOGU.Message_Report_Submit(f,b)):alert(a)}},error:function(b,a){"timeout"==a&&alert(MGLANG.msgTimeout)}})};MOGU.Message_Report_Submit=function(e,d){c("#lb_jubao .subreport").click(function(){var a=c("#lb_jubao .fwpa_p input[name='s']:checked").val();a==null||a==void 0?alert("\u8bf7\u9009\u62e9\u4e3e\u62a5\u7c7b\u578b"):(d.type=a,a=c("#lb_jubao .fwpa_shu").val(),
d.remark=a,c.ajax({url:"/report/subreport",data:d,dataType:"json",type:"POST",timeout:6E4,success:function(a){if(a==null)alert(MGLANG.msgTimeout);else{var b=a.status.msg;a.status.code==1001?e.success_close("\u4e3e\u62a5\u6210\u529f\uff0c\u8c22\u8c22\uff01\u7259\u7259\u4f1a\u7a0d\u5019\u5904\u7406\u3002"):alert(b)}},error:function(a,b){"timeout"==b&&alert(MGLANG.msgTimeout)}}))})}})(jQuery);
(function(a){MOGU.imgCodeCheck=function(){var t=false;var i=a(".img_code_spin");if(i.length==0){t=true;return t}for(var c=0;c<i.length;c++){var e=a(i[c]);if(e.val()!=0){t=true;break}}return t};MOGU.imgCaptchaInit=function(){var t=a(".imgcheck_image_div");var i=a("#imgcheck_code_change");var c=function(a,t){var i=-75*((t+1)%4);var c=a[0].style.backgroundPosition.split(" ");a[0].style.backgroundPosition=c[0]+" "+i+"px"};t.click(function(){var t=a(this).attr("f");var i=a("#img_code_spin_"+t);var e=parseInt(i.val());c(a(this),e);i.val(e+1)});i.click(function(){MOGU.imgCaptchaRecaptcha()})};MOGU.imgCaptchaRecaptcha=function(t){var i=function(t){var i=a(".imgcheck_image_div");var c=i.length;for(var e=0;e<c;e++){var r=i[e];var n=r.getAttribute("f");var o=a("#img_code_spin_"+n);o.val(0);var u=a(r);u.css("background-image","url(/captchaimg/"+t+")");u.css({"background-position":-75*e+"px 0"})}};if(t===undefined){a.ajax({url:"/reimgcaptcha",type:"POST",timeout:6e4,data:{},dataType:"json",cache:false,success:function(a){var t=a.status.code;var c=a.status.msg;if(t==1001){var e=a.result.data.captchaId;i(e)}},error:function(a,t,i){if("timeout"==t){alert(MGLANG.msgTimeout)}}})}else{setTimeout(function(){i(t)},1)}};MOGU.imgCaptchaInit()})(jQuery);!function(e){!function(){var t=function(t,n,o){var i=null,s={align:"left",fix:!1,later:!1};o=e.extend({},s,o||{});var a=function(t,n,o){var i=t.offset(),s=t.innerWidth(),a=t.innerHeight(),r=n.width(),l=(e(window).width(),"left"===o.align?i.left:i.left+s-r),c=i.top+a;o.fix&&(l+=o.fix.left,c+=o.fix.top),n.css({top:c,left:l}),t.addClass("hsposition")};t.on("mouseenter",function(){clearTimeout(i),t.hasClass("hsposition")||a(t,n,o),o.later?i=setTimeout(function(){n.slideDown(250)},o.later):n.slideDown(250)}).on("mouseleave",function(){clearTimeout(i),i=setTimeout(function(){n.hide()},100)}),n.on("mouseenter",function(){clearTimeout(i),n.show()}).on("mouseleave",function(){clearTimeout(i),i=setTimeout(function(){n.hide()},100)})};t(e(".info_show .uname"),e("#setting_menu"),{fix:{top:1,left:-16}}),t(e(".follow_show"),e("#follow_list"),{fix:{top:1,left:-11}}),t(e(".my_shotcuts .msg_notice"),e("#notice_menu"),{fix:{top:1,left:-16}}),t(e(".info_show .custom_help"),e("#help_down_list"),{fix:{top:1,left:2}}),t(e(".info_show .login_more_wrap"),e("#show_more_login"),{fix:{top:1,left:63}})}(),function(){function t(t){e.browser.msie&&"6.0"==e.browser.version&&!e.support.style&&this.hover(t)}t.prototype.hover=function(t){var n=e(t);n.hover(function(){e(this).addClass("on")},function(){e(this).removeClass("on")})};var n=function(){var n=e("#header .new_shopping_cart"),o=(e(".info_show .publish_btn"),!1);n.length||(n=e("#header .shoppingcard"),o=!0),o&&new t(n),n.on("mouseenter",function(){var t=e(this);o?t.find(".shopping_cart").removeClass("shoppingcard_hover"):t.addClass("new_shopping_cart_hover"),t.hasClass("isajaxed")||(!e("#shopcardfortop").size()>0&&t.append('<div id="shopcardfortop" class="emptycard" style="text-align:center;"><img src="/img/loading_alpha_32x32.gif"></div>'),jQuery.post("/trade/cart/shoptopcart",{},function(n){null==n?alert(MGLANG.msgTimeout):(1001==n.status.code&&e("#shopcardfortop").replaceWith(n.result.html),t.addClass("isajaxed"))},"json"))}).on("mouseleave",function(){var t=e(this);o?t.find(".shopping_cart").addClass("shoppingcard_hover"):t.removeClass("new_shopping_cart_hover")}).on("click",".del",function(){var t=e(this),o=e("#shopcardfortop"),i=t.data("stockid"),s=t.parents("#shopcardfortop").find("li").length,a=n.find(".num"),r=t.parent("li"),l=5;jQuery.post("/trade/cart/delete",{stockid:i},function(e){1001==e.status.code?(s--,0==s?(o.html("购物车里没有商品！").addClass("emptycard"),a.text(""+s)):l>=s?(r.fadeOut("slow",function(){r.remove(),o.find("ul").removeClass("max_height_ie6")}),o.find(".subbox .fl").hide().find(".num").text(0),a.text(""+s)):(s-=l,r.fadeOut("slow",function(){r.remove()}),o.find(".num").text(""+s),a.text(""+s))):alert(e.status.msg)},"json")})};n()}(),function(){function t(e,t){this.init(e,t)}function n(){function t(t){return e.trim(t).replace(/(<|>|'|"|window|alert|eval|$|jQuery)/gi,"")}a.on("keyup keydown",function(o){var l=e(this),c=e("#select_type");if(!c.length||"bao"===c.val()||"5"===c.val())switch(o.keyCode){case 40:if("keyup"==o.type||!s.data("isshow"))break;d.chooseIndex=d.chooseIndex+1>d.tipLength-1?0:++d.chooseIndex;var h=f.changeListTab(d.chooseIndex);a.val(h);break;case 38:if("keyup"==o.type||!s.data("isshow"))break;d.chooseIndex=d.chooseIndex-1<0?d.tipLength-1:--d.chooseIndex;var h=f.changeListTab(d.chooseIndex);a.val(h);break;case 13:if("keyup"==o.type)break;o.preventDefault(),n.submitBefore(d.chooseType,d.chooseIndex),r.submit();break;default:clearTimeout(i),i=setTimeout(function(){var e=t(l.val());f.resetFactory(e)},500)}}).on("focus",function(){var n=e(this),o=e("#select_type");if(i&&clearTimeout(i),!o.length||"bao"===o.val()||"5"===o.val()){var s=t(n.val());clearTimeout(i),i=setTimeout(function(){f.resetFactory(s)},300)}}).on("blur",function(){e("body").bind("click",function(t){e(t.target).parents(".seatch_type_msearch").length||(s.empty().data("isshow",!0).hide(),e("body").unbind("click"))})}),s.on("mouseenter",".search_tip li",function(){var t=e(this),n=t.index();d.chooseIndex=n;var o=f.changeListTab(n);a.val(o)}).on("click",".search_tip li",function(){n.submitBefore(d.chooseType,d.chooseIndex),r.submit()}),s.on("click",".hot_list li",function(){var t=e(this);if(f.resetType(),"5"==p){var o=t.find("span").data("url");window.open(o)}return"bao"==p&&(n.submitBefore(f.hotTypeName,t.index()),a.val(t.find("span").html()),r.submit()),!1}),s.on("click",".local_del",function(){var t=e(this),n=t.parent();f.resetType(),u.changeType(p),u.del(n.find(".title").attr("title"));var o=u.getTenItem();return f.updateLocalContent(t,o),d.chooseIndex=-1,d.tipLength=o.length,!1}).on("click",".local_title .del_all",function(){var t=e(this);return f.resetType(),u.changeType(p),u.set(),f.destoryLocalContent(t),t.remove(),d.chooseIndex=-1,d.tipLength=0,!1}),o.on("click",".selectbox a",function(t){t.preventDefault(),f.changeType(e(this))}).on("mouseenter",".selectbox",function(){s.hide(),e(this).addClass("hover")}).on("mouseleave",".selectbox",function(){e(this).removeClass("hover")}),r.submit(function(){var o=e(this),i=t(a.val()),s=a.attr("def-val");if(f.resetType(),""==i||i==s?a.val(e("#defult_v").val()):i==e.trim(a.val())&&(u.changeType(p),u.addOne(i)),r.find(".emptyvalue").remove(),o.data("index")>-1&&null!==o.data("type")){var l='<input type="hidden" class="emptyvalue" name="from" value="'+o.data("type")+"querytip"+o.data("index")+'">';r.append(l)}f.destoryContent(),n.submitAfter()})}e(".store_header").length&&(e(".nav_logo").remove(),e("#navigation").remove());var o=e("#top_search_form");if(o.length){var i,s=e("#seach_type"),a=o.find(".ts_txt"),r=e("#search_form"),l=e("#select_type"),c=o.find(".selectbox"),h={nowHost:window.location.host,defultHost:"http://www.mogujie.com",template:'<div class="search_tip_box fl">{{=it.searchResult}}</div>',listItemTemp:['<div class="mr300 tip_wrap">','{{ if(it.titleName && it.titleName != ""){ }}','<h3 class="search_tip_title">{{=it.titleName}}</h3>',"{{ }else{ }}",'<h3 class="search_tip_title">搜索结果</h3>',"{{ } }}",'<ul class="search_tip">',"{{~it.items :item:index}}","{{ if(index < 10){ }}","<li>",'<a href="javascript:;" class="title" title="{{= item.title }}" >{{= item.title }}</a>','<span class="nums">约{{= item.num }}个商品</span>',"</li>","{{ } }}","{{~}}","</ul>","</div>"].join(""),localItemTemp:['<div class="mr300 tip_wrap">','<h3 class="search_tip_title local_title clearfix">',"{{ if(it.items.length){ }}",'<span class="del_all">删除</span>',"{{ } }}","历史记录","</h3>",'<ul class="search_tip">',"{{~it.items :item:index}}",'<li class="local_item">','<a href="javascript:;" class="title" title="{{=item}}" >{{=item}}</a>','<span class="nums local_del">x</span>',"</li>","{{~}}","</ul>","</div>"].join(""),hotKeyTpl:['<div class="search_hot_wrap">','<h3 class="search_tip_title hot_title">热门关键词</h3>','<ul class="hot_list clearfix">',"{{~it.items :item:index}}",'<li><span data-url="{{= item.url }}">{{= item.title }}</span></li>',"{{~}}","</ul>","</div>"].join(""),emptyTpl:['<div class="mr300 tip_wrap">','<p class="tip_none">暂无相关热门关键词</p>',"</div>"].join("")},u={keyName:"",keyShowName:"_search_local_history_show",maxLength:20,showLength:10,changeType:function(e){switch(e){case"bao":this.keyName="_search_local_history";break;case"5":this.keyName="_magic_search_local_history";break;default:return!1}return!0},isshow:function(){MGTOOL.getCookie("__mgjuuid");return!0},abtest:function(){store.set(this.keyShowName,1)},get:function(){return store.get(this.keyName)||[]},getTenItem:function(){var e=this.get();return e.slice(0,this.showLength)},set:function(e){store.set(this.keyName,e||[])},addOne:function(t){if(t=e.trim(t),""!=t){var n=this.get(),o=e.inArray(t,n);-1==o?(n.unshift(t),n.length>this.maxLength&&n.pop()):(n.splice(o,1),n.unshift(t)),this.set(n)}},del:function(t){t=e.trim(t);var n=this.get(),o=e.inArray(t,n);o>-1&&(n.splice(o,1),this.set(n))}};t.prototype.init=function(e,t){this.chooseIndex=-1,this.chooseType=e,this.tipLength=t||0};var p,d=new t("undefined"),f={ajaxRequest:null,hotKeyArr:[],magicHotKeyArr:[],resetType:function(){p=e("#select_type").val()},isShopHost:function(){var e=location.href;return"http://shop.mogujie.com/"==e||e.indexOf("www.mogujie")>-1?!1:e.indexOf("http://shop.mogujie.com/detail/")>-1?!1:!0},resetFactory:function(e){this.resetType(),this.isShopHost()?this.resetShopContent(e):u.isshow()?u.isshow()&&this.resetListContent.init(e,p):this.resetOldContent(e)},resetListContent:{listWigets:[],value:"",nowtypeval:"",init:function(e,t){var n=this;switch(n.nowtypeval=t,n.listWigets=[],t){case"bao":n.value=e,n.ajaxHot("/msearch/tips/item",f.hotKeyArr,"bao");break;case"5":n.value="",n.ajaxHot("/magic/search/ajaxhotwords",f.magicHotKeyArr,"5");break;default:return!1}return!0},ajaxHot:function(t,n,o){var i=this;n.length?i.__renderHot(n):e.post(t,{},function(e){"bao"==o&&(f.hotKeyArr=e.result.tips,f.hotKeyArr=f.hotKeyArr.slice(0,10),i.__renderHot(f.hotKeyArr)),"5"==o&&(f.magicHotKeyArr=e.result.tips,i.__renderHot(f.magicHotKeyArr))},"json")},__renderHot:function(e){var t=this;t.listWigets.push(f.renderHotContent(e)),t.__renderLeft(function(){t.__allRender()})},__renderLeft:function(n){var o=this;u.changeType(o.nowtypeval),o.ajaxRequest&&o.ajaxRequest.abort();var i=u.getTenItem();return""==e.trim(o.value)?(o.listWigets.push(f.renderLocalContent(i)),d=new t(f.localTypeName,i.length),void(e.isFunction(n)&&n())):void("bao"==p&&(o.ajaxRequest=e.post("/msearch/tips/item",{input:o.value},function(i){if(i&&1001==i.status.code){var s=i.result.tipCount;0==s?o.listWigets.push(f.renderEmptyContent()):(o.listWigets.push(f.renderSearchContent(i.result.tips,i.result.nums)),d=new t(f.searchTypeName,s))}e.isFunction(n)&&n()},"json")))},__allRender:function(){var e=this,t=doT.template(h.template)({searchResult:e.listWigets.join("")});s.html(t),f.showContentBox(s,o)}},resetShopContent:function(n){function i(o){r.ajaxRequest&&r.ajaxRequest.abort(),r.ajaxRequest=e.post("/msearch/tips/item",{input:n},function(n){if(n&&1001==n.status.code){var i=n.result.tipCount;0==i?l.push(r.renderEmptyContent()):(l.push(r.renderSearchContent(n.result.tips,n.result.nums,c)),d=new t(u,i))}e.isFunction(o)&&o()},"json")}function a(){var e=doT.template(h.template)({searchResult:l.join("")});s.html(e),s.find(".tip_wrap").removeClass("mr300").addClass("mr300_fix"),r.showContentBox(s,o)}var r=this,l=[],c=""!=n?"搜索结果":"热门关键词",u=""!=n?r.searchTypeName:r.hotTypeName;i(function(){a()})},resetOldContent:function(n){function i(o){r.ajaxRequest&&r.ajaxRequest.abort(),r.ajaxRequest=e.post("/msearch/tips/item",{input:n},function(n){if(n&&1001==n.status.code){var i=n.result.tipCount;0==i?l.push(r.renderEmptyContent()):(l.push(r.renderSearchContent(n.result.tips,n.result.nums,c)),d=new t(u,i))}e.isFunction(o)&&o()},"json")}function a(){var e=doT.template(h.template)({searchResult:l.join("")});s.html(e),s.find(".tip_wrap").removeClass("mr300").addClass("mr300_fix"),r.showContentBox(s,o)}var r=this,l=[],c=""!=n?"搜索结果":"热门关键词",u=""!=n?r.searchTypeName:r.hotTypeName;i(function(){a()})},searchTypeName:"",renderSearchContent:function(e,t,n){for(var o=[],i=0;i<e.length;i++)o.push({title:e[i],num:t[i]});return doT.template(h.listItemTemp)({titleName:n||null,items:o})},localTypeName:"local",renderLocalContent:function(e){return doT.template(h.localItemTemp)({items:e})},updateLocalContent:function(e,t){var n=e.parent(),o=e.parents(".search_tip");if(this.resetType(),n.length&&o.length)if(u.changeType(p),t.length<u.showLength)n.remove();else{var i=t[u.showLength-1];n.find(".title").attr("title",i).html(i),n.appendTo(o)}},destoryLocalContent:function(e){var t=e.parents(".tip_wrap").find(".search_tip");t.length&&t.empty()},hotTypeName:"default",renderHotContent:function(e){for(var t=[],n=0;n<e.length;n++)t.push({title:e[n].keyword?e[n].keyword:e[n],url:e[n].url?e[n].url:""});return doT.template(h.hotKeyTpl)({items:t})},renderEmptyContent:function(){return h.emptyTpl},destoryContent:function(){s.empty().hide()},getContentPosition:function(e,t){var n=t.offset(),o=e.data("fixleft"),i=e.data("fixtop");o&&(n.left+=parseInt(o)),i&&(n.top-=parseInt(i));var s=t.width();e.css({left:n.left,top:n.top+t.height()+2,width:s}).addClass("hasposition")},showContentBox:function(e,t){t.hasClass("hasposition")||this.getContentPosition(e,t),e.show().data("isshow",!0)},changeListTab:function(e){var t=s.find(".search_tip li"),n=t.eq(e);return t.removeClass("checked"),n.addClass("checked"),n.find(".title").text()},changeType:function(e){var t=e.parent(),n=t.attr("data-index"),o=e.text();l.val(n),c.find(".selected").text("搜"+o),t.siblings("li").removeClass("current"),t.addClass("current"),4==n?"shop.mogujie.com"===h.nowHost?r.attr("action",h.defultHost+"/group/search/"):r.attr("action","/group/search/"):"shop.mogujie.com"===h.nowHost?r.attr("action",h.defultHost+"/search"):r.attr("action","/search/"),c.removeClass("hover")}};n.submitBefore=function(e,t){r.data({type:e,index:t})},n.submitAfter=function(){r.removeData("type index"),d.chooseType="undefined",d.chooseIndex=-1};var m=function(){MOGU.Globe_Input_Text(a,e.trim(a.attr("def-val"))),"www.mogujie.com"===h.nowHost||c.parents(".store_header").length||r.attr("action",h.defultHost+r.attr("action")),n()};m()}}(),function(){0===e("#add_follow_frames").size()&&e("#follow_menu").append(['<li id="add_follow_frames">','<iframe width="136" height="26" frameborder="0" allowtransparency="true" marginwidth="0" marginheight="0" scrolling="no" border="0" src="http://widget.weibo.com/relationship/followbutton.php?language=zh_cn&width=136&height=24&uid=1879044834&style=2&btn=light&dpc=1"></iframe>',"</li>","<li>",'<iframe src="http://open.qzone.qq.com/like?url=http%3A%2F%2Fuser.qzone.qq.com%2F1927997462&type=button_num&width=400&height=30&style=2" allowtransparency="true" scrolling="no" border="0" frameborder="0" style="width:400px;height:26px;border:none;overflow:hidden;"></iframe>',"</li>","<li>",'<iframe src="http://follow.v.t.qq.com/index.php?c=follow&a=quick&name=mogujiewei&style=5&t=1333261751927&f=1" frameborder="0" scrolling="auto" width="150" height="24" marginwidth="0" marginheight="0" allowtransparency="true"></iframe>',"</li>"].join("")),e(".globe_publish").on("click",function(){var e=("1"==MOGUPROFILE.is_subsite?"上传美图":"上传我的搭配晒货等美图",""),t={title:"我要分享",lightBoxId:"lb_publish_box",scroll:!1,contentHtml:e,isBgClickClose:!1,type:"default"},n=new MGLightBox(t);n.init(),MOGU.Publish_Goods_Init(n)}),e(".globe_publish_img").click(function(){MOGU.Publish_Pub_Box_Init_Daren()})}()}(jQuery),function(e){function t(){return(new Date).getTime()}var n=e(".mobile_bind_hint"),o=t(),i="isMobileBind_"+MGTOOL.getCookie("__mgjuuid");n.length&&e(".nav_logo:visible").length&&e("#navigation:visible").length&&!(o-(parseInt(store.get(i))||0)<=2592e6)&&(150!=parseInt(e("#header").css("height"))||10!=parseInt(e("#header").css("margin-bottom"))||parseInt(e("#body_wrap").css("margin-top"))<0||parseInt(e("#body").css("margin-top"))<0||(n.show(),n.on("click",".m_close",function(){return store.set(i,o),n.remove(),!1})))}(jQuery),function(e){function t(){return(new Date).getTime()}var n=e(".not_pay_hint"),o=t(),i="isPayBind_"+MGTOOL.getCookie("__mgjuuid");n.length&&e(".nav_logo:visible").length&&e("#navigation:visible").length&&!(o-(parseInt(store.get(i))||0)<=864e5)&&(150!=parseInt(e("#header").css("height"))||10!=parseInt(e("#header").css("margin-bottom"))||parseInt(e("#body_wrap").css("margin-top"))<0||parseInt(e("#body").css("margin-top"))<0||(n.show(),n.on("click",".m_close",function(){return store.set(i,o),n.remove(),!1})))}(jQuery),function(e){e("#notice_menu").on("click",".mogutalk_btn",function(){MOGU.Globe_Trace_Log("nav,notice_slide,click")})}(jQuery),function(e){var t=e(".info_show .modou");if(t.length){var n=t.find(".m"),o=t.find(".modou_tip");e.post("/modou/balance",{},function(e){{var t=e.status.code;e.status.msg}1001==t&&e.result>0&&n.addClass("h").append("("+e.result+")")},"json"),e.browser.msie&&6==e.browser.version&&t.hover(function(){o.show()},function(){o.hide()})}}(jQuery),function(e){function t(){i.css("display","inline")}function n(){i.css("display","none")}var o=e(".J_code"),i=o.find(".code");o.on("mouseenter",t),o.on("mouseleave",n)}(jQuery);!function(){"use strict";function r(r,t,e,n){function o(r,t){return r-=n,t-=n,0>r||r>=a||0>t||t>=a?!1:i.isDark(r,t)}var i=y(e,t);i.addData(r),i.make(),n=n||0;var a=i.getModuleCount(),u=i.getModuleCount()+2*n,f=function(r,t,e,n){var o=this.isDark,i=1/u;this.isDark=function(a,u){var f=u*i,l=a*i,c=f+i,g=l+i;return o(a,u)&&(r>c||f>e||t>g||l>n)}};this.text=r,this.level=t,this.version=e,this.moduleCount=u,this.isDark=o,this.addBlank=f}function t(t,e,n,o,i){n=Math.max(1,n||1),o=Math.min(40,o||40);for(var a=n;o>=a;a+=1)try{return new r(t,e,a,i)}catch(u){}}function e(r,t,e){var n=e.size,o="bold "+e.mSize*n+"px "+e.fontname,i=d("<canvas/>")[0].getContext("2d");i.font=o;var a=i.measureText(e.label).width,u=e.mSize,f=a/n,l=(1-f)*e.mPosX,c=(1-u)*e.mPosY,g=l+f,s=c+u,h=.01;1===e.mode?r.addBlank(0,c-h,n,s+h):r.addBlank(l-h,c-h,g+h,s+h),t.fillStyle=e.fontcolor,t.font=o,t.fillText(e.label,l*n,c*n+.75*e.mSize*n)}function n(r,t,e){var n=e.size,o=e.image.naturalWidth||1,i=e.image.naturalHeight||1,a=e.mSize,u=a*o/i,f=(1-u)*e.mPosX,l=(1-a)*e.mPosY,c=f+u,g=l+a,s=.01;3===e.mode?r.addBlank(0,l-s,n,g+s):r.addBlank(f-s,l-s,c+s,g+s),t.drawImage(e.image,f*n,l*n,u*n,a*n)}function o(r,t,o){d(o.background).is("img")?t.drawImage(o.background,0,0,o.size,o.size):o.background&&(t.fillStyle=o.background,t.fillRect(o.left,o.top,o.size,o.size));var i=o.mode;1===i||2===i?e(r,t,o):(3===i||4===i)&&n(r,t,o)}function i(r,t,e,n,o,i,a,u){r.isDark(a,u)&&t.rect(n,o,i,i)}function a(r,t,e,n,o,i,a,u,f,l){a?r.moveTo(t+i,e):r.moveTo(t,e),u?(r.lineTo(n-i,e),r.arcTo(n,e,n,o,i)):r.lineTo(n,e),f?(r.lineTo(n,o-i),r.arcTo(n,o,t,o,i)):r.lineTo(n,o),l?(r.lineTo(t+i,o),r.arcTo(t,o,t,e,i)):r.lineTo(t,o),a?(r.lineTo(t,e+i),r.arcTo(t,e,n,e,i)):r.lineTo(t,e)}function u(r,t,e,n,o,i,a,u,f,l){a&&(r.moveTo(t+i,e),r.lineTo(t,e),r.lineTo(t,e+i),r.arcTo(t,e,t+i,e,i)),u&&(r.moveTo(n-i,e),r.lineTo(n,e),r.lineTo(n,e+i),r.arcTo(n,e,n-i,e,i)),f&&(r.moveTo(n-i,o),r.lineTo(n,o),r.lineTo(n,o-i),r.arcTo(n,o,n-i,o,i)),l&&(r.moveTo(t+i,o),r.lineTo(t,o),r.lineTo(t,o-i),r.arcTo(t,o,t+i,o,i))}function f(r,t,e,n,o,i,f,l){var c=r.isDark,g=n+i,s=o+i,h=e.radius*i,v=f-1,d=f+1,w=l-1,m=l+1,T=c(f,l),y=c(v,w),p=c(v,l),B=c(v,m),E=c(f,m),k=c(d,m),A=c(d,l),M=c(d,w),D=c(f,w);T?a(t,n,o,g,s,h,!p&&!D,!p&&!E,!A&&!E,!A&&!D):u(t,n,o,g,s,h,p&&D&&y,p&&E&&B,A&&E&&k,A&&D&&M)}function l(r,t,e){var n,o,a=r.moduleCount,u=e.size/a,l=i;for(m&&e.radius>0&&e.radius<=.5&&(l=f),t.beginPath(),n=0;a>n;n+=1)for(o=0;a>o;o+=1){var c=e.left+o*u,g=e.top+n*u,s=u;l(r,t,e,c,g,s,n,o)}if(d(e.fill).is("img")){t.strokeStyle="rgba(0,0,0,0.5)",t.lineWidth=2,t.stroke();var h=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",t.fill(),t.globalCompositeOperation=h,t.clip(),t.drawImage(e.fill,0,0,e.size,e.size),t.restore()}else t.fillStyle=e.fill,t.fill()}function c(r,e){var n=t(e.text,e.ecLevel,e.minVersion,e.maxVersion,e.quiet);if(!n)return null;var i=d(r).data("qrcode",n),a=i[0].getContext("2d");return o(n,a,e),l(n,a,e),i}function g(r){var t=d("<canvas/>").attr("width",r.size).attr("height",r.size);return c(t,r)}function s(r){return d("<img/>").attr("src",g(r)[0].toDataURL("image/png"))}function h(r){var e=t(r.text,r.ecLevel,r.minVersion,r.maxVersion,r.quiet);if(!e)return null;var n,o,i=r.size,a=r.background,u=Math.floor,f=e.moduleCount,l=u(i/f),c=u(.5*(i-l*f)),g={position:"relative",left:0,top:0,padding:0,margin:0,width:i,height:i},s={position:"absolute",padding:0,margin:0,width:l,height:l,"background-color":r.fill},h=d("<div/>").data("qrcode",e).css(g);for(a&&h.css("background-color",a),n=0;f>n;n+=1)for(o=0;f>o;o+=1)e.isDark(n,o)&&d("<div/>").css(s).css({left:c+o*l,top:c+n*l}).appendTo(h);return h}function v(r){return w&&"canvas"===r.render?g(r):w&&"image"===r.render?s(r):h(r)}var d=jQuery,w=function(){var r=document.createElement("canvas");return!(!r.getContext||!r.getContext("2d"))}(),m="[object Opera]"!==Object.prototype.toString.call(window.opera),T={render:"canvas",minVersion:1,maxVersion:40,ecLevel:"L",left:0,top:0,size:200,fill:"#000",background:null,text:"no text",radius:0,quiet:0,mode:0,mSize:.1,mPosX:.5,mPosY:.5,label:"no label",fontname:"sans",fontcolor:"#000",image:null};d.fn.qrcode=function(r){var t=d.extend({},T,r);return this.each(function(){"canvas"===this.nodeName.toLowerCase()?c(this,t):d(this).append(v(t))})};var y=function(){function r(t,e){if("undefined"==typeof t.length)throw new Error(t.length+"/"+e);var n=function(){for(var r=0;r<t.length&&0==t[r];)r+=1;for(var n=new Array(t.length-r+e),o=0;o<t.length-r;o+=1)n[o]=t[o+r];return n}(),o={};return o.get=function(r){return n[r]},o.getLength=function(){return n.length},o.multiply=function(t){for(var e=new Array(o.getLength()+t.getLength()-1),n=0;n<o.getLength();n+=1)for(var i=0;i<t.getLength();i+=1)e[n+i]^=a.gexp(a.glog(o.get(n))+a.glog(t.get(i)));return r(e,0)},o.mod=function(t){if(o.getLength()-t.getLength()<0)return o;for(var e=a.glog(o.get(0))-a.glog(t.get(0)),n=new Array(o.getLength()),i=0;i<o.getLength();i+=1)n[i]=o.get(i);for(var i=0;i<t.getLength();i+=1)n[i]^=a.gexp(a.glog(t.get(i))+e);return r(n,0).mod(t)},o}var t=function(t,e){var o=236,a=17,c=t,g=n[e],s=null,h=0,d=null,w=new Array,m={},T=function(r,t){h=4*c+17,s=function(r){for(var t=new Array(r),e=0;r>e;e+=1){t[e]=new Array(r);for(var n=0;r>n;n+=1)t[e][n]=null}return t}(h),y(0,0),y(h-7,0),y(0,h-7),E(),B(),A(r,t),c>=7&&k(r),null==d&&(d=C(c,g,w)),M(d,t)},y=function(r,t){for(var e=-1;7>=e;e+=1)if(!(-1>=r+e||r+e>=h))for(var n=-1;7>=n;n+=1)-1>=t+n||t+n>=h||(s[r+e][t+n]=e>=0&&6>=e&&(0==n||6==n)||n>=0&&6>=n&&(0==e||6==e)||e>=2&&4>=e&&n>=2&&4>=n?!0:!1)},p=function(){for(var r=0,t=0,e=0;8>e;e+=1){T(!0,e);var n=i.getLostPoint(m);(0==e||r>n)&&(r=n,t=e)}return t},B=function(){for(var r=8;h-8>r;r+=1)null==s[r][6]&&(s[r][6]=r%2==0);for(var t=8;h-8>t;t+=1)null==s[6][t]&&(s[6][t]=t%2==0)},E=function(){for(var r=i.getPatternPosition(c),t=0;t<r.length;t+=1)for(var e=0;e<r.length;e+=1){var n=r[t],o=r[e];if(null==s[n][o])for(var a=-2;2>=a;a+=1)for(var u=-2;2>=u;u+=1)s[n+a][o+u]=-2==a||2==a||-2==u||2==u||0==a&&0==u?!0:!1}},k=function(r){for(var t=i.getBCHTypeNumber(c),e=0;18>e;e+=1){var n=!r&&1==(t>>e&1);s[Math.floor(e/3)][e%3+h-8-3]=n}for(var e=0;18>e;e+=1){var n=!r&&1==(t>>e&1);s[e%3+h-8-3][Math.floor(e/3)]=n}},A=function(r,t){for(var e=g<<3|t,n=i.getBCHTypeInfo(e),o=0;15>o;o+=1){var a=!r&&1==(n>>o&1);6>o?s[o][8]=a:8>o?s[o+1][8]=a:s[h-15+o][8]=a}for(var o=0;15>o;o+=1){var a=!r&&1==(n>>o&1);8>o?s[8][h-o-1]=a:9>o?s[8][15-o-1+1]=a:s[8][15-o-1]=a}s[h-8][8]=!r},M=function(r,t){for(var e=-1,n=h-1,o=7,a=0,u=i.getMaskFunction(t),f=h-1;f>0;f-=2)for(6==f&&(f-=1);;){for(var l=0;2>l;l+=1)if(null==s[n][f-l]){var c=!1;a<r.length&&(c=1==(r[a]>>>o&1));var g=u(n,f-l);g&&(c=!c),s[n][f-l]=c,o-=1,-1==o&&(a+=1,o=7)}if(n+=e,0>n||n>=h){n-=e,e=-e;break}}},D=function(t,e){for(var n=0,o=0,a=0,u=new Array(e.length),f=new Array(e.length),l=0;l<e.length;l+=1){var c=e[l].dataCount,g=e[l].totalCount-c;o=Math.max(o,c),a=Math.max(a,g),u[l]=new Array(c);for(var s=0;s<u[l].length;s+=1)u[l][s]=255&t.getBuffer()[s+n];n+=c;var h=i.getErrorCorrectPolynomial(g),v=r(u[l],h.getLength()-1),d=v.mod(h);f[l]=new Array(h.getLength()-1);for(var s=0;s<f[l].length;s+=1){var w=s+d.getLength()-f[l].length;f[l][s]=w>=0?d.get(w):0}}for(var m=0,s=0;s<e.length;s+=1)m+=e[s].totalCount;for(var T=new Array(m),y=0,s=0;o>s;s+=1)for(var l=0;l<e.length;l+=1)s<u[l].length&&(T[y]=u[l][s],y+=1);for(var s=0;a>s;s+=1)for(var l=0;l<e.length;l+=1)s<f[l].length&&(T[y]=f[l][s],y+=1);return T},C=function(r,t,e){for(var n=u.getRSBlocks(r,t),l=f(),c=0;c<e.length;c+=1){var g=e[c];l.put(g.getMode(),4),l.put(g.getLength(),i.getLengthInBits(g.getMode(),r)),g.write(l)}for(var s=0,c=0;c<n.length;c+=1)s+=n[c].dataCount;if(l.getLengthInBits()>8*s)throw new Error("code length overflow. ("+l.getLengthInBits()+">"+8*s+")");for(l.getLengthInBits()+4<=8*s&&l.put(0,4);l.getLengthInBits()%8!=0;)l.putBit(!1);for(;;){if(l.getLengthInBits()>=8*s)break;if(l.put(o,8),l.getLengthInBits()>=8*s)break;l.put(a,8)}return D(l,n)};return m.addData=function(r){var t=l(r);w.push(t),d=null},m.isDark=function(r,t){if(0>r||r>=h||0>t||t>=h)throw new Error(r+","+t);return s[r][t]},m.getModuleCount=function(){return h},m.make=function(){T(!1,p())},m.createTableTag=function(r,t){r=r||2,t="undefined"==typeof t?4*r:t;var e="";e+='<table style="',e+=" border-width: 0px; border-style: none;",e+=" border-collapse: collapse;",e+=" padding: 0px; margin: "+t+"px;",e+='">',e+="<tbody>";for(var n=0;n<m.getModuleCount();n+=1){e+="<tr>";for(var o=0;o<m.getModuleCount();o+=1)e+='<td style="',e+=" border-width: 0px; border-style: none;",e+=" border-collapse: collapse;",e+=" padding: 0px; margin: 0px;",e+=" width: "+r+"px;",e+=" height: "+r+"px;",e+=" background-color: ",e+=m.isDark(n,o)?"#000000":"#ffffff",e+=";",e+='"/>';e+="</tr>"}return e+="</tbody>",e+="</table>"},m.createImgTag=function(r,t){r=r||2,t="undefined"==typeof t?4*r:t;var e=m.getModuleCount()*r+2*t,n=t,o=e-t;return v(e,e,function(t,e){if(t>=n&&o>t&&e>=n&&o>e){var i=Math.floor((t-n)/r),a=Math.floor((e-n)/r);return m.isDark(a,i)?0:1}return 1})},m};t.stringToBytes=function(r){for(var t=new Array,e=0;e<r.length;e+=1){var n=r.charCodeAt(e);t.push(255&n)}return t},t.createStringToBytes=function(r,t){var e=function(){for(var e=s(r),n=function(){var r=e.read();if(-1==r)throw new Error;return r},o=0,i={};;){var a=e.read();if(-1==a)break;var u=n(),f=n(),l=n(),c=String.fromCharCode(a<<8|u),g=f<<8|l;i[c]=g,o+=1}if(o!=t)throw new Error(o+" != "+t);return i}(),n="?".charCodeAt(0);return function(r){for(var t=new Array,o=0;o<r.length;o+=1){var i=r.charCodeAt(o);if(128>i)t.push(i);else{var a=e[r.charAt(o)];"number"==typeof a?(255&a)==a?t.push(a):(t.push(a>>>8),t.push(255&a)):t.push(n)}}return t}};var e={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},n={L:1,M:0,Q:3,H:2},o={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i=function(){var t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,i=7973,u=21522,f={},l=function(r){for(var t=0;0!=r;)t+=1,r>>>=1;return t};return f.getBCHTypeInfo=function(r){for(var t=r<<10;l(t)-l(n)>=0;)t^=n<<l(t)-l(n);return(r<<10|t)^u},f.getBCHTypeNumber=function(r){for(var t=r<<12;l(t)-l(i)>=0;)t^=i<<l(t)-l(i);return r<<12|t},f.getPatternPosition=function(r){return t[r-1]},f.getMaskFunction=function(r){switch(r){case o.PATTERN000:return function(r,t){return(r+t)%2==0};case o.PATTERN001:return function(r){return r%2==0};case o.PATTERN010:return function(r,t){return t%3==0};case o.PATTERN011:return function(r,t){return(r+t)%3==0};case o.PATTERN100:return function(r,t){return(Math.floor(r/2)+Math.floor(t/3))%2==0};case o.PATTERN101:return function(r,t){return r*t%2+r*t%3==0};case o.PATTERN110:return function(r,t){return(r*t%2+r*t%3)%2==0};case o.PATTERN111:return function(r,t){return(r*t%3+(r+t)%2)%2==0};default:throw new Error("bad maskPattern:"+r)}},f.getErrorCorrectPolynomial=function(t){for(var e=r([1],0),n=0;t>n;n+=1)e=e.multiply(r([1,a.gexp(n)],0));return e},f.getLengthInBits=function(r,t){if(t>=1&&10>t)switch(r){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:return 8;case e.MODE_KANJI:return 8;default:throw new Error("mode:"+r)}else if(27>t)switch(r){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw new Error("mode:"+r)}else{if(!(41>t))throw new Error("type:"+t);switch(r){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw new Error("mode:"+r)}}},f.getLostPoint=function(r){for(var t=r.getModuleCount(),e=0,n=0;t>n;n+=1)for(var o=0;t>o;o+=1){for(var i=0,a=r.isDark(n,o),u=-1;1>=u;u+=1)if(!(0>n+u||n+u>=t))for(var f=-1;1>=f;f+=1)0>o+f||o+f>=t||(0!=u||0!=f)&&a==r.isDark(n+u,o+f)&&(i+=1);i>5&&(e+=3+i-5)}for(var n=0;t-1>n;n+=1)for(var o=0;t-1>o;o+=1){var l=0;r.isDark(n,o)&&(l+=1),r.isDark(n+1,o)&&(l+=1),r.isDark(n,o+1)&&(l+=1),r.isDark(n+1,o+1)&&(l+=1),(0==l||4==l)&&(e+=3)}for(var n=0;t>n;n+=1)for(var o=0;t-6>o;o+=1)r.isDark(n,o)&&!r.isDark(n,o+1)&&r.isDark(n,o+2)&&r.isDark(n,o+3)&&r.isDark(n,o+4)&&!r.isDark(n,o+5)&&r.isDark(n,o+6)&&(e+=40);for(var o=0;t>o;o+=1)for(var n=0;t-6>n;n+=1)r.isDark(n,o)&&!r.isDark(n+1,o)&&r.isDark(n+2,o)&&r.isDark(n+3,o)&&r.isDark(n+4,o)&&!r.isDark(n+5,o)&&r.isDark(n+6,o)&&(e+=40);for(var c=0,o=0;t>o;o+=1)for(var n=0;t>n;n+=1)r.isDark(n,o)&&(c+=1);var g=Math.abs(100*c/t/t-50)/5;return e+=10*g},f}(),a=function(){for(var r=new Array(256),t=new Array(256),e=0;8>e;e+=1)r[e]=1<<e;for(var e=8;256>e;e+=1)r[e]=r[e-4]^r[e-5]^r[e-6]^r[e-8];for(var e=0;255>e;e+=1)t[r[e]]=e;var n={};return n.glog=function(r){if(1>r)throw new Error("glog("+r+")");return t[r]},n.gexp=function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return r[t]},n}(),u=function(){var r=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t=function(r,t){var e={};return e.totalCount=r,e.dataCount=t,e},e={},o=function(t,e){switch(e){case n.L:return r[4*(t-1)+0];case n.M:return r[4*(t-1)+1];case n.Q:return r[4*(t-1)+2];case n.H:return r[4*(t-1)+3];default:return void 0}};return e.getRSBlocks=function(r,e){var n=o(r,e);if("undefined"==typeof n)throw new Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+e);for(var i=n.length/3,a=new Array,u=0;i>u;u+=1)for(var f=n[3*u+0],l=n[3*u+1],c=n[3*u+2],g=0;f>g;g+=1)a.push(t(l,c));return a},e}(),f=function(){var r=new Array,t=0,e={};return e.getBuffer=function(){return r},e.get=function(t){var e=Math.floor(t/8);return 1==(r[e]>>>7-t%8&1)},e.put=function(r,t){for(var n=0;t>n;n+=1)e.putBit(1==(r>>>t-n-1&1))},e.getLengthInBits=function(){return t},e.putBit=function(e){var n=Math.floor(t/8);r.length<=n&&r.push(0),e&&(r[n]|=128>>>t%8),t+=1},e},l=function(r){var n=e.MODE_8BIT_BYTE,o=t.stringToBytes(r),i={};return i.getMode=function(){return n},i.getLength=function(){return o.length},i.write=function(r){for(var t=0;t<o.length;t+=1)r.put(o[t],8)},i},c=function(){var r=new Array,t={};return t.writeByte=function(t){r.push(255&t)},t.writeShort=function(r){t.writeByte(r),t.writeByte(r>>>8)},t.writeBytes=function(r,e,n){e=e||0,n=n||r.length;for(var o=0;n>o;o+=1)t.writeByte(r[o+e])},t.writeString=function(r){for(var e=0;e<r.length;e+=1)t.writeByte(r.charCodeAt(e))},t.toByteArray=function(){return r},t.toString=function(){var t="";t+="[";for(var e=0;e<r.length;e+=1)e>0&&(t+=","),t+=r[e];return t+="]"},t},g=function(){var r=0,t=0,e=0,n="",o={},i=function(r){n+=String.fromCharCode(a(63&r))},a=function(r){if(0>r);else{if(26>r)return 65+r;if(52>r)return 97+(r-26);if(62>r)return 48+(r-52);if(62==r)return 43;if(63==r)return 47}throw new Error("n:"+r)};return o.writeByte=function(n){for(r=r<<8|255&n,t+=8,e+=1;t>=6;)i(r>>>t-6),t-=6},o.flush=function(){if(t>0&&(i(r<<6-t),r=0,t=0),e%3!=0)for(var o=3-e%3,a=0;o>a;a+=1)n+="="},o.toString=function(){return n},o},s=function(r){var t=r,e=0,n=0,o=0,i={};i.read=function(){for(;8>o;){if(e>=t.length){if(0==o)return-1;throw new Error("unexpected end of file./"+o)}var r=t.charAt(e);if(e+=1,"="==r)return o=0,-1;r.match(/^\s$/)||(n=n<<6|a(r.charCodeAt(0)),o+=6)}var i=n>>>o-8&255;return o-=8,i};var a=function(r){if(r>=65&&90>=r)return r-65;if(r>=97&&122>=r)return r-97+26;if(r>=48&&57>=r)return r-48+52;if(43==r)return 62;if(47==r)return 63;throw new Error("c:"+r)};return i},h=function(r,t){var e=r,n=t,o=new Array(r*t),i={};i.setPixel=function(r,t,n){o[t*e+r]=n},i.write=function(r){r.writeString("GIF87a"),r.writeShort(e),r.writeShort(n),r.writeByte(128),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(255),r.writeByte(255),r.writeByte(255),r.writeString(","),r.writeShort(0),r.writeShort(0),r.writeShort(e),r.writeShort(n),r.writeByte(0);var t=2,o=u(t);r.writeByte(t);for(var i=0;o.length-i>255;)r.writeByte(255),r.writeBytes(o,i,255),i+=255;r.writeByte(o.length-i),r.writeBytes(o,i,o.length-i),r.writeByte(0),r.writeString(";")};var a=function(r){var t=r,e=0,n=0,o={};return o.write=function(r,o){if(r>>>o!=0)throw new Error("length over");for(;e+o>=8;)t.writeByte(255&(r<<e|n)),o-=8-e,r>>>=8-e,n=0,e=0;n=r<<e|n,e+=o},o.flush=function(){e>0&&t.writeByte(n)},o},u=function(r){for(var t=1<<r,e=(1<<r)+1,n=r+1,i=f(),u=0;t>u;u+=1)i.add(String.fromCharCode(u));i.add(String.fromCharCode(t)),i.add(String.fromCharCode(e));var l=c(),g=a(l);g.write(t,n);var s=0,h=String.fromCharCode(o[s]);for(s+=1;s<o.length;){var v=String.fromCharCode(o[s]);s+=1,i.contains(h+v)?h+=v:(g.write(i.indexOf(h),n),i.size()<4095&&(i.size()==1<<n&&(n+=1),i.add(h+v)),h=v)}return g.write(i.indexOf(h),n),g.write(e,n),g.flush(),l.toByteArray()},f=function(){var r={},t=0,e={};return e.add=function(n){if(e.contains(n))throw new Error("dup key:"+n);r[n]=t,t+=1},e.size=function(){return t},e.indexOf=function(t){return r[t]},e.contains=function(t){return"undefined"!=typeof r[t]},e};return i},v=function(r,t,e,n){for(var o=h(r,t),i=0;t>i;i+=1)for(var a=0;r>a;a+=1)o.setPixel(a,i,e(a,i));var u=c();o.write(u);for(var f=g(),l=u.toByteArray(),s=0;s<l.length;s+=1)f.writeByte(l[s]);f.flush();var v="";return v+="<img",v+=' src="',v+="data:image/gif;base64,",v+=f,v+='"',v+=' width="',v+=r,v+='"',v+=' height="',v+=t,v+='"',n&&(v+=' alt="',v+=n,v+='"'),v+="/>"};return t}()}();!function(o){var e=o(document),t=o("#shopbaseurl").val();if(/\.com$/.test(t)&&(t+="/"),e.on("click",".shop-follow",function(){var e=o(this);if(!e.hasClass("shop-followed")){if(""===MOGUPROFILE.userid){MOGU.user_handsome_login_init();var t={callback:function(){e.trigger("click")}};return void MOGU.user_handsome_login(!1,t)}o.ajax({url:"/collect/addfollow",type:"post",dataType:"json",data:{followIds:e.attr("uid")}}).done(function(t){if(1001==t.status.code){e.addClass("shop-followed").text("已关注").append('<b class="shop-nofollow"><i></i>取消</b>');var a=o(".J_ShopFollowNum");a.text(parseInt(a.text(),10)+1)}else alert(t.status.msg)})}}).on("click",".shop-nofollow",function(){var e=o(this),t=e.closest(".shop-follow");o.ajax({url:"/collect/unfollow",type:"post",dataType:"json",data:{followIds:t.attr("uid")}}).done(function(e){if(1001==e.status.code){t.removeClass("shop-followed").text("关注本店");var a=o(".J_ShopFollowNum");a.text(parseInt(a.text(),10)-1)}else alert(e.status.msg)})}).on({mouseover:function(){o(this).addClass("hover")},mouseleave:function(){o(this).removeClass("hover")}},".shop-score").on("click",".J_coupon_apply",function(){o.ajax({url:t+"/index/getPromotion",type:"post",dataType:"json",data:{pid:o(this).attr("data-id")}}).done(function(e){o.alert(1001==e.status.code?"领取成功":e.result.error)})}),o(".J_msg").length>0&&o(".J_msg").attr("data-bid",o("#shopid").val()),o(".back2top_wrap").find(".go_top").length>0){var a=['<div class="ext_module qrcode J_QrcodeSlide" href="javascript:;">','<div class="qrcode-container J_QrcodeContainer"><div class="qrcode-node J_QrcodeSlideContainer"><b class="qrcode-icon"></b></div><span class="tip">扫描进入手机店铺</span></div></div>'].join("");o(".back2top_wrap").find(".go_top").before(a)}o(".J_QrcodeSlide").on("mouseenter mouseleave",function(e){var a=o(".J_QrcodeSlideContainer"),s=o(".J_QrcodeContainer");return e=e||window.event,"mouseleave"===e.type?void s.hide():(s.show(),a.html().indexOf("<div")>-1?void 0:t&&""!=t?void a.qrcode({render:"div",text:t,size:120,ecLevel:"M"}):void s.hide())}).on("click",function(){var e=o(".J_QrcodeSlideContainer"),t=o(".J_QrcodeContainer");e.html().indexOf("<div")>-1&&t.toggle()}).show()}(jQuery);